<!DOCTYPE html>
<html class="writer-html5" lang="it" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tabs.US_USM &mdash; pyArchInit 4.0 4 documentazione</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
        <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="A proposito di questi documenti" href="../../about.html" />
    <link rel="index" title="Indice" href="../../genindex.html" />
    <link rel="search" title="Cerca" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> pyArchInit 4.0
            <img src="../../_static/pyarchinit_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Cerca documenti" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu di navigazione">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">1. About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../prerequisities.html">2. Prerequisiti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../novit%C3%A0.html">3. Novit√†</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installazione.html">4. Installazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../il_plugin.html">5. Il Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../le_schede.html">6. Le schede</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../funzioni.html">7. Funzioni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../come_documentare.html">8. Come documentare</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moduli.html">9. Moduli pyArchInit: Classi e Funzioni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">10. Bibliografia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lineee_guida.html">11. Linee guida</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Menu navigazione dispositivi mobili" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyArchInit 4.0</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Naviga tra le pagine">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Codice del modulo</a></li>
      <li class="breadcrumb-item active">tabs.US_USM</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Codice sorgente per tabs.US_USM</h1><div class="highlight"><pre>
<span></span>
<span class="c1"># from __future__ import absolute_import</span>
<span class="c1">#</span>
<span class="c1"># import psycopg2</span>
<span class="c1"># import sqlite3 as sq</span>
<span class="c1"># from xml.etree.ElementTree import ElementTree as ET</span>
<span class="c1"># import csv</span>
<span class="c1"># import sys</span>
<span class="c1">#</span>
<span class="c1"># import platform</span>
<span class="c1"># import time</span>
<span class="c1"># import pandas as pd</span>
<span class="c1">#</span>
<span class="c1"># #from pdf2docx import parse #not working</span>
<span class="c1">#</span>
<span class="c1"># from PyQt5 import QtCore, QtGui, QtWidgets</span>
<span class="c1">#</span>
<span class="c1"># from ..qgis.PyQt.QtCore import *</span>
<span class="c1"># from ..qgis.PyQt.QtGui import QColor, QIcon</span>
<span class="c1"># from ..qgis.PyQt.QtWidgets import *</span>
<span class="c1"># from ..qgis.PyQt.uic import loadUiType</span>
<span class="c1"># from ..qgis.core import *</span>
<span class="c1"># from ..qgis.gui import QgsMapCanvas, QgsMapToolPan</span>
<span class="c1"># from ..qgis.PyQt.QtSql import QSqlDatabase, QSqlTableModel</span>
<span class="c1"># import re</span>
<span class="c1"># from .Interactive_matrix import *</span>
<span class="c1"># from ..modules.utility.pyarchinit_OS_utility import Pyarchinit_OS_Utility</span>
<span class="c1"># from ..modules.db.pyarchinit_conn_strings import Connection</span>
<span class="c1"># from ..modules.db.pyarchinit_db_manager import Pyarchinit_db_management</span>
<span class="c1"># from ..modules.db.pyarchinit_utility import Utility</span>
<span class="c1"># from ..modules.gis.pyarchinit_pyqgis import Pyarchinit_pyqgis, Order_layer_v2</span>
<span class="c1"># from ..modules.utility.delegateComboBox import ComboBoxDelegate</span>
<span class="c1"># from ..modules.utility.pyarchinit_error_check import Error_check</span>
<span class="c1"># #from ..modules.utility.pyarchinit_exp_Periodosheet_pdf import generate_US_pdf</span>
<span class="c1"># from ..modules.utility.pyarchinit_exp_USsheet_pdf import generate_US_pdf</span>
<span class="c1"># from ..modules.utility.pyarchinit_print_utility import Print_utility</span>
<span class="c1"># from ..modules.utility.settings import Settings</span>
<span class="c1"># #from ..modules.utility.layout_loader import LayoutLoader</span>
<span class="c1"># from .pyarchinit_setting_matrix import Setting_Matrix</span>
<span class="c1"># from ..searchLayers import SearchLayers</span>
<span class="c1"># from ..gui.imageViewer import ImageViewer</span>
<span class="c1"># from ..gui.pyarchinitConfigDialog import pyArchInitDialog_Config</span>
<span class="c1"># from ..gui.sortpanelmain import SortPanelMain</span>
<span class="c1"># from ..resources.resources_rc import *</span>

<span class="c1">#MAIN_DIALOG_CLASS, _ = loadUiType(</span>
     <span class="c1">#os.path.join(os.path.dirname(__file__), os.pardir, &#39;gui&#39;, &#39;ui&#39;, &#39;US_USM.ui&#39;))</span>


    <span class="c1"># This is a function that cleans comments from a text file</span>
    <span class="c1"># It takes a string as an argument and returns a string</span>
<div class="viewcode-block" id="pyarchinit_US"><a class="viewcode-back" href="../../moduli.html#tabs.US_USM.pyarchinit_US">[documenti]</a><span class="k">class</span> <span class="nc">pyarchinit_US</span><span class="p">():</span>

    <span class="k">def</span> <span class="nf">clean_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text_to_clean</span><span class="p">):</span>
            <span class="n">clean_text</span> <span class="o">=</span> <span class="n">text_to_clean</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;##&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">clean_text</span>
<div class="viewcode-block" id="pyarchinit_US.EM_extract_node_name"><a class="viewcode-back" href="../../moduli.html#tabs.US_USM.pyarchinit_US.EM_extract_node_name">[documenti]</a>    <span class="k">def</span> <span class="nf">EM_extract_node_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_element</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Initialize variables to store node information&#39;&#39;&#39;</span></div>


<div class="viewcode-block" id="pyarchinit_US.check_if_empty"><a class="viewcode-back" href="../../moduli.html#tabs.US_USM.pyarchinit_US.check_if_empty">[documenti]</a>    <span class="k">def</span> <span class="nf">check_if_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;This is a function that checks if a name is empty</span>
<span class="sd">        If it is empty, it returns &quot;--None--&quot;</span>
<span class="sd">        If it is not empty, it returns the name&#39;&#39;&#39;</span></div>




<div class="viewcode-block" id="pyarchinit_US.on_pushButton_graphml2csv_pressed"><a class="viewcode-back" href="../../moduli.html#tabs.US_USM.pyarchinit_US.on_pushButton_graphml2csv_pressed">[documenti]</a>    <span class="k">def</span> <span class="nf">on_pushButton_graphml2csv_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;This is a function that is called when a button is pressed</span>
<span class="sd">        This is a QGIS setting&#39;&#39;&#39;</span></div>

<div class="viewcode-block" id="pyarchinit_US.on_pushButton_csv2us_pressed"><a class="viewcode-back" href="../../moduli.html#tabs.US_USM.pyarchinit_US.on_pushButton_csv2us_pressed">[documenti]</a>    <span class="k">def</span> <span class="nf">on_pushButton_csv2us_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is responsible for importing data from a CSV file into the &#39;us_table&#39; of the SQLite database.</span>
<span class="sd">        When the &#39;csv2us&#39; button is pressed, the user is prompted to select a CSV file with the &quot;Set file name&quot; dialog.</span>
<span class="sd">        The selected file is then opened and read, with the data from the file being inserted into the &#39;us_table&#39; of the SQLite database.</span>
<span class="sd">        The function starts by defining the path of the SQLite database, using the self.HOME variable and os.sep.</span>
<span class="sd">        Then it opens a QFileDialog to select a CSV file and assigns the file path to the variable &#39;filename&#39;.</span>
<span class="sd">        It then creates an instance of the &#39;Connection&#39; class and uses it to get the name of the SQLite database.</span>
<span class="sd">        It creates a connection to the SQLite database using the connect method and assigns it to the &#39;con&#39; variable.</span>
<span class="sd">        A cursor object is created using the &#39;con.cursor()&#39; method and assigned to the &#39;cur&#39; variable.</span>
<span class="sd">        It opens the selected CSV file in read mode, and uses the &#39;csv.DictReader&#39; class to read the file and convert it into a dictionary object.</span>
<span class="sd">        It then creates a list of tuples, each containing the values for the &#39;site&#39;, &#39;area&#39;, &#39;us&#39;, &#39;unit_type&#39; and &#39;i_stratigrafica&#39; columns.</span>
<span class="sd">        It then uses the &#39;executemany&#39; method of the cursor to insert the data from the list of tuples into the &#39;us_table&#39; of the SQLite database.</span>
<span class="sd">        The &#39;commit&#39; method is used to save the changes to the database.</span>
<span class="sd">        In case of any AssertionError, a warning message is displayed using the QMessageBox.warning method.</span>
<span class="sd">        Otherwise, a message saying &#39;done&#39; is displayed using the QMessageBox.information method.</span>
<span class="sd">        Finally, the connection to the database is closed using the &#39;con.close()&#39; method.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="pyarchinit_US.on_pushButton_fix_pressed"><a class="viewcode-back" href="../../moduli.html#tabs.US_USM.pyarchinit_US.on_pushButton_fix_pressed">[documenti]</a>    <span class="k">def</span> <span class="nf">on_pushButton_fix_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function is called when the user press the fix button.</span>
<span class="sd">        It will first get the current text in comboBox_sito and comboBox_area widgets,</span>
<span class="sd">        and create a search_dict dictionary with &#39;sito&#39;: sito and &#39;area&#39;: area as key-value pairs.</span>
<span class="sd">        Then it queries the database with the search_dict and the MAPPER_TABLE_CLASS and assigns the result to the variable &quot;records&quot;</span>
<span class="sd">        After that, it iterates over the range of the length of &quot;records&quot; and </span>
<span class="sd">        sets the checkBox_validation_rapp to be checked, selects each row of the tableWidget_rapporti,</span>
<span class="sd">        calls the check_listoflist() function, sets the progressBar_3 to a value based on the current row number and total number of rows,</span>
<span class="sd">        and updates the GUI. Finally, it resets the progressBar_3 to 0.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="pyarchinit_US.unit_type_select"><a class="viewcode-back" href="../../moduli.html#tabs.US_USM.pyarchinit_US.unit_type_select">[documenti]</a>    <span class="k">def</span> <span class="nf">unit_type_select</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function creates a dialog box for the user to select a unit type. The available unit types are determined by the value of the variable &#39;L&#39;, which is either &#39;it&#39; or &#39;en&#39;.</span>
<span class="sd">        If &#39;L&#39; is &#39;it&#39;, the available unit types are (&#39;US&#39;,&#39;USM&#39;,&#39;USVA&#39;,&#39;USVB&#39;,&#39;USVC&#39;,&#39;USD&#39;,&#39;CON&#39;,&#39;VSF&#39;,&#39;SF&#39;,&#39;SUS&#39;,&#39;Combinar&#39;,&#39;Extractor&#39;,&#39;DOC&#39;,&#39;property&#39;).</span>
<span class="sd">        If &#39;L&#39; is &#39;en&#39;, the available unit types are (&#39;SU&#39;,&#39;WSU&#39;,&#39;USVA&#39;,&#39;USVB&#39;,&#39;USVC&#39;,&#39;USD&#39;,&#39;CON&#39;,&#39;VSF&#39;,&#39;SF&#39;,&#39;SUS&#39;,&#39;Combinar&#39;,&#39;Extractor&#39;,&#39;DOC&#39;,&#39;property&#39;).</span>
<span class="sd">        The user&#39;s selection is returned as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="pyarchinit_US.search_rapp"><a class="viewcode-back" href="../../moduli.html#tabs.US_USM.pyarchinit_US.search_rapp">[documenti]</a>    <span class="k">def</span> <span class="nf">search_rapp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The function search_rapp is used to search for a specific value in the tableWidget_rapporti.</span>
<span class="sd">        First, it clears the current selection in the tableWidget_rapporti.</span>
<span class="sd">        It checks if the input variable &#39;s&#39; is empty, if it is then the function exits without searching.</span>
<span class="sd">        Then it uses the findItems method to find all items in the tableWidget_rapporti that match the string &#39;1&#39; and stores the matching items in the list matching_items.</span>
<span class="sd">        If there are any matching items, it sets the first item in the matching_items list as the current item in the tableWidget_rapporti.</span>
<span class="sd">        &#39;&#39;&#39;</span></div></div>


            <span class="c1"># us =str(self.lineEdit_us.text())</span>
        
            <span class="c1"># search_dict_inv = {</span>
                
                <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; +str(self.comboBox_sito.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;area&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].area&quot;))+ &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;us&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].us&quot;))+&quot;&#39;&quot;</span>
            <span class="c1"># }</span>
        
            <span class="c1"># inv_vl = self.DB_MANAGER.query_bool(search_dict_inv,&#39;INVENTARIO_MATERIALI&#39;)</span>
            <span class="c1"># inv_vl2 = self.DB_MANAGER.query_bool(search_dict_inv, &#39;POTTERY&#39;)</span>

            <span class="c1"># inv_list = []</span>
            <span class="c1"># inv_list2 = []</span>
            <span class="c1"># for i in range(len(inv_vl)):</span>
                <span class="c1"># inv_list.append(str(inv_vl[i].definizione)+&#39; &#39;+str(inv_vl[i].n_reperto))</span>
                <span class="c1"># #inv_list2.append(&#39;pottery_&#39;+str(inv_vl2[e].id_number))</span>
                <span class="c1"># inv_list.sort()</span>
                <span class="c1"># #inv_list2.sort()</span>
            <span class="c1"># for i in range(len(inv_vl2)):</span>
                <span class="c1"># #inv_list.append(str(inv_vl[i].tipo_reperto)+&#39;_&#39;+str(inv_vl[i].n_reperto))</span>
                <span class="c1"># inv_list2.append(&#39;pottery &#39;+str(inv_vl2[i].id_number))</span>
                <span class="c1"># #inv_list.sort()</span>
                <span class="c1"># inv_list2.sort()</span>

            <span class="c1"># try:</span>
                <span class="c1"># inv_vl.remove(&#39;&#39;)</span>
                <span class="c1"># inv_vl2.remove(&#39;&#39;)</span>
            <span class="c1"># except :</span>
                <span class="c1"># pass</span>
            <span class="c1"># self.comboBox_ref_ra.clear()</span>
            <span class="c1"># self.comboBox_ref_ra.addItems(self.UTILITY.remove_dup_from_list(inv_list))</span>
            <span class="c1"># self.comboBox_ref_ra.addItems(self.UTILITY.remove_dup_from_list(inv_list2))</span>
            <span class="c1"># if self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Trova&quot; or &quot;Finden&quot; or &quot;Find&quot;:</span>
                <span class="c1"># self.comboBox_ref_ra.setEditText(&quot;&quot;)</span>
            <span class="c1"># elif self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Usa&quot; or &quot;Aktuell &quot; or &quot;Current&quot;:</span>
                <span class="c1"># if len(self.DATA_LIST) &gt; 0:</span>
                    <span class="c1"># try:</span>
                        <span class="c1"># self.comboBox_ref_ra.setEditText(self.DATA_LIST[self.rec_num].ref_ra)</span>
                    <span class="c1"># except :</span>
                        <span class="c1"># pass</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>

    <span class="c1"># def charge_insert_ra_pottery(self):</span>
        <span class="c1"># try:</span>

            <span class="c1"># us = str(self.lineEdit_us.text())</span>

            <span class="c1"># search_dict_inv = {</span>

                <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; + str(self.comboBox_sito.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;area&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].area&quot;)) + &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;us&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].us&quot;)) + &quot;&#39;&quot;</span>
            <span class="c1"># }</span>

            <span class="c1"># inv_vl = self.DB_MANAGER.query_bool(search_dict_inv, &#39;POTTERY&#39;)</span>
            <span class="c1"># inv_list = []</span>
            <span class="c1"># for i in range(len(inv_vl)):</span>
                <span class="c1"># inv_list.append(str(inv_vl[i].id_number))</span>
                <span class="c1"># inv_list.sort()</span>
            <span class="c1"># try:</span>
                <span class="c1"># inv_vl.remove(&#39;&#39;)</span>
            <span class="c1"># except:</span>
                <span class="c1"># pass</span>
            <span class="c1"># self.comboBox_ref_ra.clear()</span>
            <span class="c1"># self.comboBox_ref_ra.addItems(self.UTILITY.remove_dup_from_list(inv_list))</span>
            <span class="c1"># if self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Trova&quot; or &quot;Finden&quot; or &quot;Find&quot;:</span>
                <span class="c1"># self.comboBox_ref_ra.setEditText(&quot;&quot;)</span>
            <span class="c1"># elif self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Usa&quot; or &quot;Aktuell &quot; or &quot;Current&quot;:</span>
                <span class="c1"># if len(self.DATA_LIST) &gt; 0:</span>
                    <span class="c1"># try:</span>
                        <span class="c1"># self.comboBox_ref_ra.setEditText(self.DATA_LIST[self.rec_num].ref_ra)</span>
                    <span class="c1"># except:</span>
                        <span class="c1"># pass</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>

    <span class="c1"># def listview_us(self):</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># conn = Connection()</span>
            <span class="c1"># conn_str = conn.conn_str()</span>
            <span class="c1"># conn_sqlite = conn.databasename()</span>
            <span class="c1"># conn_user = conn.datauser()</span>
            <span class="c1"># conn_host = conn.datahost()</span>
            <span class="c1"># conn_port = conn.dataport()</span>
            <span class="c1"># port_int  = conn_port[&quot;port&quot;]</span>
            <span class="c1"># port_int.replace(&quot;&#39;&quot;, &quot;&quot;)</span>
            <span class="c1"># conn_password = conn.datapassword()</span>
            <span class="c1"># sito_set= conn.sito_set()</span>
            <span class="c1"># sito_set_str = sito_set[&#39;sito_set&#39;]</span>
            <span class="c1"># test_conn = conn_str.find(&#39;sqlite&#39;)</span>
            <span class="c1"># if test_conn == 0:</span>
                <span class="c1"># sqlite_DB_path = &#39;{}{}{}&#39;.format(self.HOME, os.sep,</span>
                                           <span class="c1"># &quot;pyarchinit_DB_folder&quot;)</span>
                
                <span class="c1"># db = QSqlDatabase(&quot;QSQLITE&quot;) </span>
                <span class="c1"># db.setDatabaseName(sqlite_DB_path +os.sep+ conn_sqlite[&quot;db_name&quot;])</span>
                <span class="c1"># db.open()</span>
                <span class="c1"># self.model_a = QSqlTableModel(db = db) </span>
                <span class="c1"># self.table.setModel(self.model_a) </span>
                <span class="c1"># self.model_a.setTable(&quot;us_table&quot;) </span>
                <span class="c1"># self.model_a.setEditStrategy(QSqlTableModel.OnManualSubmit)</span>
                <span class="c1"># self.pushButton_submit.clicked.connect(self.submit)</span>
                <span class="c1"># self.pushButton_revert.clicked.connect(self.model_a.revertAll)</span>
                <span class="c1"># column_titles = { </span>
                    <span class="c1"># &quot;sito&quot;: &quot;SITO&quot;, </span>
                    <span class="c1"># &quot;area&quot;: &quot;Area&quot;, </span>
                    <span class="c1"># &quot;us&quot;: &quot;US&quot;} </span>
                <span class="c1"># for n, t in column_titles.items(): </span>
                    <span class="c1"># idx = self.model_a.fieldIndex( n) </span>
                    <span class="c1"># self.model_a.setHeaderData( idx, Qt.Horizontal, t)</span>
                <span class="c1"># if bool (sito_set_str):</span>
                    <span class="c1"># filter_str = &quot;sito = &#39;{}&#39;&quot;.format(str(self.comboBox_sito.currentText())) </span>
                    <span class="c1"># self.model_a.setFilter(filter_str)</span>
                    <span class="c1"># self.model_a.select() </span>
                <span class="c1"># else:</span>
                    <span class="c1"># self.model_a.select() </span>
            
                <span class="c1"># uri = QgsDataSourceUri()</span>
                <span class="c1"># uri.setDatabase(sqlite_DB_path +os.sep+ conn_sqlite[&quot;db_name&quot;])</span>
                <span class="c1"># schema = &#39;&#39;</span>
                <span class="c1"># table = &#39;us_table&#39;</span>
                <span class="c1"># geom_column = &#39;&#39;</span>
                <span class="c1"># uri.setDataSource(schema, table,geom_column)</span>
                <span class="c1"># vlayer = QgsVectorLayer(uri.uri(), table, &#39;spatialite&#39;)</span>
                <span class="c1"># pr = vlayer.dataProvider()</span>
                <span class="c1"># fi= pr.fields().names()[1:-1]</span>
                
                <span class="c1"># self.field.clear()</span>
                <span class="c1"># self.field.addItems(fi)</span>
                <span class="c1"># try:</span>
                    <span class="c1"># self.search_1.clearEditText()</span>
                    <span class="c1"># self.search_1.update()</span>
                    <span class="c1"># self.value_check()</span>
                <span class="c1"># except:</span>
                    <span class="c1"># pass</span>
            <span class="c1"># else:</span>
                
                
                <span class="c1"># db = QSqlDatabase.addDatabase(&quot;QPSQL&quot;)</span>
                <span class="c1"># db.setHostName(conn_host[&quot;host&quot;])</span>
                <span class="c1"># db.setDatabaseName(conn_sqlite[&quot;db_name&quot;])</span>
                <span class="c1"># db.setPort(int(port_int))</span>
                <span class="c1"># db.setUserName(conn_user[&#39;user&#39;])</span>
                <span class="c1"># db.setPassword(conn_password[&#39;password&#39;]) </span>
                <span class="c1"># db.open()</span>
                <span class="c1"># self.model_a = QSqlTableModel(db = db) </span>
                <span class="c1"># self.table.setModel(self.model_a) </span>
                <span class="c1"># self.model_a.setTable(&quot;us_table&quot;)</span>
                <span class="c1"># self.model_a.setEditStrategy(QSqlTableModel.OnManualSubmit)</span>
                <span class="c1"># self.pushButton_submit.clicked.connect(self.submit)</span>
                <span class="c1"># self.pushButton_revert.clicked.connect(self.model_a.revertAll)</span>
                <span class="c1"># if bool (sito_set_str):</span>
                    <span class="c1"># filter_str = &quot;sito = &#39;{}&#39;&quot;.format(str(self.comboBox_sito.currentText())) </span>
                    <span class="c1"># self.model_a.setFilter(filter_str)</span>
                    <span class="c1"># self.model_a.select()</span>
                <span class="c1"># else:</span>
                    <span class="c1"># self.model_a.select() </span>
        
                <span class="c1"># uri = QgsDataSourceUri()</span>
                <span class="c1"># uri.setConnection(conn_host[&quot;host&quot;], conn_port[&quot;port&quot;], conn_sqlite[&quot;db_name&quot;], conn_user[&#39;user&#39;], conn_password[&#39;password&#39;])</span>
                <span class="c1"># schema = &#39;public&#39;                </span>
                <span class="c1"># table = &#39;us_table&#39;</span>
                <span class="c1"># geom_column = &#39;&#39;</span>
                <span class="c1"># uri.setDataSource(schema, table,geom_column)</span>
                <span class="c1"># vlayer = QgsVectorLayer(uri.uri(), table, &#39;postgres&#39;)</span>
                <span class="c1"># pr = vlayer.dataProvider()</span>
                <span class="c1"># fi= pr.fields().names()[1:-1]</span>
                <span class="c1"># pr = vlayer.dataProvider()</span>
                <span class="c1"># fi= pr.fields().names()[1:-1]</span>
                
                <span class="c1"># self.field.clear()</span>
                <span class="c1"># self.field.addItems(fi)</span>
                <span class="c1"># try:</span>
                    <span class="c1"># self.search_1.clearEditText()</span>
                    <span class="c1"># self.search_1.update()</span>
                    <span class="c1"># self.value_check()</span>
                <span class="c1"># except:</span>
                    <span class="c1"># pass</span>
        <span class="c1"># else:</span>
            <span class="c1"># self.checkBox_query.setChecked(False)</span>
    <span class="c1"># def submit(self):</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().transaction()</span>
            <span class="c1"># if self.model_a.submitAll():</span>
                <span class="c1"># self.model_a.database().commit()</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.information(self, &quot;Record&quot;,  &quot;record salvato&quot;)</span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.information(self, &quot;Datensatz&quot;,  &quot;Datensatz gespeichert&quot;)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># QMessageBox.information(self, &quot;Record&quot;,  &quot;record saved&quot;)</span>
            
            <span class="c1"># else:</span>
                <span class="c1"># self.model_a.database().rollback()</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Cached Table&quot;,</span>
                            <span class="c1"># &quot;Il db ha segnalato un errore: %s&quot; % self.model_a.lastError().text())    </span>
        
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Cached Table&quot;,</span>
                            <span class="c1"># &quot;Die Datenbank meldete einen Fehler: %s&quot; % self.model_a.lastError().text())    </span>
                            
                <span class="c1"># else:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Cached Table&quot;,</span>
                            <span class="c1"># &quot;The database reported an error: %s&quot; % self.model_a.lastError().text())                </span>
        
        <span class="c1"># else:    </span>
            <span class="c1"># self.checkBox_query.setChecked(False)</span>
    
    
    <span class="c1"># def value_check(self):</span>
        <span class="c1"># try:</span>
            
            <span class="c1"># if self.field.currentTextChanged:</span>
                <span class="c1"># sito_vl2 = self.UTILITY.tup_2_list_III(self.DB_MANAGER.group_by(&#39;us_table&#39;, self.field.currentText(),&#39;US&#39;))</span>

            <span class="c1"># try:</span>
                <span class="c1"># sito_vl2.remove(&#39;&#39;)</span>
            <span class="c1"># except:</span>
                <span class="c1"># pass</span>
            <span class="c1"># self.search_1.clear()</span>
            <span class="c1"># sito_vl2.sort()</span>
            
            <span class="c1"># self.search_1.addItems(sito_vl2)</span>
            <span class="c1"># self.search_1.update()</span>
        <span class="c1"># except :</span>
            <span class="c1"># pass#QMessageBox.warning(self, &quot;Attenzione&quot;, str(e), QMessageBox.Ok)  </span>
    <span class="c1"># def update_filter(self, s): </span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># conn = Connection()            </span>
            <span class="c1"># conn_str = conn.conn_str()    </span>
            <span class="c1"># sito_set= conn.sito_set()</span>
            <span class="c1"># sito_set_str = sito_set[&#39;sito_set&#39;]</span>
            <span class="c1"># test_conn = conn_str.find(&#39;sqlite&#39;)</span>
            <span class="c1"># s_field = self.field.currentText()</span>
            <span class="c1"># s = re.sub(&quot;[\w_][\W_] +&quot;, &quot;&quot;, s)</span>
            <span class="c1"># if test_conn == 0:</span>
                
                
                <span class="c1"># try:</span>
                    <span class="c1"># if bool(sito_set_str):</span>
                        <span class="c1"># filter_str = &quot;{} LIKE &#39;%{}%&#39; and sito = &#39;{}&#39;&quot;.format(s_field,s,str(self.comboBox_sito.currentText())) </span>
                        <span class="c1"># if bool(filter_str):</span>
                            <span class="c1"># self.model_a.setFilter(filter_str)</span>
                            <span class="c1"># self.model_a.select()</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># pass</span>
                    
                    <span class="c1"># else:</span>
                        <span class="c1"># filter_str = &quot;{} LIKE &#39;%{}%&#39;&quot;.format(s_field,s) </span>
                        <span class="c1"># if bool(filter_str):</span>
                            <span class="c1"># self.model_a.setFilter(filter_str)</span>
                            <span class="c1"># self.model_a.select() </span>
                        <span class="c1"># else:</span>
                            <span class="c1"># pass</span>
                <span class="c1"># except :</span>
                    <span class="c1"># pass#QMessageBox.warning(self, &quot;Warning&quot;, str(e), QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># try:</span>
                    <span class="c1"># if bool(sito_set_str):</span>
                        <span class="c1"># filter_str = &quot;{} LIKE &#39;%{}%&#39; and sito = &#39;{}&#39;&quot;.format(s_field,s,str(self.comboBox_sito.currentText()))</span>
                        <span class="c1"># if bool(filter_str):</span>
                            <span class="c1"># self.model_a.setFilter(filter_str)</span>
                            <span class="c1"># self.model_a.select()</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># pass</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># filter_str = &quot;{} LIKE &#39;%{}%&#39;&quot;.format(s_field,s) </span>
                        <span class="c1"># if bool(filter_str):</span>
                            <span class="c1"># self.model_a.setFilter(filter_str)</span>
                            <span class="c1"># self.model_a.select() </span>
                        <span class="c1"># else:</span>
                            <span class="c1"># pass</span>
                <span class="c1"># except :</span>
                    <span class="c1"># pass#QMessageBox.warning(self, &quot;Warning&quot;, str(e), QMessageBox.Ok)</span>
        <span class="c1"># else:    </span>
            <span class="c1"># self.checkBox_query.setChecked(False)</span>
    <span class="c1"># def on_pushButton_globalsearch_pressed(self):</span>
        <span class="c1"># self.search.showSearchDialog()    </span>
    <span class="c1"># def charge_struttura_list(self):</span>
         
        <span class="c1"># sito = str(self.comboBox_sito.currentText())</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; + sito + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># struttura_vl = self.DB_MANAGER.query_bool(search_dict, &#39;STRUTTURA&#39;)</span>
        <span class="c1"># struttura_list = []</span>
        <span class="c1"># for i in range(len(struttura_vl)):</span>
            <span class="c1"># struttura_list.append(str(struttura_vl[i].sigla_struttura+&#39;-&#39;+str(struttura_vl[i].numero_struttura)))</span>
        <span class="c1"># try:</span>
            <span class="c1"># struttura_vl.remove(&#39;&#39;)</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>
        <span class="c1"># self.comboBox_struttura.clear()</span>
        <span class="c1"># self.comboBox_struttura.addItems(self.UTILITY.remove_dup_from_list(struttura_list))</span>
        <span class="c1"># if self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Trova&quot; or &quot;Finden&quot; or &quot;Find&quot;:</span>
            <span class="c1"># self.comboBox_struttura.setEditText(&quot;&quot;)</span>
        <span class="c1"># elif self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Usa&quot; or &quot;Aktuell &quot; or &quot;Current&quot;:</span>
            <span class="c1"># if len(self.DATA_LIST) &gt; 0:</span>
                <span class="c1"># try:</span>
                    <span class="c1"># self.comboBox_struttura.setEditText(self.DATA_LIST[self.rec_num].sigla_struttura+&#39;-&#39;+numero_struttura)</span>
                <span class="c1"># except:</span>
                    <span class="c1"># pass  # non vi sono periodi per questo scavo</span>
    <span class="c1"># def geometry_unitastratigrafiche(self):</span>
        <span class="c1"># try:</span>
            <span class="c1"># sito = str(self.comboBox_sito.currentText())</span>
            <span class="c1"># area = str(self.comboBox_area.currentText())</span>
            <span class="c1"># us = str(self.lineEdit_us.text())</span>
        
            <span class="c1"># search_dict = {</span>
                <span class="c1"># &#39;scavo_s&#39;: &quot;&#39;&quot; +str(self.comboBox_sito.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;area_s&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].area&quot;)) + &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;us_s&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].us&quot;))+&quot;&#39;&quot;</span>
                
            <span class="c1"># }</span>
        
            <span class="c1"># geometry_vl = self.DB_MANAGER.query_bool(search_dict,&#39;PYUS&#39;)</span>
            <span class="c1"># geometry_list = []</span>
            
            <span class="c1"># for i in range(len(geometry_vl)):</span>
                <span class="c1"># geometry_list.append(str(geometry_vl[i].coord))</span>
            <span class="c1"># try:</span>
                <span class="c1"># geometry_vl.remove(&#39;&#39;)</span>
            <span class="c1"># except:</span>
                <span class="c1"># pass</span>
        
            <span class="c1"># self.comboBox_posizione.clear()</span>
            <span class="c1"># self.comboBox_posizione.addItems(self.UTILITY.remove_dup_from_list(geometry_list))</span>
            <span class="c1"># if self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Trova&quot; or &quot;Finden&quot; or &quot;Find&quot;:</span>
                <span class="c1"># self.comboBox_posizione.setEditText(&quot;&quot;)</span>
            <span class="c1"># elif self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Usa&quot; or &quot;Aktuell &quot; or &quot;Current&quot;:     </span>
                <span class="c1"># if len(self.DATA_LIST) &gt; 0:</span>
                    <span class="c1"># try:</span>
                        <span class="c1"># self.comboBox_posizione.setEditText(self.DATA_LIST[self.rec_num].posizione)</span>
                        <span class="c1"># self.comboBox_posizione.show()</span>
                    <span class="c1"># except:</span>
                        <span class="c1"># pass  # non vi sono periodi per questo scavo</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>
    <span class="c1"># def charge_periodo_iniz_list(self):</span>
        
        <span class="c1"># try: </span>
            
            <span class="c1"># sito = str(self.comboBox_sito.currentText())</span>
            <span class="c1"># area = str(self.comboBox_area.currentText())</span>
            <span class="c1"># search_dict = {</span>
                <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; + sito + &quot;&#39;&quot;,</span>
                <span class="c1"># #&#39;area&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].area&quot;)) + &quot;&#39;&quot;,</span>
            <span class="c1"># }</span>
            <span class="c1"># periodo_vl = self.DB_MANAGER.query_bool(search_dict, &#39;PERIODIZZAZIONE&#39;)</span>
            <span class="c1"># periodo_list = []</span>
            <span class="c1"># for i in range(len(periodo_vl)):</span>
                <span class="c1"># periodo_list.append(str(periodo_vl[i].periodo))</span>
            <span class="c1"># try:</span>
                <span class="c1"># periodo_vl.remove(&#39;&#39;)</span>
            <span class="c1"># except:</span>
                <span class="c1"># pass</span>
            <span class="c1"># #</span>
            <span class="c1"># self.comboBox_per_iniz.clear()</span>
            <span class="c1"># self.comboBox_per_iniz.addItems(self.UTILITY.remove_dup_from_list(periodo_list))</span>
            <span class="c1"># if self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Trova&quot; or &quot;Finden&quot; or &quot;Find&quot;:</span>
                <span class="c1"># self.comboBox_per_iniz.setEditText(&quot;&quot;)</span>
            <span class="c1"># elif self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Usa&quot; or &quot;Aktuell &quot; or &quot;Current&quot;: </span>
                <span class="c1"># if len(self.DATA_LIST) &gt; 0:</span>
                    <span class="c1"># try:</span>
                        <span class="c1"># self.comboBox_per_iniz.setEditText(self.DATA_LIST[self.rec_num].periodo_iniziale)</span>
                        <span class="c1"># self.comboBox_per_iniz.show()</span>
                    <span class="c1"># except:</span>
                        <span class="c1"># pass  # non vi sono periodi per questo scavo</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass  </span>
    <span class="c1"># def charge_periodo_fin_list(self):</span>
        
        <span class="c1"># try:</span>
            
            <span class="c1"># sito = str(self.comboBox_sito.currentText())</span>
            <span class="c1"># area = str(self.comboBox_area.currentText())</span>
            <span class="c1"># search_dict = {</span>
                <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; + sito + &quot;&#39;&quot;,</span>
                <span class="c1"># #&#39;area&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].area&quot;)) + &quot;&#39;&quot;,</span>
            <span class="c1"># }</span>
            <span class="c1"># periodo_vl = self.DB_MANAGER.query_bool(search_dict, &#39;PERIODIZZAZIONE&#39;)</span>
            <span class="c1"># periodo_list = []</span>
            <span class="c1"># for i in range(len(periodo_vl)):</span>
                <span class="c1"># periodo_list.append(str(periodo_vl[i].periodo))</span>
            <span class="c1"># try:</span>
                <span class="c1"># periodo_vl.remove(&#39;&#39;)</span>
            <span class="c1"># except:</span>
                <span class="c1"># pass</span>
            <span class="c1"># self.comboBox_per_fin.clear()</span>
            <span class="c1"># self.comboBox_per_fin.addItems(self.UTILITY.remove_dup_from_list(periodo_list))</span>
            <span class="c1"># if self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Trova&quot; or &quot;Finden&quot; or &quot;Find&quot;:</span>
                <span class="c1"># self.comboBox_per_fin.setEditText(&quot;&quot;)</span>
            <span class="c1"># elif self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Usa&quot; or &quot;Aktuell &quot; or &quot;Current&quot;: </span>
                <span class="c1"># if len(self.DATA_LIST) &gt; 0:</span>
                    <span class="c1"># try:</span>
                        <span class="c1"># self.comboBox_per_fin.setEditText(self.DATA_LIST[self.rec_num].periodo_iniziale)</span>
                    <span class="c1"># except:</span>
                        <span class="c1"># pass</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass  # non vi sono periodi per questo scavo</span>
    <span class="c1"># def charge_fase_iniz_list(self):</span>
        <span class="c1"># #if self.comboBox_fas_iniz.activated: </span>
        <span class="c1"># try:</span>
            <span class="c1"># search_dict = {</span>
                <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; + str(self.comboBox_sito.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;periodo&#39;: &quot;&#39;&quot; + str(self.comboBox_per_iniz.currentText()) + &quot;&#39;&quot;,</span>
            <span class="c1"># }</span>
            <span class="c1"># fase_list_vl = self.DB_MANAGER.query_bool(search_dict, &#39;PERIODIZZAZIONE&#39;)</span>
            <span class="c1"># fase_list = []</span>
            <span class="c1"># for i in range(len(fase_list_vl)):</span>
                <span class="c1"># fase_list.append(str(fase_list_vl[i].fase))</span>
            <span class="c1"># try:</span>
                <span class="c1"># fase_list.remove(&#39;&#39;)</span>
            <span class="c1"># except:</span>
                <span class="c1"># pass</span>
            <span class="c1"># self.comboBox_fas_iniz.clear()</span>
            <span class="c1"># fase_list.sort()</span>
            <span class="c1"># self.comboBox_fas_iniz.addItems(self.UTILITY.remove_dup_from_list(fase_list))</span>
            <span class="c1"># if self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Trova&quot; or &quot;Finden&quot; or &quot;Find&quot;:</span>
                <span class="c1"># self.comboBox_fas_iniz.setEditText(&quot;&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.comboBox_fas_iniz.setEditText(self.DATA_LIST[self.rec_num].fase_iniziale)</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>
    <span class="c1"># def charge_fase_fin_list(self):</span>
        <span class="c1"># #if self.comboBox_fas_fin.activated: </span>
        <span class="c1"># try:</span>
            <span class="c1"># search_dict = {</span>
                <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; + str(self.comboBox_sito.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;periodo&#39;: &quot;&#39;&quot; + str(self.comboBox_per_fin.currentText()) + &quot;&#39;&quot;</span>
            <span class="c1"># }</span>
            <span class="c1"># fase_list_vl = self.DB_MANAGER.query_bool(search_dict, &#39;PERIODIZZAZIONE&#39;)</span>
            <span class="c1"># fase_list = []</span>
            <span class="c1"># for i in range(len(fase_list_vl)):</span>
                <span class="c1"># fase_list.append(str(fase_list_vl[i].fase))</span>
            <span class="c1"># try:</span>
                <span class="c1"># fase_list.remove(&#39;&#39;)</span>
            <span class="c1"># except:</span>
                <span class="c1"># pass</span>
            <span class="c1"># self.comboBox_fas_fin.clear()</span>
            <span class="c1"># fase_list.sort()</span>
            <span class="c1"># self.comboBox_fas_fin.addItems(self.UTILITY.remove_dup_from_list(fase_list))</span>
            <span class="c1"># if self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Trova&quot; or &quot;Finden&quot; or &quot;Find&quot;:</span>
                <span class="c1"># self.comboBox_fas_fin.setEditText(&quot;&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.comboBox_fas_fin.setEditText(self.DATA_LIST[self.rec_num].fase_finale)</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>
    <span class="c1"># def charge_datazione_list(self):</span>
        <span class="c1"># #if self.comboBox_datazione.activated: </span>
        <span class="c1"># try:</span>
            <span class="c1"># search_dict = {</span>
                <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; + str(self.comboBox_sito.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;periodo&#39;: &quot;&#39;&quot; + str(self.comboBox_per_iniz.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># &#39;fase&#39;: &quot;&#39;&quot; + str(self.comboBox_fas_iniz.currentText()) + &quot;&#39;&quot;</span>
            <span class="c1"># }</span>
            <span class="c1"># datazione_list_vl = self.DB_MANAGER.query_bool(search_dict, &#39;PERIODIZZAZIONE&#39;)</span>
            <span class="c1"># datazione_list = []</span>
            <span class="c1"># for i in range(len(datazione_list_vl)):</span>
                <span class="c1"># datazione_list.append(str(datazione_list_vl[i].datazione_estesa))</span>
            <span class="c1"># try:</span>
                <span class="c1"># datazione_list.remove(&#39;&#39;)</span>
            <span class="c1"># except:</span>
                <span class="c1"># pass</span>
            <span class="c1"># self.comboBox_datazione.clear()</span>
            <span class="c1"># datazione_list.sort()</span>
            <span class="c1"># self.comboBox_datazione.addItems(self.UTILITY.remove_dup_from_list(datazione_list))</span>
            <span class="c1"># if self.STATUS_ITEMS[self.BROWSE_STATUS] == &quot;Trova&quot; or &quot;Finden&quot; or &quot;Find&quot;:</span>
                <span class="c1"># self.comboBox_datazione.setEditText(&quot;&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.comboBox_datazione.setEditText(self.DATA_LIST[self.rec_num].datazione_estesa)</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>
    <span class="c1"># def on_pushButton_draw_doc_pressed(self):</span>
        <span class="c1"># sito = str(self.comboBox_sito.currentText())</span>
        <span class="c1"># area = str(self.comboBox_area.currentText())</span>
        <span class="c1"># us = str(self.lineEdit_us.text())</span>
        <span class="c1"># table_name = &quot;self.tableWidget_documentazione&quot;</span>
        <span class="c1"># rowSelected_cmd = (&quot;%s.selectedIndexes()&quot;) % (table_name)</span>
        <span class="c1"># rowSelected = eval(rowSelected_cmd)</span>
        <span class="c1"># rowIndex = (rowSelected[0].row())</span>
        <span class="c1"># tipo_doc_item = self.tableWidget_documentazione.item(rowIndex, 0)</span>
        <span class="c1"># nome_doc_item = self.tableWidget_documentazione.item(rowIndex, 1)</span>
        <span class="c1"># tipo_doc = str(tipo_doc_item.text())</span>
        <span class="c1"># nome_doc = str(nome_doc_item.text())</span>
        <span class="c1"># lista_draw_doc = [sito, area, us, tipo_doc, nome_doc]</span>
        <span class="c1"># self.pyQGIS.charge_vector_layers_doc_from_scheda_US(lista_draw_doc)</span>
    <span class="c1"># def save_us(self):</span>
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># if self.BROWSE_STATUS == &quot;b&quot;:</span>
            <span class="c1"># if self.data_error_check() == 0:</span>
                <span class="c1"># if self.records_equal_check() == 1:</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># self.update_if(QMessageBox.warning(self, &#39;Attenzione&#39;,</span>
                                                           <span class="c1"># &quot;Il record e&#39; stato modificato. Vuoi salvare le modifiche? \n Clicca OK per salvare o Annulla per abortire.\n Poi riselezione l&#39;US su cui vuoi andare&quot;,QMessageBox.Ok | QMessageBox.Cancel))</span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># self.update_if(QMessageBox.warning(self, &#39;Error&#39;,</span>
                                                           <span class="c1"># &quot;Der Record wurde ge√§ndert. M√∂chtest du die √Ñnderungen speichern?&quot;,</span>
                                                           <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
                                                           
                    <span class="c1"># else:</span>
                        <span class="c1"># self.update_if(QMessageBox.warning(self, &#39;Error&#39;,</span>
                                                           <span class="c1"># &quot;The record has been changed. Do you want to save the changes?&quot;,</span>
                                                           <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
                    <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
                    <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
                    <span class="c1"># self.enable_button(1)</span>
                    <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                    
            <span class="c1"># else:</span>
                <span class="c1"># pass</span>
                
        
        <span class="c1"># else:</span>
            <span class="c1"># if self.data_error_check() == 0:</span>
                <span class="c1"># test_insert = self.insert_new_rec()</span>
                <span class="c1"># if test_insert == 1:</span>
                    <span class="c1"># self.empty_fields()</span>
                    <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[&quot;n&quot;])</span>
                    <span class="c1"># self.charge_list()</span>
                    <span class="c1"># self.set_sito()</span>
                    <span class="c1"># self.charge_records()</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), len(self.DATA_LIST) - 1</span>
                    <span class="c1"># self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>

                    <span class="c1"># self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_sito&quot;], 1)</span>
                    
                    <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                    <span class="c1"># self.enable_button(1)</span>
                    
            <span class="c1"># else:</span>
                <span class="c1"># pass</span>
                
  
        
    
    <span class="c1"># def selectRows(self):</span>
        <span class="c1"># # seleziona tutte le row della tablewidget dei rapporti</span>
        <span class="c1"># for row in range(self.tableWidget_rapporti.rowCount()):</span>
            <span class="c1"># table_item = self.tableWidget_rapporti.item(row, 1)</span>
            <span class="c1"># row_data = table_item.data(QtCore.Qt.UserRole)</span>
            <span class="c1"># row_id = row_data</span>
            <span class="c1"># self.tableWidget_rapporti.selectRow(row)  </span>

    <span class="c1"># def on_pushButton_update_pressed(self):</span>
        <span class="c1"># sito = &quot;&#39;&quot;+self.comboBox_sito.currentText()+&quot;&#39;&quot;</span>
        <span class="c1"># area = &quot;&#39;&quot;+self.comboBox_area.currentText()+&quot;&#39;&quot;</span>
        <span class="c1"># search_dict = {&#39;sito&#39;: sito, &#39;area&#39;: area}</span>
        <span class="c1"># records = self.DB_MANAGER.query_bool(search_dict,</span>
                                             <span class="c1"># self.MAPPER_TABLE_CLASS)  # carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="c1"># self.selectRows()</span>
        <span class="c1"># for rec in range(len(records)):</span>
            <span class="c1"># self.selectRows()</span>
            <span class="c1"># self.on_pushButton_next_rec_pressed()</span>
            <span class="c1"># self.us_t()</span>
                
            <span class="c1"># self.save_rapp()</span>
            <span class="c1"># value = (float(rec)/float(len(records)))*100</span>
            <span class="c1"># self.progressBar_2.setValue(value)</span>
            <span class="c1"># QApplication.processEvents()</span>
        <span class="c1"># self.progressBar_2.reset()        </span>
    <span class="c1"># def us_t(self):</span>
        <span class="c1"># if self.checkBox_validate.isChecked():</span>
            <span class="c1"># try:</span>

                <span class="c1"># table_name = &quot;self.tableWidget_rapporti&quot;</span>
                
                <span class="c1"># rowSelected_cmd = (&quot;%s.selectedItems()&quot;) % (table_name)</span>
                <span class="c1"># rowSelected = eval(rowSelected_cmd)</span>
                
                <span class="c1"># for i  in rowSelected:</span>
                    <span class="c1"># s= self.tableWidget_rapporti.rowCount()</span>
                    <span class="c1"># self.tableWidget_rapporti2.setRowCount(s)</span>
                    <span class="c1"># rowIndex = (i.row())</span>
                    <span class="c1"># sito = str(self.comboBox_sito.currentText())</span>
                    <span class="c1"># area = str(self.comboBox_area.currentText())</span>
                
                    <span class="c1"># us_item = self.tableWidget_rapporti.item(rowIndex, 1)</span>
                   
                    <span class="c1"># us_ = str(us_item.text())</span>
                    <span class="c1"># rapp_item = self.tableWidget_rapporti.item(rowIndex, 0)</span>
                    <span class="c1"># rapp_ = str(rapp_item.text())</span>
                
                    <span class="c1"># search_dict = {&#39;sito&#39;: &quot;&#39;&quot; + str(sito) + &quot;&#39;&quot;,</span>
                                   <span class="c1"># &#39;area&#39;: &quot;&#39;&quot; + str(area) + &quot;&#39;&quot;,</span>
                                   <span class="c1"># &#39;us&#39;: us_}</span>
                    <span class="c1"># u = Utility()</span>
                    <span class="c1"># search_dict = u.remove_empty_items_fr_dict(search_dict)</span>
                    <span class="c1"># res = self.DB_MANAGER.query_bool(search_dict, self.MAPPER_TABLE_CLASS)</span>
                
               
            
                    <span class="c1"># for p in res:</span>
                        <span class="c1"># #</span>
                        
                        <span class="c1"># self.tableWidget_rapporti2.setItem(rowIndex,0,QtWidgets.QTableWidgetItem(rapp_))</span>
                        <span class="c1"># self.tableWidget_rapporti2.setItem(rowIndex,1,QtWidgets.QTableWidgetItem(us_))</span>
                        <span class="c1"># self.tableWidget_rapporti2.setItem(rowIndex,2,QtWidgets.QTableWidgetItem(p.unita_tipo))</span>
                        <span class="c1"># self.tableWidget_rapporti2.setItem(rowIndex,3,QtWidgets.QTableWidgetItem(p.d_interpretativa))</span>
                        <span class="c1"># self.tableWidget_rapporti2.setItem(rowIndex,4,QtWidgets.QTableWidgetItem(p.periodo_iniziale+&#39;-&#39;+p.fase_iniziale))</span>
                        
                    <span class="c1"># self.tableWidget_rapporti2.update()</span>
                    
            <span class="c1"># except Exception as e:</span>
                <span class="c1"># QMessageBox.warning(self,&#39;&#39;,str(e))</span>
        <span class="c1"># else:</span>
            <span class="c1"># pass</span>
    
    
    
    
    
    
    
    
    
    <span class="c1"># def on_pushButton_go_to_us_pressed(self):    </span>
        <span class="c1"># #self.save_us()</span>
        <span class="c1"># try:</span>
            <span class="c1"># table_name = &quot;self.tableWidget_rapporti&quot;</span>
            <span class="c1"># rowSelected_cmd = (&quot;%s.selectedIndexes()&quot;) % (table_name)</span>
            <span class="c1"># rowSelected = eval(rowSelected_cmd)</span>
            <span class="c1"># rowIndex = (rowSelected[0].row())</span>
            <span class="c1"># sito = str(self.comboBox_sito.currentText())</span>
            <span class="c1"># area = str(self.comboBox_area.currentText())</span>
            <span class="c1"># us_item = self.tableWidget_rapporti.item(rowIndex, 1)</span>
            <span class="c1"># us = str(us_item.text())</span>
            <span class="c1"># search_dict = {&#39;sito&#39;: &quot;&#39;&quot; + str(sito) + &quot;&#39;&quot;,</span>
                           <span class="c1"># &#39;area&#39;: &quot;&#39;&quot; + str(area) + &quot;&#39;&quot;,</span>
                           <span class="c1"># &#39;us&#39;: us}</span>
            <span class="c1"># u = Utility()</span>
            <span class="c1"># search_dict = u.remove_empty_items_fr_dict(search_dict)</span>
            <span class="c1"># res = self.DB_MANAGER.query_bool(search_dict, self.MAPPER_TABLE_CLASS)</span>
            <span class="c1"># if not bool(res):</span>
                
                <span class="c1"># #self.DB_MANAGER.insert_number_of_us_records(sito,area,us,&#39;US&#39;)</span>
                        
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Non e&#39; stato trovato alcun record!&quot;, QMessageBox.Ok)</span>
                    
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;kein Eintrag gefunden!&quot;, QMessageBox.Ok)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Warning&quot;, &quot;The record has not been found &quot;, QMessageBox.Ok)</span>
                <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
                <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
                <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;False&quot;)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;False&quot;)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;False&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.empty_fields()</span>
                <span class="c1"># self.DATA_LIST = []</span>
                <span class="c1"># for i in res:</span>
                    <span class="c1"># self.DATA_LIST.append(i)</span>
                <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
                <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
                <span class="c1"># self.fill_fields()</span>
                <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
                <span class="c1"># if self.REC_TOT == 1:</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># strings = (&quot;E&#39; stato trovato&quot;, self.REC_TOT, &quot;record&quot;)</span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># strings = (&quot;Es wurde gefunden&quot;, self.REC_TOT, &quot;record&quot;)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># strings = (&quot;has been found&quot;, self.REC_TOT, &quot;record&quot;)</span>
                    <span class="c1"># if self.toolButtonGis.isChecked():</span>
                        <span class="c1"># self.pyQGIS.charge_vector_layers(self.DATA_LIST)</span>
                
                    <span class="c1"># if self.toolButton_usm.isChecked():</span>
                        <span class="c1"># self.pyQGIS.charge_usm_layers(self.DATA_LIST)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># strings = (&quot;Sono stati trovati&quot;, self.REC_TOT, &quot;records&quot;)</span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># strings = (&quot;Sie wurden gefunden&quot;, self.REC_TOT, &quot;records&quot;)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># strings = (&quot;Have been found&quot;, self.REC_TOT, &quot;records&quot;)</span>
                    <span class="c1"># if self.toolButtonGis.isChecked():</span>
                        <span class="c1"># self.pyQGIS.charge_vector_layers(self.DATA_LIST)</span>
                    <span class="c1"># if self.toolButton_usm.isChecked():</span>
                        <span class="c1"># self.pyQGIS.charge_usm_layers(self.DATA_LIST)</span>
                
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;False&quot;)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;False&quot;)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;False&quot;)</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>

        
    <span class="c1"># def on_pushButton_go_to_scheda_pressed(self):</span>
        <span class="c1"># try:</span>
            <span class="c1"># #table_name = &quot;self.table&quot;</span>
            <span class="c1"># #rowSelected_cmd = (&quot;%s.selectedIndexes()&quot;) % (table_name)</span>
            <span class="c1"># rowSelected = self.table.currentIndex()#eval(rowSelected_cmd)</span>
            <span class="c1"># rowIndex = rowSelected.row()</span>
            <span class="c1"># sito_item = self.table.model().index(rowIndex,1)</span>
            <span class="c1"># area_item = self.table.model().index(rowIndex,2)</span>
            <span class="c1"># #us = str(self.lineEdit_us.text())</span>
            <span class="c1"># us_item = self.table.model().index(rowIndex,3)</span>
            <span class="c1"># #for i in us_item:</span>
            <span class="c1"># sito =self.table.model().data(sito_item)</span>
            <span class="c1"># area= self.table.model().data(area_item)</span>
            <span class="c1"># us = self.table.model().data(us_item)</span>
            <span class="c1"># search_dict = {&#39;sito&#39;: &quot;&#39;&quot; + str(sito) + &quot;&#39;&quot;,</span>
                           <span class="c1"># &#39;area&#39;: &quot;&#39;&quot; + str(area) + &quot;&#39;&quot;,</span>
                           <span class="c1"># &#39;us&#39;: us}</span>
            <span class="c1"># u = Utility()</span>
            <span class="c1"># search_dict = u.remove_empty_items_fr_dict(search_dict)</span>
            <span class="c1"># res = self.DB_MANAGER.query_bool(search_dict, self.MAPPER_TABLE_CLASS)</span>
            <span class="c1"># self.empty_fields()</span>
            <span class="c1"># self.DATA_LIST = []</span>
            <span class="c1"># for i in res:</span>
                <span class="c1"># self.DATA_LIST.append(i)</span>
            <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
            <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
            <span class="c1"># self.fill_fields()</span>
            <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
            <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
            <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
        <span class="c1"># except Exception as e:</span>
            <span class="c1"># e = str(e)</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Alert&quot;, &quot;Non hai selezionato nessuna riga. Errore python: %s &quot; % (str(e)),</span>
                                <span class="c1"># QMessageBox.Ok)</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Keine Spalte ausgew√§lt. Error python: %s &quot; % (str(e)),</span>
                                <span class="c1"># QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Alert&quot;, &quot;You didn&#39;t select any row. Python error: %s &quot; % (str(e)),</span>
                                <span class="c1"># QMessageBox.Ok)  </span>
    <span class="c1"># def enable_button(self, n):</span>
        <span class="c1"># self.pushButton_list.setEnabled(n)</span>
        <span class="c1"># self.pushButton_new_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_view_all.setEnabled(n)</span>
        <span class="c1"># self.pushButton_first_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_last_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_prev_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_next_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_delete.setEnabled(n)</span>
        <span class="c1"># self.pushButton_new_search.setEnabled(n)</span>
        <span class="c1"># self.pushButton_search_go.setEnabled(n)</span>
        <span class="c1"># self.pushButton_sort.setEnabled(n)</span>
    <span class="c1"># def enable_button_search(self, n):</span>
        <span class="c1"># # self.pushButton_connect.setEnabled(n)</span>
        <span class="c1"># self.pushButton_new_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_view_all.setEnabled(n)</span>
        <span class="c1"># self.pushButton_first_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_last_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_prev_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_next_rec.setEnabled(n)</span>
        <span class="c1"># self.pushButton_delete.setEnabled(n)</span>
        <span class="c1"># self.pushButton_save.setEnabled(n)</span>
        <span class="c1"># self.pushButton_sort.setEnabled(n)</span>
        <span class="c1"># self.pushButton_sort.setEnabled(n)</span>
        <span class="c1"># self.pushButton_insert_row_rapporti.setEnabled(n)</span>
        <span class="c1"># self.pushButton_remove_row_rapporti.setEnabled(n)</span>
        <span class="c1"># self.pushButton_insert_row_inclusi.setEnabled(n)</span>
        <span class="c1"># self.pushButton_remove_row_inclusi.setEnabled(n)</span>
        <span class="c1"># self.pushButton_insert_row_campioni.setEnabled(n)</span>
        <span class="c1"># self.pushButton_remove_row_campioni.setEnabled(n)</span>
        <span class="c1"># self.pushButton_insert_row_organici.setEnabled(n)</span>
        <span class="c1"># self.pushButton_remove_row_organici.setEnabled(n)</span>
        <span class="c1"># self.pushButton_insert_row_inorganici.setEnabled(n)</span>
        <span class="c1"># self.pushButton_remove_row_inorganici.setEnabled(n)</span>
        <span class="c1"># self.pushButton_insert_row_documentazione.setEnabled(n)</span>
        <span class="c1"># self.pushButton_remove_row_documentazione.setEnabled(n)</span>
    <span class="c1"># def on_pushButton_connect_pressed(self):</span>
        
        <span class="c1"># conn = Connection()</span>
        <span class="c1"># conn_str = conn.conn_str()</span>
        <span class="c1"># test_conn = conn_str.find(&#39;sqlite&#39;)</span>
        <span class="c1"># if test_conn == 0:</span>
            <span class="c1"># self.DB_SERVER = &quot;sqlite&quot;</span>
            
        <span class="c1"># try:</span>
            <span class="c1"># self.DB_MANAGER = Pyarchinit_db_management(conn_str)</span>
            <span class="c1"># self.DB_MANAGER.connection()</span>
            <span class="c1"># self.charge_records()  # charge records from DB</span>
            <span class="c1"># # check if DB is empty</span>
            <span class="c1"># if self.DATA_LIST:</span>
                <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
                <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
                <span class="c1"># self.BROWSE_STATUS = &#39;b&#39;</span>
                <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[&quot;n&quot;])</span>
                <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
                <span class="c1"># self.charge_list()</span>
                <span class="c1"># self.fill_fields()</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;False&quot;)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;False&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self,&quot;BENVENUTO&quot;, &quot;Benvenuto in pyArchInit &quot; + self.NOME_SCHEDA + &quot;. Il database e&#39; vuoto. Premi &#39;Ok&#39; e buon lavoro!&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self,&quot;WILLKOMMEN&quot;,&quot;WILLKOMMEN in pyArchInit&quot; + &quot;SE-MSE formular&quot;+ &quot;. Die Datenbank ist leer. Tippe &#39;Ok&#39; und aufgehts!&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok) </span>
                <span class="c1"># else:</span>
                    <span class="c1"># QMessageBox.warning(self,&quot;WELCOME&quot;, &quot;Welcome in pyArchInit&quot; + &quot;Samples SU-WSU&quot; + &quot;. The DB is empty. Push &#39;Ok&#39; and Good Work!&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)    </span>
                <span class="c1"># self.charge_list()</span>
                <span class="c1"># self.BROWSE_STATUS = &#39;x&#39;</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;True&quot;)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;True&quot;)</span>
                <span class="c1"># self.on_pushButton_new_rec_pressed()</span>
        <span class="c1"># except Exception as e:</span>
            <span class="c1"># e = str(e)</span>
            <span class="c1"># if e.find(&quot;no such table&quot;):</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># msg = &quot;La connessione e&#39; fallita {}. &quot; \</span>
                          <span class="c1"># &quot;E&#39; NECESSARIO RIAVVIARE QGIS oppure rilevato bug! Segnalarlo allo sviluppatore&quot;.format(str(e))</span>
                    <span class="c1"># self.iface.messageBar().pushMessage(self.tr(msg), Qgis.Warning, 0)</span>
                    
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># msg = &quot;Verbindungsfehler {}. &quot; \</span>
                          <span class="c1"># &quot; QGIS neustarten oder es wurde ein bug gefunden! Fehler einsenden&quot;.format(str(e))</span>
                    <span class="c1"># self.iface.messageBar().pushMessage(self.tr(msg), Qgis.Warning, 0)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># msg = &quot;The connection failed {}. &quot; \</span>
                          <span class="c1"># &quot;You MUST RESTART QGIS or bug detected! Report it to the developer&quot;.format(str(e))        </span>
            <span class="c1"># else:</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># msg = &quot;Attenzione rilevato bug! Segnalarlo allo sviluppatore. Errore: &quot;.format(str(e))</span>
                    <span class="c1"># self.iface.messageBar().pushMessage(self.tr(msg), Qgis.Warning, 0)</span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># msg = &quot;ACHTUNG. Es wurde ein bug gefunden! Fehler einsenden: &quot;.format(str(e))</span>
                    <span class="c1"># self.iface.messageBar().pushMessage(self.tr(msg), Qgis.Warning, 0)  </span>
                <span class="c1"># else:</span>
                    <span class="c1"># msg = &quot;Warning bug detected! Report it to the developer. Error: &quot;.format(str(e))</span>
                    <span class="c1"># self.iface.messageBar().pushMessage(self.tr(msg), Qgis.Warning, 0)    </span>
    <span class="c1"># def customize_GUI(self):</span>
        <span class="c1"># l = QgsSettings().value(&quot;locale/userLocale&quot;, QVariant)[0:2]</span>
        <span class="c1"># lang = &quot;&quot;</span>
        <span class="c1"># for key, values in self.LANG.items():</span>
            <span class="c1"># if values.__contains__(l):</span>
                <span class="c1"># lang = str(key)</span>
        <span class="c1"># lang = &quot;&#39;&quot; + lang + &quot;&#39;&quot;</span>
        <span class="c1"># if not Pyarchinit_OS_Utility.checkGraphvizInstallation():</span>
            <span class="c1"># self.pushButton_export_matrix.setEnabled(False)</span>
            <span class="c1"># self.pushButton_export_matrix.setToolTip(&quot;Funzione disabilitata&quot;)</span>
        <span class="c1"># self.tableWidget_rapporti.setColumnWidth(0, 120)</span>
        <span class="c1"># self.tableWidget_rapporti.setColumnWidth(1, 80)</span>
        <span class="c1"># self.tableWidget_rapporti2.setColumnWidth(0, 80)</span>
        <span class="c1"># self.tableWidget_rapporti2.setColumnWidth(1, 50)</span>
        <span class="c1"># self.tableWidget_rapporti2.setColumnWidth(2, 50)</span>
        <span class="c1"># self.tableWidget_rapporti2.setColumnWidth(3, 200)</span>
        <span class="c1"># self.tableWidget_rapporti2.setColumnWidth(4, 100)</span>
        <span class="c1"># # self.tableWidget_rapporti2.sortItems(0,QtCore.Qt.AscendingOrder)</span>
        <span class="c1"># # self.tableWidget_rapporti.sortItems(0,QtCore.Qt.AscendingOrder)</span>
        <span class="c1"># self.tableWidget_documentazione.setColumnWidth(0, 150)</span>
        <span class="c1"># self.tableWidget_documentazione.setColumnWidth(1, 300)</span>
        
        <span class="c1"># self.mapPreview = QgsMapCanvas(self)</span>
        <span class="c1"># self.mapPreview.setCanvasColor(QColor(225, 225, 225))</span>
        <span class="c1"># self.tabWidget.addTab(self.mapPreview, &quot;Piante&quot;)</span>
        <span class="c1"># # media prevew system</span>
        
        <span class="c1"># self.iconListWidget.setLineWidth(2)</span>
        <span class="c1"># self.iconListWidget.setMidLineWidth(2)</span>
        <span class="c1"># self.iconListWidget.setProperty(&quot;showDropIndicator&quot;, False)</span>
        <span class="c1"># self.iconListWidget.setIconSize(QSize(430, 570))</span>
        
        <span class="c1"># self.iconListWidget.setUniformItemSizes(True)</span>
        <span class="c1"># self.iconListWidget.setObjectName(&quot;iconListWidget&quot;)</span>
        <span class="c1"># self.iconListWidget.SelectionMode()</span>
        <span class="c1"># self.iconListWidget.setSelectionMode(QAbstractItemView.ExtendedSelection)</span>
        <span class="c1"># self.iconListWidget.itemDoubleClicked.connect(self.openWide_image)</span>
        <span class="c1"># #self.listWidget_2.itemDoubleClicked.connect(self.opentepmplatePreview)</span>
        <span class="c1"># # comboBox customizations</span>
        
        <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_per_fin&quot;], 1)</span>
        <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_fas_fin&quot;], 1)</span>
        <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_per_iniz&quot;], 1)</span>
        <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_fas_iniz&quot;], 1)</span>
        <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_struttura&quot;], 1)</span>
        <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_ref_ra&quot;], 1)</span>
        <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_datazione&quot;],1)</span>
        <span class="c1"># # lista tipo rapporti stratigrafici</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># valuesRS = [&quot;Uguale a&quot;, &quot;Si lega a&quot;, &quot;Copre&quot;, &quot;Coperto da&quot;, &quot;Riempie&quot;, &quot;Riempito da&quot;, &quot;Taglia&quot;, &quot;Tagliato da&quot;, &quot;Si appoggia a&quot;, &quot;Gli si appoggia&quot;, &quot;&gt;&quot;,&quot;&lt;&quot;,&quot;&lt;&lt;&quot;,&quot;&gt;&gt;&quot;,&quot;&lt;-&gt;&quot;,&quot;&quot;]</span>
            <span class="c1"># self.delegateRS = ComboBoxDelegate()</span>
            <span class="c1"># self.delegateRS.def_values(valuesRS)</span>
            <span class="c1"># self.delegateRS.def_editable(&#39;False&#39;)</span>
            <span class="c1"># self.tableWidget_rapporti.setItemDelegateForColumn(0,self.delegateRS)</span>
           
        <span class="c1"># elif self.L==&#39;en&#39;:</span>
            <span class="c1"># valuesRS = [&quot;Same as&quot;, &quot;Connected to&quot;, &quot;Covers&quot;, &quot;Covered by&quot;, &quot;Fills&quot;, &quot;Filled by&quot;, &quot;Cuts&quot;, &quot;Cutted by&quot;, &quot;Abuts&quot;, &quot;Supports&quot;, &quot;&gt;&quot;,&quot;&lt;&quot;,&quot;&lt;&lt;&quot;,&quot;&gt;&gt;&quot;,&quot;&lt;-&gt;&quot;,&quot;&quot;]</span>
            <span class="c1"># self.delegateRS = ComboBoxDelegate()</span>
            <span class="c1"># self.delegateRS.def_values(valuesRS)</span>
            <span class="c1"># self.delegateRS.def_editable(&#39;False&#39;)</span>
            <span class="c1"># self.tableWidget_rapporti.setItemDelegateForColumn(0,self.delegateRS)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># valuesRS = [&quot;Entspricht&quot;, &quot;Bindet an&quot;, &quot;Liegt √ºber&quot;, &quot;Liegt unter&quot;, &quot;Verf√ºllt&quot;, &quot;Wird verf√ºllt durch&quot;, &quot;Schneidet&quot;, &quot;Wird geschnitten&quot;, &quot;St√ºtzt sich auf&quot;, &quot;Wird gest√ºzt von&quot;, &quot;&gt;&quot;,&quot;&lt;&quot;,&quot;&lt;&lt;&quot;,&quot;&gt;&gt;&quot;,&quot;&lt;-&gt;&quot;,&quot;&quot;]</span>
            <span class="c1"># self.delegateRS = ComboBoxDelegate()</span>
            <span class="c1"># self.delegateRS.def_values(valuesRS)</span>
            <span class="c1"># self.delegateRS.def_editable(&#39;False&#39;)</span>
            <span class="c1"># self.tableWidget_rapporti.setItemDelegateForColumn(0,self.delegateRS)</span>
        <span class="c1"># else:</span>
            <span class="c1"># valuesRS = [&quot;Same as&quot;, &quot;Connected to&quot;, &quot;Covers&quot;, &quot;Covered by&quot;, &quot;Fills&quot;, &quot;Filled by&quot;, &quot;Cuts&quot;, &quot;Cutted by&quot;, &quot;Abuts&quot;, &quot;Supports&quot;, &quot;&gt;&quot;,&quot;&lt;&quot;,&quot;&lt;&lt;&quot;,&quot;&gt;&gt;&quot;,&quot;&lt;-&gt;&quot;,&quot;&quot;]</span>
            <span class="c1"># self.delegateRS = ComboBoxDelegate()</span>
            <span class="c1"># self.delegateRS.def_values(valuesRS)</span>
            <span class="c1"># self.delegateRS.def_editable(&#39;False&#39;)</span>
            <span class="c1"># self.tableWidget_rapporti.setItemDelegateForColumn(0,self.delegateRS)</span>
        <span class="c1"># # lista tipo documentazione</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.19&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># tipo_di_documentazione = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesDoc = []</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># valuesDoc.append(&quot;ICCD-Piante&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;ICCD-Piante&amp;Sezioni&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;ICCD-Sezioni&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;ICCD-Prospetti&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;ICCD-Foto&quot;)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># valuesDoc.append(&quot;Pflanzen&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;Sektionen&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;Prospekte&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;Foto&quot;)</span>
        <span class="c1"># else:</span>
            <span class="c1"># valuesDoc.append(&quot;Maps&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;Sections&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;Elevations&quot;)</span>
            <span class="c1"># valuesDoc.append(&quot;Photo&quot;)</span>
        
        <span class="c1"># for i in range(len(tipo_di_documentazione)):</span>
            <span class="c1"># valuesDoc.append(tipo_di_documentazione[i].sigla_estesa)</span>
        <span class="c1"># #valuesDoc.sort()</span>
        <span class="c1"># self.delegateDoc = ComboBoxDelegate()</span>
        <span class="c1"># self.delegateDoc.def_values(valuesDoc)</span>
        <span class="c1"># self.delegateDoc.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_documentazione.setItemDelegateForColumn(0, self.delegateDoc)</span>
        
        
        
        
        <span class="c1"># # lista colore legante usm</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;201.201&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># colore = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesCol = []</span>
        <span class="c1"># for i in range(len(colore)):</span>
            <span class="c1"># valuesCol.append(colore[i].sigla_estesa)</span>
        <span class="c1"># valuesCol.sort()</span>
        <span class="c1"># self.delegateCol = ComboBoxDelegate()</span>
        <span class="c1"># self.delegateCol.def_values(valuesCol)</span>
        <span class="c1"># self.delegateCol.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_colore_legante_usm.setItemDelegateForColumn(0, self.delegateCol)</span>
        <span class="c1"># # lista colore materiale usm</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;201.201&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># colore = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesCol = []</span>
        <span class="c1"># for i in range(len(colore)):</span>
            <span class="c1"># valuesCol.append(colore[i].sigla_estesa)</span>
        <span class="c1"># valuesCol.sort()</span>
        <span class="c1"># self.delegateCol = ComboBoxDelegate()</span>
        <span class="c1"># self.delegateCol.def_values(valuesCol)</span>
        <span class="c1"># self.delegateCol.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_colore_materiale_usm.setItemDelegateForColumn(0, self.delegateCol)</span>
        <span class="c1"># # lista inclusi leganti usm</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;202.202&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># # inclusi = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># # valuesInclusi = []</span>
        <span class="c1"># # for i in range(len(inclusi)):</span>
            <span class="c1"># # valuesInclusi.append(inclusi[i].sigla_estesa)</span>
        <span class="c1"># # valuesCol.sort()</span>
        <span class="c1"># # self.delegateInclusi = ComboBoxDelegate()</span>
        <span class="c1"># # self.delegateInclusi.def_values(valuesInclusi)</span>
        <span class="c1"># # self.delegateInclusi.def_editable(&#39;False&#39;)</span>
        <span class="c1"># # self.tableWidget_inclusi_leganti_usm.setItemDelegateForColumn(0, self.delegateInclusi)</span>
        <span class="c1"># # # lista inclusi materiali usm</span>
        <span class="c1"># # search_dict = {</span>
            <span class="c1"># # &#39;lingua&#39;: lang,</span>
            <span class="c1"># # &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># # &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;202.202&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># # }</span>
        <span class="c1"># inclusi = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesInclusi = []</span>
        <span class="c1"># for i in range(len(inclusi)):</span>
            <span class="c1"># valuesInclusi.append(inclusi[i].sigla_estesa)</span>
        <span class="c1"># valuesCol.sort()</span>
        <span class="c1"># self.delegateInclusi = ComboBoxDelegate()</span>
        <span class="c1"># self.delegateInclusi.def_values(valuesInclusi)</span>
        <span class="c1"># self.delegateInclusi.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_inclusi_materiali_usm.setItemDelegateForColumn(0, self.delegateInclusi)</span>
        <span class="c1"># # lista consistenza/texture materiale usm</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.7&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># constex = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesCTX = []</span>
        <span class="c1"># for i in range(len(constex)):</span>
            <span class="c1"># valuesCTX.append(constex[i].sigla_estesa)</span>
        <span class="c1"># valuesCol.sort()</span>
        <span class="c1"># self.delegateCons = ComboBoxDelegate()</span>
        <span class="c1"># self.delegateCons.def_values(valuesCTX)</span>
        <span class="c1"># self.delegateCons.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_consistenza_texture_mat_usm.setItemDelegateForColumn(0, self.delegateCons)</span>
        <span class="c1"># # lista componenti organici</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.14&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># comporg = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesCOG = []</span>
        <span class="c1"># for i in range(len(comporg)):</span>
            <span class="c1"># valuesCOG.append(comporg[i].sigla_estesa)</span>
        <span class="c1"># valuesCOG.sort()</span>
        <span class="c1"># self.delegateCOG = ComboBoxDelegate()</span>
        <span class="c1"># self.delegateCOG.def_values(valuesCOG)</span>
        <span class="c1"># self.delegateCOG.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_organici.setItemDelegateForColumn(0, self.delegateCOG)</span>
        <span class="c1"># # lista componenti inorganici</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.15&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># compinorg = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesCINOG = []</span>
        <span class="c1"># for i in range(len(compinorg)):</span>
            <span class="c1"># valuesCINOG.append(compinorg[i].sigla_estesa)</span>
        <span class="c1"># valuesCINOG.sort()</span>
        <span class="c1"># self.delegateCINOG = ComboBoxDelegate()</span>
        <span class="c1"># self.delegateCINOG.def_values(valuesCINOG)</span>
        <span class="c1"># self.delegateCINOG.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_inorganici.setItemDelegateForColumn(0, self.delegateCINOG)</span>
        <span class="c1"># #lista campioni</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.13&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># tipo_inclusi_campioni = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesINCL_CAMP = []</span>
        <span class="c1"># for i in range(len(tipo_inclusi_campioni)):</span>
            <span class="c1"># valuesINCL_CAMP.append(tipo_inclusi_campioni[i].sigla_estesa)</span>
        <span class="c1"># valuesINCL_CAMP.sort()</span>
        <span class="c1"># #valuesINCL_CAMP = [&quot;Terra&quot;,</span>
         <span class="c1"># #                  &quot;Pietre&quot;,</span>
         <span class="c1"># #                  &quot;Laterizio&quot;,</span>
         <span class="c1"># #                  &quot;Ciottoli&quot;,</span>
         <span class="c1"># #                  &quot;Calcare&quot;,</span>
         <span class="c1"># #                  &quot;Calce&quot;,</span>
          <span class="c1"># #                 &quot;Carboni&quot;,</span>
         <span class="c1"># #                  &quot;Concotto&quot;,</span>
         <span class="c1"># #                  &quot;Ghiaia&quot;,</span>
         <span class="c1"># #                  &quot;Cariossidi&quot;,</span>
         <span class="c1"># #                  &quot;Malacofauna&quot;,</span>
          <span class="c1"># #                 &quot;Sabbia&quot;,</span>
          <span class="c1"># #                 &quot;Malta&quot;,</span>
          <span class="c1"># #                 &quot;Ceramica&quot;,</span>
          <span class="c1"># #                 &quot;Metalli&quot;,</span>
          <span class="c1"># #                 &quot;Fr. ossei umani&quot;,</span>
           <span class="c1"># #                &quot;Fr. ossei animali&quot;,</span>
           <span class="c1"># #                &quot;Fr. lapidei&quot;]</span>
        <span class="c1"># self.delegateINCL_CAMP = ComboBoxDelegate()</span>
        <span class="c1"># valuesINCL_CAMP.sort()</span>
        <span class="c1"># self.delegateINCL_CAMP.def_values(valuesINCL_CAMP)</span>
        <span class="c1"># self.delegateINCL_CAMP.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_campioni.setItemDelegateForColumn(0, self.delegateINCL_CAMP)</span>
        <span class="c1"># # lista inclusi</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;202.202&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># tipo_inclusi = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesINCL = []</span>
        <span class="c1"># for i in range(len(tipo_inclusi)):</span>
            <span class="c1"># valuesINCL.append(tipo_inclusi[i].sigla_estesa)</span>
        <span class="c1"># valuesINCL.sort()</span>
        <span class="c1"># self.delegateINCL = ComboBoxDelegate()</span>
        <span class="c1"># self.delegateINCL.def_values(valuesINCL)</span>
        <span class="c1"># self.delegateINCL.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_inclusi.setItemDelegateForColumn(0, self.delegateINCL)</span>
    <span class="c1"># # def loadMedialist(self):</span>
        <span class="c1"># # self.tableWidget_foto.clear()</span>
        <span class="c1"># # col =[&#39;Sito&#39;,&#39;Area&#39;,&#39;US&#39;,&#39;Definizione&#39;]</span>
        <span class="c1"># # self.tableWidget_foto.setHorizontalHeaderLabels(col)</span>
        <span class="c1"># # numRows = self.tableWidget_foto.setRowCount(100)</span>
        <span class="c1"># # try: </span>
            <span class="c1"># # search_dict = {</span>
                <span class="c1"># # &#39;sito&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)]. &quot; + self.ID_SITO)) + &quot;&#39;&quot;}</span>
            <span class="c1"># # record_us_list = self.DB_MANAGER.query_bool(search_dict, &#39;US&#39;)</span>
            <span class="c1"># # nus=0</span>
            <span class="c1"># # for b in record_us_list:</span>
                <span class="c1"># # if nus== 0:</span>
                    <span class="c1"># # self.tableWidget_foto.setItem(nus, 0, QTableWidgetItem(str(b.sito)))</span>
                    <span class="c1"># # self.tableWidget_foto.setItem(nus, 1, QTableWidgetItem(str(b.area)))</span>
                    <span class="c1"># # self.tableWidget_foto.setItem(nus, 3, QTableWidgetItem(str(b.d_stratigrafica)))</span>
                    <span class="c1"># # self.tableWidget_foto.setItem(nus, 2, QTableWidgetItem(str(b.us)))    </span>
                    <span class="c1"># # nus+=1</span>
                <span class="c1"># # else:</span>
                    <span class="c1"># # self.tableWidget_foto.setItem(nus, 0, QTableWidgetItem(str(b.sito)))</span>
                    <span class="c1"># # self.tableWidget_foto.setItem(nus, 1, QTableWidgetItem(str(b.area)))</span>
                    <span class="c1"># # self.tableWidget_foto.setItem(nus, 3, QTableWidgetItem(str(b.d_stratigrafica)))</span>
                    <span class="c1"># # self.tableWidget_foto.setItem(nus, 2, QTableWidgetItem(str(b.us)))    </span>
                    <span class="c1"># # nus+=1 </span>
        <span class="c1"># # except:</span>
            <span class="c1"># # pass</span>
        <span class="c1"># # search_dict = {</span>
            <span class="c1"># # &#39;id_entity&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].&quot; + self.ID_TABLE)) + &quot;&#39;&quot;,</span>
            <span class="c1"># # &#39;entity_type&#39;: &quot;&#39;US&#39;&quot;}</span>
        <span class="c1"># # record_media_list = self.DB_MANAGER.query_bool(search_dict, &#39;MEDIATOENTITY&#39;)</span>
        <span class="c1"># # n=0</span>
        <span class="c1"># # for a in record_media_list:</span>
            <span class="c1"># # if n== 0:</span>
                <span class="c1"># # self.tableWidget_foto.setItem(n, 3,QTableWidgetItem(str(a.media_name)))</span>
                <span class="c1"># # n+=1</span>
            <span class="c1"># # else:</span>
                <span class="c1"># # self.tableWidget_foto.setItem(n, 3,QTableWidgetItem(str(a.media_name)))</span>
                <span class="c1"># # n+=1</span>
    <span class="c1"># def loadMapPreview(self, mode=0):</span>
        <span class="c1"># if mode == 0:</span>
            <span class="c1"># &quot;&quot;&quot; if has geometry column load to map canvas &quot;&quot;&quot;</span>
            <span class="c1"># gidstr = self.ID_TABLE + &quot; = &quot; + str(</span>
                <span class="c1"># eval(&quot;self.DATA_LIST[int(self.REC_CORR)].&quot; + self.ID_TABLE))</span>
            <span class="c1"># layerToSet = self.pyQGIS.loadMapPreview(gidstr)</span>
            <span class="c1"># QMessageBox.warning(self, &quot;layer to set&quot;, &#39;\n&#39;.join([l.name() for l in layerToSet]), QMessageBox.Ok)</span>
            <span class="c1"># self.mapPreview.setLayers(layerToSet)</span>
            <span class="c1"># self.mapPreview.zoomToFullExtent()</span>
        <span class="c1"># elif mode == 1:</span>
            <span class="c1"># self.mapPreview.setLayers([])</span>
            <span class="c1"># self.mapPreview.zoomToFullExtent()</span>
    <span class="c1"># def loadMediaPreview(self):</span>
        <span class="c1"># self.iconListWidget.clear()</span>
        <span class="c1"># conn = Connection()</span>
        <span class="c1"># thumb_path = conn.thumb_path()</span>
        <span class="c1"># thumb_path_str = thumb_path[&#39;thumb_path&#39;]</span>
        <span class="c1"># # if mode == 0:</span>
        <span class="c1"># # &quot;&quot;&quot; if has geometry column load to map canvas &quot;&quot;&quot;</span>
        <span class="c1"># rec_list = self.ID_TABLE + &quot; = &quot; + str(</span>
            <span class="c1"># eval(&quot;self.DATA_LIST[int(self.REC_CORR)].&quot; + self.ID_TABLE))</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;id_entity&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].&quot; + self.ID_TABLE)) + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;entity_type&#39;: &quot;&#39;US&#39;&quot;}</span>
        <span class="c1"># record_us_list = self.DB_MANAGER.query_bool(search_dict, &#39;MEDIATOENTITY&#39;)</span>
        <span class="c1"># for i in record_us_list:</span>
            <span class="c1"># search_dict = {&#39;id_media&#39;: &quot;&#39;&quot; + str(i.id_media) + &quot;&#39;&quot;}</span>
            <span class="c1"># u = Utility()</span>
            <span class="c1"># search_dict = u.remove_empty_items_fr_dict(search_dict)</span>
            <span class="c1"># mediathumb_data = self.DB_MANAGER.query_bool(search_dict, &quot;MEDIA_THUMB&quot;)</span>
            <span class="c1"># thumb_path = str(mediathumb_data[0].filepath)</span>
            <span class="c1"># item = QListWidgetItem(str(i.media_name))</span>
            <span class="c1"># item.setData(Qt.UserRole, str(i.media_name))</span>
            <span class="c1"># icon = QIcon(thumb_path_str+thumb_path)</span>
            <span class="c1"># item.setIcon(icon)</span>
            <span class="c1"># self.iconListWidget.addItem(item)</span>
        <span class="c1"># # elif mode == 1:</span>
            <span class="c1"># # self.iconListWidget.clear()</span>
    <span class="c1"># def openWide_image(self):</span>
        <span class="c1"># items = self.iconListWidget.selectedItems()</span>
        <span class="c1"># conn = Connection()</span>
        <span class="c1"># conn_str = conn.conn_str()</span>
        <span class="c1"># thumb_resize = conn.thumb_resize()</span>
        <span class="c1"># thumb_resize_str = thumb_resize[&#39;thumb_resize&#39;]</span>
        <span class="c1"># for item in items:</span>
            <span class="c1"># dlg = ImageViewer()</span>
            <span class="c1"># id_orig_item = item.text()  # return the name of original file</span>
            <span class="c1"># search_dict = {&#39;media_filename&#39;: &quot;&#39;&quot; + str(id_orig_item) + &quot;&#39;&quot; , &#39;mediatype&#39;: &quot;&#39;&quot; + &#39;video&#39; + &quot;&#39;&quot;} </span>
            <span class="c1"># u = Utility()</span>
            <span class="c1"># search_dict = u.remove_empty_items_fr_dict(search_dict)</span>
            <span class="c1"># #try:</span>
            <span class="c1"># res = self.DB_MANAGER.query_bool(search_dict, &quot;MEDIA_THUMB&quot;)</span>
            <span class="c1"># search_dict_2 = {&#39;media_filename&#39;: &quot;&#39;&quot; + str(id_orig_item) + &quot;&#39;&quot; , &#39;mediatype&#39;: &quot;&#39;&quot; + &#39;image&#39; + &quot;&#39;&quot;}  </span>
            <span class="c1"># search_dict_2 = u.remove_empty_items_fr_dict(search_dict_2)</span>
            <span class="c1"># #try:</span>
            <span class="c1"># res_2 = self.DB_MANAGER.query_bool(search_dict_2, &quot;MEDIA_THUMB&quot;)</span>
            <span class="c1"># search_dict_3 = {&#39;media_filename&#39;: &quot;&#39;&quot; + str(id_orig_item) + &quot;&#39;&quot;}  </span>
            <span class="c1"># search_dict_3 = u.remove_empty_items_fr_dict(search_dict_3)</span>
            <span class="c1"># #try:</span>
            <span class="c1"># res_3 = self.DB_MANAGER.query_bool(search_dict_3, &quot;MEDIA_THUMB&quot;)</span>
            <span class="c1"># # file_path = str(res[0].path_resize)</span>
            <span class="c1"># # file_path_2 = str(res_2[0].path_resize)</span>
            <span class="c1"># file_path_3 = str(res_3[0].path_resize)</span>
            <span class="c1"># if bool(res):</span>
                <span class="c1"># os.startfile(str(thumb_resize_str+file_path_3))</span>
            <span class="c1"># elif bool(res_2):</span>
                <span class="c1"># dlg.show_image(str(thumb_resize_str+file_path_3))  </span>
                <span class="c1"># dlg.exec_()</span>
    <span class="c1"># def charge_list(self):</span>
        <span class="c1"># l = QgsSettings().value(&quot;locale/userLocale&quot;, QVariant)</span>
        <span class="c1"># lang = &quot;&quot;</span>
        <span class="c1"># for key, values in self.LANG.items():</span>
            <span class="c1"># if values.__contains__(l):</span>
                <span class="c1"># lang = str(key)</span>
        <span class="c1"># lang = &quot;&#39;&quot; + lang + &quot;&#39;&quot;</span>
        <span class="c1"># # lista sito</span>
        <span class="c1"># sito_vl = self.UTILITY.tup_2_list_III(self.DB_MANAGER.group_by(&#39;site_table&#39;, &#39;sito&#39;, &#39;SITE&#39;))</span>
        <span class="c1"># try:</span>
            <span class="c1"># sito_vl.remove(&#39;&#39;)</span>
        <span class="c1"># except Exception as e:</span>
            <span class="c1"># if str(e) == &quot;list.remove(x): x not in list&quot;:</span>
                <span class="c1"># pass</span>
            <span class="c1"># else:</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;, &quot;Sistema di aggiornamento lista Sito: &quot; + str(e), QMessageBox.Ok)</span>
                <span class="c1"># elif self.L==&#39;en&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;, &quot;Site list update system: &quot; + str(e), QMessageBox.Ok)</span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Nachricht&quot;, &quot;Aktualisierungssystem f√ºr die Ausgrabungst√§tte: &quot; + str(e), QMessageBox.Ok)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># pass</span>
        <span class="c1"># self.comboBox_sito.clear()</span>
        <span class="c1"># self.comboBox_sito_rappcheck.clear()</span>
        <span class="c1"># sito_vl.sort()</span>
        <span class="c1"># self.comboBox_sito.addItems(sito_vl)</span>
        <span class="c1"># self.comboBox_sito_rappcheck.addItems(sito_vl)</span>
        
        <span class="c1"># responsabile_vl = self.UTILITY.tup_2_list_III(self.DB_MANAGER.group_by(&#39;us_table&#39;, &#39;schedatore&#39;, &#39;US&#39;))</span>
        <span class="c1"># try:</span>
            <span class="c1"># responsabile_vl.remove(&#39;&#39;)</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>
            
        <span class="c1"># self.comboBox_schedatore.clear()</span>
        <span class="c1"># responsabile_vl.sort()</span>
        <span class="c1"># self.comboBox_schedatore.addItems(responsabile_vl)</span>
        
        
        <span class="c1"># responsabile2_vl = self.UTILITY.tup_2_list_III(self.DB_MANAGER.group_by(&#39;us_table&#39;, &#39;direttore_us&#39;, &#39;US&#39;))</span>
        <span class="c1"># try:</span>
            <span class="c1"># responsabile2_vl.remove(&#39;&#39;)</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>
            
        <span class="c1"># self.comboBox_direttore_us.clear()</span>
        <span class="c1"># responsabile2_vl.sort()</span>
        <span class="c1"># self.comboBox_direttore_us.addItems(responsabile2_vl)</span>
        
        
        <span class="c1"># responsabile3_vl = self.UTILITY.tup_2_list_III(self.DB_MANAGER.group_by(&#39;us_table&#39;, &#39;responsabile_us&#39;, &#39;US&#39;))</span>
        <span class="c1"># try:</span>
            <span class="c1"># responsabile3_vl.remove(&#39;&#39;)</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>
            
        <span class="c1"># self.comboBox_responsabile_us.clear()</span>
        <span class="c1"># responsabile3_vl.sort()</span>
        <span class="c1"># self.comboBox_responsabile_us.addItems(responsabile3_vl)</span>
        
        
        
        
        
        <span class="c1"># self.comboBox_settore.clear()       </span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.1&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># settore = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># settore_vl = []</span>
        <span class="c1"># for i in range(len(settore)):</span>
            <span class="c1"># settore_vl.append(settore[i].sigla)</span>
        <span class="c1"># settore_vl.sort()</span>
        <span class="c1"># self.comboBox_settore.addItems(settore_vl)</span>
        <span class="c1"># # lista soprintendenza</span>
        <span class="c1"># self.comboBox_soprintendenza.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.2&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># soprintendenza = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># soprintendenza_vl = []</span>
        <span class="c1"># for i in range(len(soprintendenza)):</span>
            <span class="c1"># soprintendenza_vl.append(soprintendenza[i].sigla_estesa)</span>
        <span class="c1"># soprintendenza_vl.sort()</span>
        <span class="c1"># self.comboBox_soprintendenza.addItems(soprintendenza_vl)</span>
        <span class="c1"># # lista definizione_stratigrafica</span>
        <span class="c1"># self.comboBox_def_strat.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.3&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># d_stratigrafica = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># d_stratigrafica_vl = []</span>
        <span class="c1"># for i in range(len(d_stratigrafica)):</span>
            <span class="c1"># d_stratigrafica_vl.append(d_stratigrafica[i].sigla_estesa)</span>
        <span class="c1"># d_stratigrafica_vl.sort()</span>
        <span class="c1"># self.comboBox_def_strat.addItems(d_stratigrafica_vl)</span>
        <span class="c1"># # lista definizione interpretata</span>
        <span class="c1"># self.comboBox_def_intepret.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.4&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># d_interpretativa = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># d_interpretativa_vl = []</span>
        <span class="c1"># for i in range(len(d_interpretativa)):</span>
            <span class="c1"># d_interpretativa_vl.append(d_interpretativa[i].sigla_estesa)</span>
        <span class="c1"># d_interpretativa_vl.sort()</span>
        <span class="c1"># self.comboBox_def_intepret.addItems(d_interpretativa_vl)</span>
        <span class="c1"># # lista funzione statica</span>
        <span class="c1"># self.comboBox_funz_statica_usm.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.5&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># funz_statica = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># funz_statica_vl = []</span>
        <span class="c1"># for i in range(len(funz_statica)):</span>
            <span class="c1"># if funz_statica[i].sigla_estesa not in funz_statica_vl:</span>
                <span class="c1"># funz_statica_vl.append(funz_statica[i].sigla_estesa)</span>
        <span class="c1"># funz_statica_vl.sort()</span>
        <span class="c1"># self.comboBox_funz_statica_usm.addItems(funz_statica_vl)</span>
        <span class="c1"># #lista consistenza legante usm</span>
        <span class="c1"># self.comboBox_consistenza_legante_usm.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.6&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># consistenza_legante_usm = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># consistenza_legante_usm_vl = []</span>
        <span class="c1"># for i in range(len(consistenza_legante_usm)):</span>
            <span class="c1"># if consistenza_legante_usm[i].sigla_estesa not in consistenza_legante_usm_vl:</span>
                <span class="c1"># consistenza_legante_usm_vl.append(consistenza_legante_usm[i].sigla_estesa)</span>
        <span class="c1"># consistenza_legante_usm_vl.sort()</span>
        <span class="c1"># self.comboBox_consistenza_legante_usm.addItems(consistenza_legante_usm_vl)</span>
        <span class="c1"># # lista scavato</span>
        <span class="c1"># self.comboBox_scavato.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;203.203&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># scavato = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># scavato_vl = []</span>
        <span class="c1"># for i in range(len(scavato)):</span>
            <span class="c1"># if scavato[i].sigla_estesa not in scavato_vl:</span>
                <span class="c1"># scavato_vl.append(scavato[i].sigla_estesa)</span>
        <span class="c1"># scavato_vl.sort()</span>
        <span class="c1"># self.comboBox_scavato.addItems(scavato_vl)</span>
        <span class="c1"># # lista metodo di scavo</span>
        <span class="c1"># self.comboBox_metodo.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.8&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># metodo = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># metodo_vl = []</span>
        <span class="c1"># for i in range(len(metodo)):</span>
            <span class="c1"># if metodo[i].sigla_estesa not in metodo_vl:</span>
                <span class="c1"># metodo_vl.append(metodo[i].sigla_estesa)</span>
        <span class="c1"># metodo_vl.sort()</span>
        <span class="c1"># self.comboBox_metodo.addItems(metodo_vl)</span>
        <span class="c1"># # lista formazione</span>
        <span class="c1"># self.comboBox_formazione.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.9&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># formazione = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># formazione_vl = []</span>
        <span class="c1"># for i in range(len(formazione)):</span>
            <span class="c1"># if formazione[i].sigla_estesa not in formazione_vl:</span>
                <span class="c1"># formazione_vl.append(formazione[i].sigla_estesa)</span>
        <span class="c1"># formazione_vl.sort()</span>
        <span class="c1"># self.comboBox_formazione.addItems(formazione_vl)</span>
        <span class="c1"># # lista modo formazione</span>
        <span class="c1"># self.comboBox_modo_formazione.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.10&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># modo_formazione = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># modo_formazione_vl = []</span>
        <span class="c1"># for i in range(len(modo_formazione)):</span>
            <span class="c1"># if modo_formazione[i].sigla_estesa not in modo_formazione_vl:</span>
                <span class="c1"># modo_formazione_vl.append(modo_formazione[i].sigla_estesa)</span>
        <span class="c1"># modo_formazione_vl.sort()</span>
        <span class="c1"># self.comboBox_modo_formazione.addItems(modo_formazione_vl)</span>
        <span class="c1"># # lista colore</span>
        <span class="c1"># self.comboBox_colore.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;201.201&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># colore = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># colore_vl = []</span>
        <span class="c1"># for i in range(len(colore)):</span>
            <span class="c1"># if colore[i].sigla_estesa not in colore_vl:</span>
                <span class="c1"># colore_vl.append(colore[i].sigla_estesa)</span>
        <span class="c1"># colore_vl.sort()</span>
        <span class="c1"># self.comboBox_colore.addItems(colore_vl)</span>
        <span class="c1"># # lista consistenza</span>
        <span class="c1"># self.comboBox_consistenza.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.11&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># consistenza = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># consistenza_vl = []</span>
        <span class="c1"># for i in range(len(consistenza)):</span>
            <span class="c1"># if consistenza[i].sigla_estesa not in consistenza_vl:</span>
                <span class="c1"># consistenza_vl.append(consistenza[i].sigla_estesa)</span>
        <span class="c1"># consistenza_vl.sort()</span>
        <span class="c1"># self.comboBox_consistenza.addItems(consistenza_vl)</span>
        <span class="c1"># # lista stato di conservazione</span>
        <span class="c1"># self.comboBox_conservazione.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.12&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># conservazione = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># conservazione_vl = []</span>
        <span class="c1"># for i in range(len(conservazione)):</span>
            <span class="c1"># if conservazione[i].sigla_estesa not in conservazione_vl:</span>
                <span class="c1"># conservazione_vl.append(conservazione[i].sigla_estesa)</span>
        <span class="c1"># conservazione_vl.sort()</span>
        <span class="c1"># self.comboBox_conservazione.addItems(conservazione_vl)</span>
        <span class="c1"># # lista schedatore</span>
        <span class="c1"># # self.comboBox_schedatore.clear()</span>
        <span class="c1"># # search_dict = {</span>
            <span class="c1"># # &#39;lingua&#39;: lang,</span>
            <span class="c1"># # &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># # &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.16&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># #}</span>
        <span class="c1"># # schedatore = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># # schedatore_vl = []</span>
        <span class="c1"># # for i in range(len(schedatore)):</span>
            <span class="c1"># # if schedatore[i].sigla_estesa not in schedatore_vl:</span>
                <span class="c1"># # schedatore_vl.append(schedatore[i].sigla_estesa)</span>
        <span class="c1"># # schedatore_vl.sort()</span>
        <span class="c1"># # self.comboBox_schedatore.addItems(schedatore_vl)</span>
        <span class="c1"># # # lista direttore us</span>
        <span class="c1"># # self.comboBox_direttore_us.clear()</span>
        <span class="c1"># # search_dict = {</span>
            <span class="c1"># # &#39;lingua&#39;: lang,</span>
            <span class="c1"># # &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># # &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.17&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># # }</span>
        <span class="c1"># # direttore_us = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># # direttore_us_vl = []</span>
        <span class="c1"># # for i in range(len(direttore_us)):</span>
            <span class="c1"># # if direttore_us[i].sigla_estesa not in direttore_us_vl:</span>
                <span class="c1"># # direttore_us_vl.append(direttore_us[i].sigla_estesa)</span>
        <span class="c1"># # direttore_us_vl.sort()</span>
        <span class="c1"># # self.comboBox_direttore_us.addItems(direttore_us_vl)</span>
        <span class="c1"># # # lista responsabile us</span>
        <span class="c1"># # self.comboBox_responsabile_us.clear()</span>
        <span class="c1"># # search_dict = {</span>
            <span class="c1"># # &#39;lingua&#39;: lang,</span>
            <span class="c1"># # &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># # &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.18&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># # }</span>
        <span class="c1"># # responsabile_us = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># # responsabile_us_vl = []</span>
        <span class="c1"># # for i in range(len(responsabile_us)):</span>
            <span class="c1"># # if responsabile_us[i].sigla_estesa not in responsabile_us_vl:</span>
                <span class="c1"># # responsabile_us_vl.append(responsabile_us[i].sigla_estesa)</span>
        <span class="c1"># # responsabile_us_vl.sort()</span>
        <span class="c1"># # self.comboBox_responsabile_us.addItems(responsabile_us_vl)</span>
        
        
        <span class="c1"># # # lista tipologia_opera</span>
        <span class="c1"># self.comboBox_tipologia_opera.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.20&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># tipologia_opera = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># tipologia_opera_us_vl = []</span>
        <span class="c1"># for i in range(len(tipologia_opera)):</span>
            <span class="c1"># if tipologia_opera[i].sigla_estesa not in tipologia_opera_us_vl:</span>
                <span class="c1"># tipologia_opera_us_vl.append(tipologia_opera[i].sigla_estesa)</span>
        <span class="c1"># tipologia_opera_us_vl.sort()</span>
        <span class="c1"># self.comboBox_tipologia_opera.addItems(tipologia_opera_us_vl)</span>
        <span class="c1"># # lista sezione muraria</span>
        <span class="c1"># self.comboBox_sezione_muraria.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.21&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># sezione_muraria = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># sezione_muraria_us_vl = []</span>
        <span class="c1"># for i in range(len(sezione_muraria)):</span>
            <span class="c1"># if sezione_muraria[i].sigla_estesa not in sezione_muraria_us_vl:</span>
                <span class="c1"># sezione_muraria_us_vl.append(sezione_muraria[i].sigla_estesa)</span>
        <span class="c1"># sezione_muraria_us_vl.sort()</span>
        <span class="c1"># self.comboBox_sezione_muraria.addItems(sezione_muraria_us_vl)</span>
        <span class="c1"># # lista superficie_analizzata</span>
        <span class="c1"># self.comboBox_superficie_analizzata.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.22&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># sup_analiz = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># sup_analiz_vl = []</span>
        <span class="c1"># for i in range(len(sezione_muraria)):</span>
            <span class="c1"># if sup_analiz[i].sigla_estesa not in sup_analiz_vl:</span>
                <span class="c1"># sup_analiz_vl.append(sup_analiz[i].sigla_estesa)</span>
        <span class="c1"># sezione_muraria_us_vl.sort()</span>
        <span class="c1"># self.comboBox_superficie_analizzata.addItems(sup_analiz_vl)</span>
        <span class="c1"># # lista orientamento</span>
        <span class="c1"># self.comboBox_orientamento.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.23&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># orientamento = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># orientamento_us_vl = []</span>
        <span class="c1"># for i in range(len(orientamento)):</span>
            <span class="c1"># if orientamento[i].sigla_estesa not in orientamento_us_vl:</span>
                <span class="c1"># orientamento_us_vl.append(orientamento[i].sigla_estesa)</span>
        <span class="c1"># orientamento_us_vl.sort()</span>
        <span class="c1"># self.comboBox_orientamento.addItems(orientamento_us_vl)</span>
        <span class="c1"># # lista materiali_laterizi</span>
        <span class="c1"># self.comboBox_materiali_lat.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.24&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># materiali_lat = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># materiali_lat_us_vl = []</span>
        <span class="c1"># for i in range(len(materiali_lat)):</span>
            <span class="c1"># if materiali_lat[i].sigla_estesa not in materiali_lat_us_vl:</span>
                <span class="c1"># materiali_lat_us_vl.append(materiali_lat[i].sigla_estesa)</span>
        <span class="c1"># materiali_lat_us_vl.sort()</span>
        <span class="c1"># self.comboBox_materiali_lat.addItems(materiali_lat_us_vl)</span>
        <span class="c1"># # lista lavorazione laterizi</span>
        <span class="c1"># self.comboBox_lavorazione_lat.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.25&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># lavorazione_lat = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># lavorazione_lat_us_vl = []</span>
        <span class="c1"># for i in range(len(lavorazione_lat)):</span>
            <span class="c1"># if lavorazione_lat[i].sigla_estesa not in lavorazione_lat_us_vl:</span>
                <span class="c1"># lavorazione_lat_us_vl.append(lavorazione_lat[i].sigla_estesa)</span>
        <span class="c1"># lavorazione_lat_us_vl.sort()</span>
        <span class="c1"># self.comboBox_lavorazione_lat.addItems(lavorazione_lat_us_vl)</span>
        <span class="c1"># # lista consistenza laterizi</span>
        <span class="c1"># self.comboBox_consistenza_lat.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.26&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># consistenza_lat = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># consistenza_lat_us_vl = []</span>
        <span class="c1"># for i in range(len(consistenza_lat)):</span>
            <span class="c1"># if consistenza_lat[i].sigla_estesa not in consistenza_lat_us_vl:</span>
                <span class="c1"># consistenza_lat_us_vl.append(consistenza_lat[i].sigla_estesa)</span>
        <span class="c1"># consistenza_lat_us_vl.sort()</span>
        <span class="c1"># self.comboBox_consistenza_lat.addItems(consistenza_lat_us_vl)</span>
        <span class="c1"># # lista forma laterizi</span>
        <span class="c1"># self.comboBox_forma_lat.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.27&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># forma_lat = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># forma_lat_us_vl = []</span>
        <span class="c1"># for i in range(len(forma_lat)):</span>
            <span class="c1"># if forma_lat[i].sigla_estesa not in forma_lat_us_vl:</span>
                <span class="c1"># forma_lat_us_vl.append(forma_lat[i].sigla_estesa)</span>
        <span class="c1"># forma_lat_us_vl.sort()</span>
        <span class="c1"># self.comboBox_forma_lat.addItems(forma_lat_us_vl)</span>
        <span class="c1"># # lista colore laterizi</span>
        <span class="c1"># self.comboBox_colore_lat.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.28&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># colore_lat = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># colore_lat_us_vl = []</span>
        <span class="c1"># for i in range(len(colore_lat)):</span>
            <span class="c1"># if colore_lat[i].sigla_estesa not in colore_lat_us_vl:</span>
                <span class="c1"># colore_lat_us_vl.append(colore_lat[i].sigla_estesa)</span>
        <span class="c1"># colore_lat_us_vl.sort()</span>
        <span class="c1"># self.comboBox_colore_lat.addItems(colore_lat_us_vl)</span>
        <span class="c1"># # lista impasto laterizi</span>
        <span class="c1"># self.comboBox_impasto_lat.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.29&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># impasto_lat = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># impasto_lat_us_vl = []</span>
        <span class="c1"># for i in range(len(impasto_lat)):</span>
            <span class="c1"># if impasto_lat[i].sigla_estesa not in impasto_lat_us_vl:</span>
                <span class="c1"># impasto_lat_us_vl.append(impasto_lat[i].sigla_estesa)</span>
        <span class="c1"># impasto_lat_us_vl.sort()</span>
        <span class="c1"># self.comboBox_impasto_lat.addItems(impasto_lat_us_vl)</span>
        <span class="c1"># # lista materiali litici</span>
        <span class="c1"># self.comboBox_materiale_p.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.30&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># materiale_p = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># materiale_p_us_vl = []</span>
        <span class="c1"># for i in range(len(materiale_p)):</span>
            <span class="c1"># if materiale_p[i].sigla_estesa not in materiale_p_us_vl:</span>
                <span class="c1"># materiale_p_us_vl.append(materiale_p[i].sigla_estesa)</span>
        <span class="c1"># materiale_p_us_vl.sort()</span>
        <span class="c1"># self.comboBox_materiale_p.addItems(materiale_p_us_vl)</span>
        <span class="c1"># # lista consistenza materiali litici</span>
        <span class="c1"># self.comboBox_consistenza_p.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.31&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># consistenza_p = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># consistenza_p_us_vl = []</span>
        <span class="c1"># for i in range(len(consistenza_p)):</span>
            <span class="c1"># if consistenza_p[i].sigla_estesa not in consistenza_p_us_vl:</span>
                <span class="c1"># consistenza_p_us_vl.append(consistenza_p[i].sigla_estesa)</span>
        <span class="c1"># consistenza_p_us_vl.sort()</span>
        <span class="c1"># self.comboBox_consistenza_p.addItems(consistenza_p_us_vl)</span>
        <span class="c1"># # lista forma materiali litici</span>
        <span class="c1"># self.comboBox_forma_p.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.32&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># forma_p = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># forma_p_us_vl = []</span>
        <span class="c1"># for i in range(len(forma_p)):</span>
            <span class="c1"># if forma_p[i].sigla_estesa not in forma_p_us_vl:</span>
                <span class="c1"># forma_p_us_vl.append(forma_p[i].sigla_estesa)</span>
        <span class="c1"># forma_p_us_vl.sort()</span>
        <span class="c1"># self.comboBox_forma_p.addItems(forma_p_us_vl)</span>
        <span class="c1"># # lista colore materiali litici</span>
        <span class="c1"># self.comboBox_colore_p.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.33&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># colore_p = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># colore_p_us_vl = []</span>
        <span class="c1"># for i in range(len(colore_p)):</span>
            <span class="c1"># if colore_p[i].sigla_estesa not in colore_p_us_vl:</span>
                <span class="c1"># colore_p_us_vl.append(colore_p[i].sigla_estesa)</span>
        <span class="c1"># colore_p_us_vl.sort()</span>
        <span class="c1"># self.comboBox_colore_p.addItems(colore_p_us_vl)</span>
        <span class="c1"># # lista taglio materiali litici</span>
        <span class="c1"># self.comboBox_taglio_p.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.34&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># taglio_p = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># taglio_p_us_vl = []</span>
        <span class="c1"># for i in range(len(taglio_p)):</span>
            <span class="c1"># if taglio_p[i].sigla_estesa not in taglio_p_us_vl:</span>
                <span class="c1"># taglio_p_us_vl.append(taglio_p[i].sigla_estesa)</span>
        <span class="c1"># taglio_p_us_vl.sort()</span>
        <span class="c1"># self.comboBox_taglio_p.addItems(taglio_p_us_vl)</span>
        <span class="c1"># # lista posa opera materiali litici</span>
        <span class="c1"># self.comboBox_posa_opera_p.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.35&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># posa_opera_p = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># posa_opera_p_us_vl = []</span>
        <span class="c1"># for i in range(len(posa_opera_p)):</span>
            <span class="c1"># if posa_opera_p[i].sigla_estesa not in posa_opera_p_us_vl:</span>
                <span class="c1"># posa_opera_p_us_vl.append(posa_opera_p[i].sigla_estesa)</span>
        <span class="c1"># posa_opera_p_us_vl.sort()</span>
        <span class="c1"># self.comboBox_posa_opera_p.addItems(posa_opera_p_us_vl)</span>
        <span class="c1"># # lista posa opera materiali laterizi</span>
        <span class="c1"># self.comboBox_posa_in_opera_usm.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.36&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># posa_opera_usm = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># posa_opera_usm_us_vl = []</span>
        <span class="c1"># for i in range(len(posa_opera_usm)):</span>
            <span class="c1"># if posa_opera_usm[i].sigla_estesa not in posa_opera_usm_us_vl:</span>
                <span class="c1"># posa_opera_usm_us_vl.append(posa_opera_usm[i].sigla_estesa)</span>
        <span class="c1"># posa_opera_usm_us_vl.sort()</span>
        <span class="c1"># self.comboBox_posa_in_opera_usm.addItems(posa_opera_usm_us_vl)</span>
        <span class="c1"># # lista tecniche costruttive</span>
        <span class="c1"># self.comboBox_tecnica_muraria_usm.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.37&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># t_costruttiva = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># t_costruttiva_us_vl = []</span>
        <span class="c1"># for i in range(len(t_costruttiva)):</span>
            <span class="c1"># if t_costruttiva[i].sigla_estesa not in t_costruttiva_us_vl:</span>
                <span class="c1"># t_costruttiva_us_vl.append(t_costruttiva[i].sigla_estesa)</span>
        <span class="c1"># t_costruttiva_us_vl.sort()</span>
        <span class="c1"># self.comboBox_tecnica_muraria_usm.addItems(t_costruttiva_us_vl)</span>
        <span class="c1"># # lista modulo</span>
        <span class="c1"># self.comboBox_modulo_usm.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.38&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># modulo = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># modulo_us_vl = []</span>
        <span class="c1"># for i in range(len(modulo)):</span>
            <span class="c1"># if modulo[i].sigla_estesa not in modulo_us_vl:</span>
                <span class="c1"># modulo_us_vl.append(modulo[i].sigla_estesa)</span>
        <span class="c1"># modulo_us_vl.sort()</span>
        <span class="c1"># self.comboBox_modulo_usm.addItems(modulo_us_vl)</span>
        <span class="c1"># # lista inerti</span>
        <span class="c1"># self.comboBox_inerti_usm.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.39&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># inerti = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># inerti_us_vl = []</span>
        <span class="c1"># for i in range(len(inerti)):</span>
            <span class="c1"># if inerti[i].sigla_estesa not in inerti_us_vl:</span>
                <span class="c1"># inerti_us_vl.append(inerti[i].sigla_estesa)</span>
        <span class="c1"># inerti_us_vl.sort()</span>
        <span class="c1"># self.comboBox_inerti_usm.addItems(inerti_us_vl)</span>
        <span class="c1"># # lista tipologia legante</span>
        <span class="c1"># self.comboBox_tipo_legante_usm.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.40&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># tipo_legante = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># tipo_legante_us_vl = []</span>
        <span class="c1"># for i in range(len(tipo_legante)):</span>
            <span class="c1"># if tipo_legante[i].sigla_estesa not in tipo_legante_us_vl:</span>
                <span class="c1"># tipo_legante_us_vl.append(tipo_legante[i].sigla_estesa)</span>
        <span class="c1"># tipo_legante_us_vl.sort()</span>
        <span class="c1"># self.comboBox_tipo_legante_usm.addItems(tipo_legante_us_vl)</span>
        <span class="c1"># # lista rifinitura</span>
        <span class="c1"># self.comboBox_rifinitura_usm.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.41&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># rifinitura = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># rifinitura_us_vl = []</span>
        <span class="c1"># for i in range(len(rifinitura)):</span>
            <span class="c1"># if rifinitura[i].sigla_estesa not in rifinitura_us_vl:</span>
                <span class="c1"># rifinitura_us_vl.append(rifinitura[i].sigla_estesa)</span>
        <span class="c1"># rifinitura_us_vl.sort()</span>
        <span class="c1"># self.comboBox_rifinitura_usm.addItems(rifinitura_us_vl)</span>
        <span class="c1"># # lista lavorazione litica</span>
        <span class="c1"># self.comboBox_lavorazione_usm.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.42&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># lavorazione_p = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># lavorazione_p_us_vl = []</span>
        <span class="c1"># for i in range(len(lavorazione_p)):</span>
            <span class="c1"># if lavorazione_p[i].sigla_estesa not in lavorazione_p_us_vl:</span>
                <span class="c1"># lavorazione_p_us_vl.append(lavorazione_p[i].sigla_estesa)</span>
        <span class="c1"># lavorazione_p_us_vl.sort()</span>
        <span class="c1"># self.comboBox_lavorazione_usm.addItems(lavorazione_p_us_vl)</span>
    <span class="c1"># def msg_sito(self):</span>
        <span class="c1"># #self.model_a.database().close()</span>
        <span class="c1"># conn = Connection()</span>
        <span class="c1"># sito_set= conn.sito_set()</span>
        <span class="c1"># sito_set_str = sito_set[&#39;sito_set&#39;]</span>
        <span class="c1"># if bool(self.comboBox_sito.currentText()) and self.comboBox_sito.currentText()==sito_set_str:</span>
            
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># QMessageBox.information(self, &quot;OK&quot; ,&quot;Sei connesso al sito: %s&quot; % str(sito_set_str),QMessageBox.Ok) </span>
        
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># QMessageBox.information(self, &quot;OK&quot;, &quot;Sie sind mit der arch√§ologischen St√§tte verbunden: %s&quot; % str(sito_set_str),QMessageBox.Ok) </span>
                
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.information(self, &quot;OK&quot;, &quot;You are connected to the site: %s&quot; % str(sito_set_str),QMessageBox.Ok)     </span>
        
        <span class="c1"># elif sito_set_str==&#39;&#39;:    </span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># msg = QMessageBox.information(self, &quot;Attenzione&quot; ,&quot;Non hai settato alcun sito. Vuoi settarne uno? click Ok altrimenti Annulla per  vedere tutti i record&quot;,QMessageBox.Ok | QMessageBox.Cancel) </span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># msg = QMessageBox.information(self, &quot;Achtung&quot;, &quot;Sie haben keine arch√§ologischen St√§tten eingerichtet. Klicken Sie auf OK oder Abbrechen, um alle Datens√§tze zu sehen&quot;,QMessageBox.Ok | QMessageBox.Cancel) </span>
            <span class="c1"># else:</span>
                <span class="c1"># msg = QMessageBox.information(self, &quot;Warning&quot; , &quot;You have not set up any archaeological site. Do you want to set one? click Ok otherwise Cancel to see all records&quot;,QMessageBox.Ok | QMessageBox.Cancel) </span>
            <span class="c1"># if msg == QMessageBox.Cancel:</span>
                <span class="c1"># pass</span>
            <span class="c1"># else: </span>
                <span class="c1"># dlg = pyArchInitDialog_Config(self)</span>
                <span class="c1"># dlg.charge_list()</span>
                <span class="c1"># dlg.exec_()</span>
    <span class="c1"># def set_sito(self):</span>
        <span class="c1"># #self.model_a.database().close()</span>
        <span class="c1"># conn = Connection()</span>
        <span class="c1"># sito_set= conn.sito_set()</span>
        <span class="c1"># sito_set_str = sito_set[&#39;sito_set&#39;]</span>
        <span class="c1"># try:</span>
            <span class="c1"># if bool (sito_set_str):</span>
                <span class="c1"># search_dict = {</span>
                    <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; + str(sito_set_str) + &quot;&#39;&quot;}  # 1 - Sito</span>
                <span class="c1"># u = Utility()</span>
                <span class="c1"># search_dict = u.remove_empty_items_fr_dict(search_dict)</span>
                <span class="c1"># res = self.DB_MANAGER.query_bool(search_dict, self.MAPPER_TABLE_CLASS)</span>
                <span class="c1"># self.DATA_LIST = []</span>
                <span class="c1"># for i in res:</span>
                    <span class="c1"># self.DATA_LIST.append(i)</span>
                <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
                <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]  ####darivedere</span>
                <span class="c1"># self.fill_fields()</span>
                <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
                <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;False&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># pass#</span>
        <span class="c1"># except Exception as e:</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
            
                <span class="c1"># QMessageBox.information(self, &quot;Attenzione&quot; ,&quot;Non esiste questo sito: &quot;&#39;&quot;&#39;+str(sito_set_str) +&#39;&quot;&#39;&quot; in questa scheda, Per favore distattiva la &#39;scelta sito&#39; dalla scheda di configurazione plugin per vedere tutti i record oppure crea la scheda&quot;,QMessageBox.Ok) </span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
            
                <span class="c1"># QMessageBox.information(self, &quot;Warnung&quot; , &quot;Es gibt keine solche arch√§ologische St√§tte: &quot;&#39;&quot;&quot;&#39;+ str(sito_set_str) +&#39;&quot;&#39;&quot; in dieser Registerkarte, Bitte deaktivieren Sie die &#39;Site-Wahl&#39; in der Plugin-Konfigurationsregisterkarte, um alle Datens√§tze zu sehen oder die Registerkarte zu erstellen&quot;,QMessageBox.Ok) </span>
            <span class="c1"># else:</span>
            
                <span class="c1"># QMessageBox.information(self, &quot;Warning&quot; , &quot;There is no such site: &quot;&#39;&quot;&#39;+ str(sito_set_str) +&#39;&quot;&#39;&quot; in this tab, Please disable the &#39;site choice&#39; from the plugin configuration tab to see all records or create the tab&quot;,QMessageBox.Ok) </span>

    <span class="c1"># def generate_list_foto(self):</span>
        <span class="c1"># data_list_foto = []</span>
        <span class="c1"># for i in range(len(self.DATA_LIST)):</span>
            <span class="c1"># conn = Connection()</span>
            <span class="c1"># thumb_path = conn.thumb_path()</span>
            <span class="c1"># thumb_path_str = thumb_path[&#39;thumb_path&#39;]</span>
            
            <span class="c1"># if thumb_path_str==&#39;&#39;:</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.information(self, &quot;Info&quot;, &quot;devi settare prima la path per salvare le thumbnail . Vai in impostazioni di sistema/ path setting &quot;)</span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.information(self, &quot;Info&quot;, &quot;m√ºssen Sie zuerst den Pfad zum Speichern der Miniaturansichten und Videos festlegen. Gehen Sie zu System-/Pfad-Einstellung&quot;)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># QMessageBox.information(self, &quot;Message&quot;, &quot;you must first set the path to save the thumbnails and videos. Go to system/path setting&quot;)</span>
            <span class="c1"># else:    </span>
                <span class="c1"># search_dict = {&#39;id_entity&#39;: &quot;&#39;&quot;+ str(eval(&quot;self.DATA_LIST[i].id_us&quot;))+&quot;&#39;&quot;, &#39;entity_type&#39; : &quot;&#39;US&#39;&quot;}</span>
                <span class="c1"># record_doc_list = self.DB_MANAGER.query_bool(search_dict, &#39;MEDIAVIEW&#39;)</span>
                <span class="c1"># for media in record_doc_list:</span>
                    <span class="c1"># thumbnail = (thumb_path_str+media.filepath)</span>
                    <span class="c1"># foto= (media.id_media)</span>
                    <span class="c1"># # #sito= (media.sito)</span>
                    <span class="c1"># # area= (media.area)</span>
                    <span class="c1"># # us= (media.us)</span>
                    <span class="c1"># # d_stratigrafica= &#39;&#39;</span>
                    <span class="c1"># # unita_tipo = (media.unita_tipo)</span>
                    <span class="c1"># data_list_foto.append([</span>
                        <span class="c1"># str(self.DATA_LIST[i].sito.replace(&#39;_&#39;,&#39; &#39;)), #0</span>
                        <span class="c1"># str(self.DATA_LIST[i].area), #1</span>
                        <span class="c1"># str(self.DATA_LIST[i].us),    #2</span>
                        <span class="c1"># str(self.DATA_LIST[i].unita_tipo),#3</span>
                        <span class="c1"># str(self.DATA_LIST[i].d_stratigrafica),  #4 </span>
                        <span class="c1"># str(foto),#5</span>
                        <span class="c1"># str(thumbnail)])#6</span>
        <span class="c1"># return data_list_foto</span>
            <span class="c1"># # #####################fine########################</span>
    <span class="c1"># def generate_list_pdf(self):</span>
        <span class="c1"># data_list = []</span>
        <span class="c1"># #############inserimento nome fiel media############</span>
        <span class="c1"># for i in range(len(self.DATA_LIST)):</span>
            <span class="c1"># # assegnazione valori di quota mn e max</span>
            <span class="c1"># id_us = str(self.DATA_LIST[i].id_us)</span>
            <span class="c1"># sito = str(self.DATA_LIST[i].sito)#.replace(&#39;_&#39;,&#39; &#39;))</span>
            <span class="c1"># area = str(self.DATA_LIST[i].area)</span>
            <span class="c1"># us = str(self.DATA_LIST[i].us)</span>
            <span class="c1"># res = self.DB_MANAGER.select_quote_from_db_sql(sito, area, us)</span>
            <span class="c1"># quote = []</span>
            <span class="c1"># for sing_us in res:</span>
                <span class="c1"># sing_quota_value = str(sing_us[5])</span>
                <span class="c1"># if sing_quota_value[0] == &#39;-&#39;:</span>
                    <span class="c1"># sing_quota_value = sing_quota_value[:7]</span>
                <span class="c1"># else:</span>
                    <span class="c1"># sing_quota_value = sing_quota_value[:6]</span>
                <span class="c1"># sing_quota = [sing_quota_value, sing_us[4]]</span>
                <span class="c1"># quote.append(sing_quota)</span>
            <span class="c1"># quote.sort()</span>
            <span class="c1"># #QMessageBox.information(self, &quot;Message&quot;, str(quote))</span>
            <span class="c1"># if bool(quote):</span>
                <span class="c1"># quota_min = &#39;%s %s&#39; % (quote[0][0], quote[0][1])</span>
                <span class="c1"># quota_max = &#39;%s %s&#39; % (quote[-1][0], quote[-1][1])</span>
                
            <span class="c1"># else:</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># quota_min = &quot;&quot;</span>
                    <span class="c1"># quota_max = &quot;&quot;</span>
                <span class="c1"># elif self.L == &#39;de&#39;:</span>
                    <span class="c1"># quota_min = &quot;&quot;</span>
                    <span class="c1"># quota_max = &quot;&quot;</span>
                <span class="c1"># else :</span>
                    <span class="c1"># quota_min = &quot;&quot;</span>
                    <span class="c1"># quota_max = &quot;&quot;</span>
                <span class="c1"># # assegnazione numero di pianta</span>
            <span class="c1"># resus = self.DB_MANAGER.select_us_from_db_sql(sito, area, us, &quot;2&quot;)</span>
            <span class="c1"># elenco_record = []</span>
            <span class="c1"># for us in resus:</span>
                <span class="c1"># elenco_record.append(us)</span>
            <span class="c1"># if bool(elenco_record):</span>
                <span class="c1"># sing_rec = elenco_record[0]</span>
                <span class="c1"># elenco_piante = sing_rec[6]</span>
                <span class="c1"># if elenco_piante != None:</span>
                    <span class="c1"># piante = elenco_piante</span>
                <span class="c1"># else:</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># piante = &quot;US disegnata su base GIS&quot; </span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># piante = &quot;SE im GIS gezeichnet&quot; </span>
                    <span class="c1"># else:</span>
                        <span class="c1"># piante= &quot;SU draft on GIS&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># piante = &quot;US disegnata su base GIS&quot; </span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># piante = &quot;SE im GIS gezeichnet&quot; </span>
                <span class="c1"># else:</span>
                    <span class="c1"># piante= &quot;SU draft on GIS&quot;</span>
            <span class="c1"># if self.DATA_LIST[i].quota_min_usm == None:</span>
                <span class="c1"># quota_min_usm = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_min_usm = str(self.DATA_LIST[i].quota_min_usm)</span>
            <span class="c1"># if self.DATA_LIST[i].quota_max_usm == None:</span>
                <span class="c1"># quota_max_usm = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_max_usm = str(self.DATA_LIST[i].quota_max_usm)</span>
            <span class="c1"># #nuovi campi per Archeo3</span>
            <span class="c1"># if not self.DATA_LIST[i].quota_relativa:</span>
                <span class="c1"># quota_relativa = &quot;&quot;  # 55</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_relativa = str(self.DATA_LIST[i].quota_relativa)</span>
            <span class="c1"># if not self.DATA_LIST[i].quota_abs:</span>
                <span class="c1"># quota_abs = &quot;&quot;  # 56</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_abs = str(self.DATA_LIST[i].quota_abs)</span>
            <span class="c1"># if not self.DATA_LIST[i].lunghezza_max:</span>
                <span class="c1"># lunghezza_max = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># lunghezza_max = str(self.DATA_LIST[i].lunghezza_max)  # 65 lunghezza max</span>
            <span class="c1"># if not self.DATA_LIST[i].altezza_max:</span>
                <span class="c1"># altezza_max = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># altezza_max = str(self.DATA_LIST[i].altezza_max)  # 66 altezza max</span>
            <span class="c1"># if not self.DATA_LIST[i].altezza_min:</span>
                <span class="c1"># altezza_min = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># altezza_min = str(self.DATA_LIST[i].altezza_min)  # 67 altezza min</span>
            <span class="c1"># if not self.DATA_LIST[i].profondita_max:</span>
                <span class="c1"># profondita_max = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># profondita_max = str(self.DATA_LIST[i].profondita_max)  # 68 profondita_max</span>
            <span class="c1"># if not self.DATA_LIST[i].profondita_min:</span>
                <span class="c1"># profondita_min = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># profondita_min = str(self.DATA_LIST[i].profondita_min)  # 69 profondita min</span>
            <span class="c1"># if not self.DATA_LIST[i].larghezza_media:</span>
                <span class="c1"># larghezza_media = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># larghezza_media = str(self.DATA_LIST[i].larghezza_media)  # 70 larghezza media</span>
            <span class="c1"># if not self.DATA_LIST[i].quota_max_abs:</span>
                <span class="c1"># quota_max_abs = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_max_abs = str(self.DATA_LIST[i].quota_max_abs)  # 71 quota_max_abs</span>
            <span class="c1"># if not self.DATA_LIST[i].quota_max_rel:</span>
                <span class="c1"># quota_max_rel = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_max_rel = str(self.DATA_LIST[i].quota_max_rel)  # 72 quota_max_rel</span>
            <span class="c1"># if not self.DATA_LIST[i].quota_min_abs:</span>
                <span class="c1"># quota_min_abs = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_min_abs = str(self.DATA_LIST[i].quota_min_abs)  # 73 quota_min_abs</span>
            <span class="c1"># if not self.DATA_LIST[i].quota_min_rel:</span>
                <span class="c1"># quota_min_rel = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_min_rel = str(self.DATA_LIST[i].quota_min_rel)  # 74 quota_min_rel</span>
            <span class="c1"># if not self.DATA_LIST[i].lunghezza_usm:</span>
                <span class="c1"># lunghezza_usm = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># lunghezza_usm = str(self.DATA_LIST[i].lunghezza_usm)  # 85 lunghezza usm</span>
            <span class="c1"># if not self.DATA_LIST[i].altezza_usm:</span>
                <span class="c1"># altezza_usm = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># altezza_usm = str(self.DATA_LIST[i].altezza_usm)  # 86 altezza usm</span>
            <span class="c1"># if not self.DATA_LIST[i].spessore_usm:</span>
                <span class="c1"># spessore_usm = &quot;&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># spessore_usm = str(self.DATA_LIST[i].spessore_usm)  # 87 spessore usm</span>
            <span class="c1"># data_list.append([</span>
                <span class="c1"># str(self.DATA_LIST[i].sito.replace(&#39;_&#39;,&#39; &#39;)),  # 0 - Sito</span>
                <span class="c1"># str(self.DATA_LIST[i].area),  # 1 - Area</span>
                <span class="c1"># int(self.DATA_LIST[i].us),  # 2 - US</span>
                <span class="c1"># str(self.DATA_LIST[i].d_stratigrafica),  # 3 - definizione stratigrafica</span>
                <span class="c1"># str(self.DATA_LIST[i].d_interpretativa),  # 4 - definizione intepretata</span>
                <span class="c1"># str(self.DATA_LIST[i].descrizione),  # 5 - descrizione</span>
                <span class="c1"># str(self.DATA_LIST[i].interpretazione),  # 6 - interpretazione</span>
                <span class="c1"># str(self.DATA_LIST[i].periodo_iniziale),  # 7 - periodo iniziale</span>
                <span class="c1"># str(self.DATA_LIST[i].fase_iniziale),  # 8 - fase iniziale</span>
                <span class="c1"># str(self.DATA_LIST[i].periodo_finale),  # 9 - periodo finale iniziale</span>
                <span class="c1"># str(self.DATA_LIST[i].fase_finale),  # 10 - fase finale</span>
                <span class="c1"># str(self.DATA_LIST[i].scavato),  # 11 - scavato</span>
                <span class="c1"># str(self.DATA_LIST[i].attivita),  # 12 - attivita</span>
                <span class="c1"># str(self.DATA_LIST[i].anno_scavo),  # 13 - anno scavo</span>
                <span class="c1"># str(self.DATA_LIST[i].metodo_di_scavo),  # 14 - metodo</span>
                <span class="c1"># str(self.DATA_LIST[i].inclusi),  # 15 - inclusi</span>
                <span class="c1"># str(self.DATA_LIST[i].campioni),  # 16 - campioni</span>
                <span class="c1"># str(self.DATA_LIST[i].rapporti),            # 17 - rapporti</span>
                <span class="c1"># #str(self.DATA_LIST[i].organici),  # organici</span>
                <span class="c1"># #str(self.DATA_LIST[i].inorganici),  # inorganici</span>
                <span class="c1"># str(self.DATA_LIST[i].data_schedatura),  # 18 - data schedatura</span>
                <span class="c1"># str(self.DATA_LIST[i].schedatore),  # 19 - schedatore</span>
                <span class="c1"># str(self.DATA_LIST[i].formazione),  # 20 - formazione</span>
                <span class="c1"># str(self.DATA_LIST[i].stato_di_conservazione),  # 21 - conservazione</span>
                <span class="c1"># str(self.DATA_LIST[i].colore),  # 22 - colore</span>
                <span class="c1"># str(self.DATA_LIST[i].consistenza),  # 23 - consistenza</span>
                <span class="c1"># str(self.DATA_LIST[i].struttura),  # 24 - struttura</span>
                <span class="c1"># str(quota_min),  # 25 - quota_min</span>
                <span class="c1"># str(quota_max),  # 26 - quota_max</span>
                <span class="c1"># str(piante),  # 27 - piante CAMPO RICAVATO DA GIS CON VALORI SI/NO</span>
                <span class="c1"># str(self.DATA_LIST[i].documentazione),  # 28 - documentazione</span>
                <span class="c1"># #campi USM</span>
                <span class="c1"># str(self.DATA_LIST[i].unita_tipo),  # 29 - unita tipo</span>
                <span class="c1"># str(self.DATA_LIST[i].settore),  # 30 - settore</span>
                <span class="c1"># str(self.DATA_LIST[i].quad_par),  # 31 quadrato</span>
                <span class="c1"># str(self.DATA_LIST[i].ambient),  # 32 ambiente</span>
                <span class="c1"># str(self.DATA_LIST[i].saggio),  # 33 saggio</span>
                <span class="c1"># str(self.DATA_LIST[i].elem_datanti),  # 34 - elem_datanti</span>
                <span class="c1"># str(self.DATA_LIST[i].funz_statica),  # 35 - funz_statica</span>
                <span class="c1"># str(self.DATA_LIST[i].lavorazione),  # 36 lavorazione</span>
                <span class="c1"># str(self.DATA_LIST[i].spess_giunti),  # 37 spess_giunti</span>
                <span class="c1"># str(self.DATA_LIST[i].letti_posa),            #38 letti posa</span>
                <span class="c1"># str(self.DATA_LIST[i].alt_mod),               #39  al modulo</span>
                <span class="c1"># str(self.DATA_LIST[i].un_ed_riass),           #40 unita edilizia riassuntiva</span>
                <span class="c1"># str(self.DATA_LIST[i].reimp),                 #41 reimpiego</span>
                <span class="c1"># str(self.DATA_LIST[i].posa_opera),            #42 posa opera</span>
                <span class="c1"># str(quota_min_usm),                           #43 quota min usm</span>
                <span class="c1"># str(quota_max_usm),                           #44 quota max usm</span>
                <span class="c1"># str(self.DATA_LIST[i].cons_legante),          #45 cons legante</span>
                <span class="c1"># str(self.DATA_LIST[i].col_legante),           #46 col legante</span>
                <span class="c1"># str(self.DATA_LIST[i].aggreg_legante),        #47 aggreg legante</span>
                <span class="c1"># str(self.DATA_LIST[i].con_text_mat),          #48  con text mat</span>
                <span class="c1"># str(self.DATA_LIST[i].col_materiale),         #49  col materiale</span>
                <span class="c1"># str(self.DATA_LIST[i].inclusi_materiali_usm),  #50 inclusi materili usm</span>
                <span class="c1"># #NUOVI CAMPI PER ARCHEO3</span>
                <span class="c1"># str(self.DATA_LIST[i].n_catalogo_generale),  # 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
                <span class="c1"># str(self.DATA_LIST[i].n_catalogo_interno),  # 52 nr catalogo interno</span>
                <span class="c1"># str(self.DATA_LIST[i].n_catalogo_internazionale),  # 53 nr catalogo internazionale</span>
                <span class="c1"># str(self.DATA_LIST[i].soprintendenza),  # 54 nr soprintendenza</span>
                <span class="c1"># str(quota_relativa), #55 quota relativa</span>
                <span class="c1"># str(quota_abs),   #56 quota assoluta</span>
                <span class="c1"># str(self.DATA_LIST[i].ref_tm),  # 57 ref tm</span>
                <span class="c1"># str(self.DATA_LIST[i].ref_ra),  # 58 ref ra</span>
                <span class="c1"># str(self.DATA_LIST[i].ref_n),  # 59 ref n</span>
                <span class="c1"># str(self.DATA_LIST[i].posizione),  # 60 posizione</span>
                <span class="c1"># str(self.DATA_LIST[i].criteri_distinzione),  #61 criteri distinzione</span>
                <span class="c1"># str(self.DATA_LIST[i].modo_formazione),  # 62 modo formazione</span>
                <span class="c1"># str(self.DATA_LIST[i].componenti_organici),  # 63 componenti organici</span>
                <span class="c1"># str(self.DATA_LIST[i].componenti_inorganici),  # 64 #  componenti inorganici</span>
                <span class="c1"># str(lunghezza_max), #65 lunghezza max</span>
                <span class="c1"># str(altezza_max), #66 altezza max</span>
                <span class="c1"># str(altezza_min),  #67 altezza min</span>
                <span class="c1"># str(profondita_max),  #68 profondita max</span>
                <span class="c1"># str(profondita_min),  #69 profondita min</span>
                <span class="c1"># str(larghezza_media),  #70 larghezza media</span>
                <span class="c1"># str(quota_max_abs),   #71 quota max assoluta</span>
                <span class="c1"># str(quota_max_rel),   #72 quota max rel</span>
                <span class="c1"># str(quota_min_abs),   #73 quota min assoluta</span>
                <span class="c1"># str(quota_min_rel),   #74 quota min relativa</span>
                <span class="c1"># str(self.DATA_LIST[i].osservazioni),  # 75 osservazioni</span>
                <span class="c1"># str(self.DATA_LIST[i].datazione), # 76 datazione</span>
                <span class="c1"># str(self.DATA_LIST[i].flottazione),  # 77 flottazione</span>
                <span class="c1"># str(self.DATA_LIST[i].setacciatura),  # 78 setacciatura</span>
                <span class="c1"># str(self.DATA_LIST[i].affidabilita),  # 79 affidabilita</span>
                <span class="c1"># str(self.DATA_LIST[i].direttore_us),  # 80 direttore us</span>
                <span class="c1"># str(self.DATA_LIST[i].responsabile_us),  # 81 responsabile us</span>
                <span class="c1"># str(self.DATA_LIST[i].cod_ente_schedatore),  # 82 cod ente schedatore</span>
                <span class="c1"># str(self.DATA_LIST[i].data_rilevazione),  # 83 data rilevazione</span>
                <span class="c1"># str(self.DATA_LIST[i].data_rielaborazione),  # 84 data rielaborazione</span>
                <span class="c1"># str(lunghezza_usm), #85 lunghezza usm</span>
                <span class="c1"># str(altezza_usm),  #86 altezza usm</span>
                <span class="c1"># str(spessore_usm),  #87 spessore usm</span>
                <span class="c1"># str(self.DATA_LIST[i].tecnica_muraria_usm),  # 88 tecnica muraria usm</span>
                <span class="c1"># str(self.DATA_LIST[i].modulo_usm),  # 89 modulo usm</span>
                <span class="c1"># str(self.DATA_LIST[i].campioni_malta_usm),  # 90 campioni malta usm</span>
                <span class="c1"># str(self.DATA_LIST[i].campioni_mattone_usm),  # 91 campioni mattone usm</span>
                <span class="c1"># str(self.DATA_LIST[i].campioni_pietra_usm),  # 92 campioni pietra usm</span>
                <span class="c1"># str(self.DATA_LIST[i].provenienza_materiali_usm),  # 93 provenienza_materiali_usm</span>
                <span class="c1"># str(self.DATA_LIST[i].criteri_distinzione_usm),  # 94 criteri distinzione usm</span>
                <span class="c1"># str(self.DATA_LIST[i].uso_primario_usm),  #95 uso primario</span>
                <span class="c1"># str(self.DATA_LIST[i].tipologia_opera),</span>
                <span class="c1"># str(self.DATA_LIST[i].sezione_muraria),</span>
                <span class="c1"># str(self.DATA_LIST[i].superficie_analizzata),</span>
                <span class="c1"># str(self.DATA_LIST[i].orientamento),</span>
                <span class="c1"># str(self.DATA_LIST[i].materiali_lat),</span>
                <span class="c1"># str(self.DATA_LIST[i].lavorazione_lat),</span>
                <span class="c1"># str(self.DATA_LIST[i].consistenza_lat),</span>
                <span class="c1"># str(self.DATA_LIST[i].forma_lat),</span>
                <span class="c1"># str(self.DATA_LIST[i].colore_lat),</span>
                <span class="c1"># str(self.DATA_LIST[i].impasto_lat),</span>
                <span class="c1"># str(self.DATA_LIST[i].forma_p),</span>
                <span class="c1"># str(self.DATA_LIST[i].colore_p),</span>
                <span class="c1"># str(self.DATA_LIST[i].taglio_p),</span>
                <span class="c1"># str(self.DATA_LIST[i].posa_opera_p),</span>
                <span class="c1"># str(self.DATA_LIST[i].inerti_usm),</span>
                <span class="c1"># str(self.DATA_LIST[i].tipo_legante_usm),</span>
                <span class="c1"># str(self.DATA_LIST[i].rifinitura_usm),</span>
                <span class="c1"># str(self.DATA_LIST[i].materiale_p),</span>
                <span class="c1"># str(self.DATA_LIST[i].consistenza_p),</span>
            <span class="c1"># ])</span>
        <span class="c1"># return data_list</span>
    <span class="c1"># def on_pushButton_exp_tavole_pressed(self):</span>
        <span class="c1"># conn = Connection()</span>
        <span class="c1"># conn_str = conn.conn_str()</span>
        <span class="c1"># # QMessageBox.warning(self, &quot;Messaggio&quot;, str(conn_str), QMessageBox.Ok)</span>
        <span class="c1"># PU = Print_utility(self.iface, self.DATA_LIST)</span>
        <span class="c1"># PU.progressBarUpdated.connect(self.updateProgressBar)</span>
        <span class="c1"># if conn_str.find(&quot;postgresql&quot;) == 0:</span>
            <span class="c1"># PU.first_batch_try(&quot;postgres&quot;)</span>
        <span class="c1"># else:</span>
            <span class="c1"># PU.first_batch_try(&quot;sqlite&quot;)</span>
    <span class="c1"># @pyqtSlot(int, int)</span>
    <span class="c1"># def updateProgressBar(self, tav, tot):</span>
        <span class="c1"># value = (float(tav) / float(tot)) * 100</span>
        <span class="c1"># self.progressBar.setValue(value)</span>
        <span class="c1"># # text = &#39; di &#39;.join([str(tav), str(tot)])</span>
        <span class="c1"># # self.countLabel.setText(text)</span>
    <span class="c1"># def on_pushButton_print_pressed(self):</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># if self.checkBox_s_us.isChecked():</span>
                <span class="c1"># US_pdf_sheet = generate_US_pdf()</span>
                <span class="c1"># data_list = self.generate_list_pdf()</span>
                <span class="c1"># US_pdf_sheet.build_US_sheets(data_list)</span>
                <span class="c1"># QMessageBox.warning(self, &#39;Ok&#39;,&quot;Esportazione terminata Schede US&quot;,QMessageBox.Ok)</span>
            <span class="c1"># else:   </span>
                <span class="c1"># pass</span>
            <span class="c1"># if self.checkBox_e_us.isChecked() :</span>
                <span class="c1"># US_index_pdf = generate_US_pdf()</span>
                <span class="c1"># data_list = self.generate_list_pdf()</span>
                <span class="c1"># try:               </span>
                    <span class="c1"># if bool(data_list):</span>
                        <span class="c1"># US_index_pdf.build_index_US(data_list, data_list[0][0])</span>
                        <span class="c1"># QMessageBox.warning(self, &#39;Ok&#39;,&quot;Esportazione terminata Elenco US&quot;,QMessageBox.Ok)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># QMessageBox.warning(self, &#39;ATTENZIONE&#39;,&quot;L&#39;elenco US non pu√≤ essere esportato devi riempire prima le schede US&quot;,QMessageBox.Ok)</span>
                <span class="c1"># except Exception as e :</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;ATTENZIONE&#39;,str(e),QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># pass</span>
            <span class="c1"># if self.checkBox_e_foto_t.isChecked():</span>
                <span class="c1"># US_index_pdf = generate_US_pdf()</span>
                <span class="c1"># data_list_foto = self.generate_list_foto()</span>
                <span class="c1"># try:</span>
                        <span class="c1"># if bool(data_list_foto):</span>
                            <span class="c1"># US_index_pdf.build_index_Foto(data_list_foto, data_list_foto[0][0])</span>
                            <span class="c1"># QMessageBox.warning(self, &#39;Ok&#39;,&quot;Esportazione terminata Elenco Foto&quot;,QMessageBox.Ok)</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># QMessageBox.warning(self, &#39;ATTENZIONE&#39;,&quot;L&#39;elenco foto non pu√≤ essere esportato perch√® non hai immagini taggate.&quot;,QMessageBox.Ok)</span>
                <span class="c1"># except Exception as e :</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;ATTENZIONE&#39;,str(e),QMessageBox.Ok)</span>
            <span class="c1"># if self.checkBox_e_foto.isChecked():</span>
                <span class="c1"># US_index_pdf = generate_US_pdf()</span>
                <span class="c1"># data_list_foto = self.generate_list_foto()</span>
                <span class="c1"># try:</span>
                        <span class="c1"># if bool(data_list_foto):</span>
                            <span class="c1"># US_index_pdf.build_index_Foto_2(data_list_foto, data_list_foto[0][0])</span>
                            <span class="c1"># QMessageBox.warning(self, &#39;Ok&#39;,&quot;Esportazione terminata Elenco Foto senza thumbanil&quot;,QMessageBox.Ok)</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># QMessageBox.warning(self, &#39;ATTENZIONE&#39;,&quot;L&#39;elenco foto non pu√≤ essere esportato perch√® non hai immagini taggate.&quot;,QMessageBox.Ok)</span>
                <span class="c1"># except Exception as e :</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;ATTENZIONE&#39;,str(e),QMessageBox.Ok)</span>
        <span class="c1"># elif self.L==&#39;en&#39;:  </span>
            <span class="c1"># if self.checkBox_s_us.isChecked():</span>
                <span class="c1"># US_pdf_sheet = generate_US_pdf()</span>
                <span class="c1"># data_list = self.generate_list_pdf()</span>
                <span class="c1"># US_pdf_sheet.build_US_sheets_en(data_list)</span>
                <span class="c1"># QMessageBox.warning(self, &#39;Ok&#39;,&quot;Export finished SU Forms&quot;,QMessageBox.Ok)</span>
            <span class="c1"># else:   </span>
                <span class="c1"># pass</span>
            <span class="c1"># if self.checkBox_e_us.isChecked() :</span>
                <span class="c1"># US_index_pdf = generate_US_pdf()</span>
                <span class="c1"># data_list = self.generate_list_pdf()</span>
                <span class="c1"># try:               </span>
                    <span class="c1"># if bool(data_list):</span>
                        <span class="c1"># US_index_pdf.build_index_US_en(data_list, data_list[0][0])</span>
                        <span class="c1"># QMessageBox.warning(self, &#39;Ok&#39;,&quot;Export finished SU List&quot;,QMessageBox.Ok)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># QMessageBox.warning(self, &#39;WARNING&#39;,&quot;The SU list cannot be exported you have to fill in the SU tabs before&quot;,QMessageBox.Ok)</span>
                <span class="c1"># except Exception as e :</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;WARNING&#39;,str(e),QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># pass</span>
            <span class="c1"># if self.checkBox_e_foto_t.isChecked():</span>
                <span class="c1"># US_index_pdf = generate_US_pdf()</span>
                <span class="c1"># data_list_foto = self.generate_list_foto()</span>
                <span class="c1"># #QMessageBox.information(self, &#39;Ok&#39;,str(data_list_foto[0][0]),QMessageBox.Ok)</span>
                <span class="c1"># try:</span>
                    <span class="c1"># if bool(data_list_foto):</span>
                        <span class="c1"># US_index_pdf.build_index_Foto_en(data_list_foto, data_list_foto[0][0])</span>
                        <span class="c1"># QMessageBox.information(self, &#39;Ok&#39;,&quot;Export finished SU List&quot;,QMessageBox.Ok)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># QMessageBox.warning(self, &#39;WARNING&#39;, &#39;The photo list cannot be exported because you do not have tagged images.&#39;,QMessageBox.Ok)</span>
                <span class="c1"># except Exception as e :</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;WARNING&#39;,str(e),QMessageBox.Ok)</span>
            
            <span class="c1"># if self.checkBox_e_foto.isChecked():</span>
                <span class="c1"># US_index_pdf = generate_US_pdf()</span>
                <span class="c1"># data_list_foto = self.generate_list_foto()</span>
                <span class="c1"># try:</span>
                        <span class="c1"># if bool(data_list_foto):</span>
                            <span class="c1"># US_index_pdf.build_index_Foto_2_en(data_list_foto, data_list_foto[0][0])</span>
                            <span class="c1"># QMessageBox.information(self, &#39;Ok&#39;, &quot;Export finished Photo List without thumbanil&quot;,QMessageBox.Ok)</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># QMessageBox.warning(self, &#39;WARNING&#39;, &quot;The photo list cannot be exported because you do not have tagged images.&quot;,QMessageBox.Ok)</span>
                <span class="c1"># except Exception as e :</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;WARNING&#39;,str(e),QMessageBox.Ok)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># if self.checkBox_s_us.isChecked():</span>
                <span class="c1"># US_pdf_sheet = generate_US_pdf()</span>
                <span class="c1"># data_list = self.generate_list_pdf()</span>
                <span class="c1"># US_pdf_sheet.build_US_sheets_de(data_list)</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Okay&quot;, &quot;Export beendet&quot;,QMessageBox.Ok)</span>
            <span class="c1"># else:   </span>
                <span class="c1"># pass</span>
            <span class="c1"># if self.checkBox_e_us.isChecked() :</span>
                <span class="c1"># US_index_pdf = generate_US_pdf()</span>
                <span class="c1"># data_list = self.generate_list_pdf()</span>
                <span class="c1"># try:               </span>
                    <span class="c1"># if bool(data_list):</span>
                        <span class="c1"># US_index_pdf.build_index_US_de(data_list, data_list[0][0])</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;Okay&quot;, &quot;Export beendet&quot;,QMessageBox.Ok)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># QMessageBox.warning(self, &#39;WARNUNG&#39;, &#39;Die SE-Liste kann nicht exportiert werden, Sie m√ºssen zuerst die SE-Formulare ausf√ºllen&#39;,QMessageBox.Ok)</span>
                <span class="c1"># except Exception as e :</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;WARNUNG&#39;,str(e),QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># pass</span>
            <span class="c1"># if self.checkBox_e_foto_t.isChecked():</span>
                <span class="c1"># US_index_pdf = generate_US_pdf()</span>
                <span class="c1"># data_list_foto = self.generate_list_foto()</span>
                <span class="c1"># try:</span>
                        <span class="c1"># if bool(data_list_foto):</span>
                            <span class="c1"># US_index_pdf.build_index_Foto_de(data_list_foto, data_list_foto[0][0])</span>
                            <span class="c1"># QMessageBox.warning(self, &quot;Okay&quot;, &quot;Fertige Fotoliste exportieren&quot;,QMessageBox.Ok)</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># QMessageBox.warning(self, &#39;WARNUNG&#39;, &#39;Die Fotoliste kann nicht exportiert werden, da Sie keine markierten Bilder haben.&#39;,QMessageBox.Ok)</span>
                <span class="c1"># except Exception as e :</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;WARNUNG&#39;,str(e),QMessageBox.Ok)</span>
            <span class="c1"># if self.checkBox_e_foto.isChecked():</span>
                <span class="c1"># US_index_pdf = generate_US_pdf()</span>
                <span class="c1"># data_list_foto = self.generate_list_foto()</span>
                <span class="c1"># try:</span>
                        <span class="c1"># if bool(data_list_foto):</span>
                            <span class="c1"># US_index_pdf.build_index_Foto_2_de(data_list_foto, data_list_foto[0][0])</span>
                            <span class="c1"># QMessageBox.warning(self, &#39;Ok&#39;, &#39;Fertige Fotoliste ohne Daumenballen exportieren&#39;,QMessageBox.Ok)</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># QMessageBox.warning(self, &#39;WARNUNG&#39;, &#39;Die Fotoliste kann nicht exportiert werden, da Sie keine markierten Bilder haben.&#39;,QMessageBox.Ok)</span>
                <span class="c1"># except Exception as e :</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;WARNUNG&#39;,str(e),QMessageBox.Ok)</span>
    <span class="c1"># def setPathpdf(self):</span>
        <span class="c1"># s = QgsSettings()</span>
        <span class="c1"># dbpath = QFileDialog.getOpenFileName(</span>
            <span class="c1"># self,</span>
            <span class="c1"># &quot;Set file name&quot;,</span>
            <span class="c1"># self.PDFFOLDER,</span>
            <span class="c1"># &quot; PDF (*.pdf)&quot;</span>
        <span class="c1"># )[0]</span>
        <span class="c1"># #filename=dbpath.split(&quot;/&quot;)[-1]</span>
        <span class="c1"># if dbpath:</span>
            <span class="c1"># self.lineEdit_pdf_path.setText(dbpath)</span>
            <span class="c1"># s.setValue(&#39;&#39;,dbpath)</span>
    <span class="c1"># # def on_pushButton_convert_pressed(self):</span>
    <span class="c1"># #     # if not bool(self.setPathpdf()):</span>
    <span class="c1"># #         # QMessageBox.warning(self, &quot;INFO&quot;, &quot;devi scegliere un file pdf&quot;,</span>
    <span class="c1"># #                             # QMessageBox.Ok)</span>
    <span class="c1"># #     try:</span>
    <span class="c1"># #         pdf_file = self.lineEdit_pdf_path.text()</span>
    <span class="c1"># #         filename=pdf_file.split(&quot;/&quot;)[-1]</span>
    <span class="c1"># #         docx_file = self.PDFFOLDER+&#39;/&#39;+filename+&#39;.docx&#39;</span>
    <span class="c1"># #         # convert pdf to docx</span>
    <span class="c1"># #         parse(pdf_file, docx_file, start=self.lineEdit_pag1.text(), end=self.lineEdit_pag2.text())</span>
    <span class="c1"># #</span>
    <span class="c1"># #         QMessageBox.information(self, &quot;INFO&quot;, &quot;Conversion completed&quot;,</span>
    <span class="c1"># #                             QMessageBox.Ok)</span>
    <span class="c1"># #     except Exception as e:</span>
    <span class="c1"># #         QMessageBox.warning(self, &quot;Error&quot;, str(e),</span>
    <span class="c1"># #                             QMessageBox.Ok)</span>
    
    <span class="c1"># def setPathdot(self):</span>
        <span class="c1"># s = QgsSettings()</span>
        <span class="c1"># dbpath = QFileDialog.getOpenFileName(</span>
            <span class="c1"># self,</span>
            <span class="c1"># &quot;Set file name&quot;,</span>
            <span class="c1"># self.MATRIX_PATH,</span>
            <span class="c1"># &quot; Dot (*.dot)&quot;</span>
        <span class="c1"># )[0]</span>
        <span class="c1"># #filename=dbpath.split(&quot;/&quot;)[-1]</span>
        <span class="c1"># if dbpath:</span>
            <span class="c1"># self.lineEdit_input.setText(dbpath)</span>
            <span class="c1"># s.setValue(&#39;&#39;,dbpath)</span>
    
    <span class="c1"># def setPathgraphml(self):</span>
        <span class="c1"># s = QgsSettings()</span>
        <span class="c1"># dbpath = QFileDialog.getSaveFileName(</span>
            <span class="c1"># self,</span>
            <span class="c1"># &quot;Set file name&quot;,</span>
            <span class="c1"># self.MATRIX_PATH,</span>
            <span class="c1"># &quot; Graphml (*.graphml)&quot;</span>
        <span class="c1"># )[0]</span>
        <span class="c1"># #filename=dbpath.split(&quot;/&quot;)[-1]</span>
        <span class="c1"># if dbpath:</span>
            <span class="c1"># self.lineEdit_output.setText(dbpath)</span>
            <span class="c1"># s.setValue(&#39;&#39;,dbpath)</span>
    
    <span class="c1"># def setDoc_ref(self):</span>
        <span class="c1"># s = QgsSettings()</span>
        <span class="c1"># dbpath = QFileDialog.getSaveFileName(</span>
            <span class="c1"># self,</span>
            <span class="c1"># &quot;Set file name&quot;,</span>
            <span class="c1"># self.MATRIX_PATH,</span>
            <span class="c1"># &quot; All files (*.*)&quot;</span>
        <span class="c1"># )[0]</span>
        <span class="c1"># filename=dbpath.split(&quot;/&quot;)[-1]</span>
        <span class="c1"># if dbpath:</span>
            <span class="c1"># self.mQgsFileWidget.setText(&#39;DosCo\\&#39;+filename)</span>
            <span class="c1"># s.setValue(&#39;&#39;,dbpath)</span>
    <span class="c1"># def list2pipe(self,x):</span>
        <span class="c1"># lista =[]</span>
        <span class="c1"># if isinstance(x,str) and x.startswith(&#39;[&#39;) and &#39;], [&#39;  and &#39;, &#39; in x:</span>
            
            <span class="c1"># return &#39;, &#39;.join(str(e) for e in eval(x)).replace(&quot;]&quot;,&#39;&#39;).replace(&quot;[&#39;Copre&#39;,&quot;,&#39;&#39;).replace(&quot;[&#39;Coperto da&#39;,&quot;,&#39;&#39;).replace(&quot;[&#39;Riempie&#39;,&quot;,&#39;&#39;).replace(&quot;[&#39;Riempito da&#39;,&quot;,&#39;&#39;).replace(&quot;[&#39;Taglia&#39;,&quot;,&#39;&#39;).replace(&quot;[&#39;Tagliato da&#39;,&quot;,&#39;&#39;).replace(&quot;[&#39;Si appoggia a&#39;,&quot;,&#39;&#39;).replace(&quot;[&#39;Gli si appoggia&#39;,&quot;,&#39;&#39;).replace(&quot;[&#39;Si lega a&#39;,&quot;,&#39;&#39;).replace(&quot;[&#39;Uguale a&#39;,&quot;,&#39;&#39;).replace(&quot;&#39;&quot;,&#39;&#39;).replace(&quot;Copre,&quot;,&#39;&#39;).replace(&quot;Coperto da,&quot;,&#39;&#39;).replace(&quot;Riempie,&quot;,&#39;&#39;).replace(&quot;Riempito da,&quot;,&#39;&#39;).replace(&quot;Taglia,&quot;,&#39;&#39;).replace(&quot;Tagliato da,&quot;,&#39;&#39;).replace(&quot;Si appoggia a,&quot;,&#39;&#39;).replace(&quot;Gli si appoggia,&quot;,&#39;&#39;).replace(&quot;Si lega a,&quot;,&#39;&#39;).replace(&quot;Uguale a,&quot;,&#39;&#39;)</span>
        
        
        <span class="c1"># elif isinstance(x,str) and x.startswith(&#39;[&#39;):    </span>
            <span class="c1"># return &#39;, &#39;.join(str(e) for e in eval(x)[0])</span>
        <span class="c1"># else: </span>
            <span class="c1"># return x</span>
    <span class="c1"># def on_pushButton_graphml_pressed(self):</span>
        <span class="c1"># # if not bool(self.setPathpdf()):    </span>
            <span class="c1"># # QMessageBox.warning(self, &quot;INFO&quot;, &quot;devi scegliere un file pdf&quot;,</span>
                                <span class="c1"># # QMessageBox.Ok)</span>
        
        <span class="c1"># dottoxml=&#39;{}{}{}&#39;.format(self.BIN, os.sep, &#39;dottoxml.py&#39;)</span>
        <span class="c1"># try:</span>
            <span class="c1"># input_file = self.lineEdit_input.text()</span>
            <span class="c1"># output_file = self.lineEdit_output.text()</span>
            
            <span class="c1"># python_path = sys.exec_prefix</span>
            <span class="c1"># python_version = sys.version[:3]</span>

            <span class="c1"># if platform.system()==&#39;Windows&#39;:</span>
                <span class="c1"># cmd = &#39;{}\python&#39;.format(python_path)</span>
            <span class="c1"># elif platform.system()==&#39;Darwin&#39;:</span>
                <span class="c1"># cmd = &#39;{}/bin/python{}&#39;.format(python_path, python_version)</span>
            <span class="c1"># else:</span>
                <span class="c1"># cmd = &#39;{}/bin/python{}&#39;.format(python_path, python_version)</span>
            <span class="c1"># subprocess.call([&#39;python&#39;, dottoxml,&#39;-f&#39;, &#39;Graphml&#39;,input_file, output_file], shell=True)</span>
            
            <span class="c1"># with open(output_file, &#39;r&#39;) as file :</span>
                <span class="c1"># filedata = file.read()</span>
            
                <span class="c1"># # Replace the target string</span>
                <span class="c1"># filedata = filedata.replace(&quot;b&#39;&quot;, &#39;&#39;)</span>
                <span class="c1"># filedata = filedata.replace(&quot;graphml&gt;&#39;&quot;, &#39;graphml&gt;&#39;)</span>
                <span class="c1"># # Write the file out again</span>
                
            
            <span class="c1"># with open(output_file, &#39;w&#39;) as file:</span>
              
                <span class="c1"># file.write(filedata)</span>
                
           
            <span class="c1"># sito_location = str(self.comboBox_sito.currentText())</span>
            <span class="c1"># cfg_rel_path = os.path.join(os.sep, &#39;pyarchinit_DB_folder&#39;, &#39;config.cfg&#39;)</span>
            <span class="c1"># file_path = &#39;{}{}&#39;.format(self.HOME, cfg_rel_path)</span>
            <span class="c1"># conf = open(file_path, &quot;r&quot;)</span>
            <span class="c1"># data = conf.read()</span>
            <span class="c1"># settings = Settings(data)</span>
            <span class="c1"># settings.set_configuration()</span>
            <span class="c1"># conf.close()    </span>
            
            <span class="c1"># db_username = settings.USER</span>
            <span class="c1"># host = settings.HOST</span>
            <span class="c1"># port = settings.PORT</span>
            <span class="c1"># database_password=settings.PASSWORD</span>
            <span class="c1"># db_names = settings.DATABASE</span>
            <span class="c1"># server=settings.SERVER    </span>
            
            <span class="c1"># if server==&#39;postgres&#39;:</span>
                <span class="c1"># connessione =&quot;dbname=%s user=%s host=%s password=%s port=%s&quot; % (db_names,db_username,host,database_password,port)</span>
                
                
                <span class="c1"># conn = psycopg2.connect(connessione)</span>
                <span class="c1"># cur = conn.cursor()</span>
                <span class="c1"># # WITH RECURSIVE cte AS (</span>
                  <span class="c1"># # SELECT id,</span>
                         <span class="c1"># # SUBSTR(test, 1, STRPOS(test || &#39;;&#39;, &#39;;&#39;) - 1) col,</span>
                         <span class="c1"># # SUBSTR(test, STRPOS(test || &#39;;&#39;, &#39;;&#39;) + 1) rest</span>
                  <span class="c1"># # FROM (SELECT id, REPLACE(REPLACE(REPLACE(test, &#39;[[&#39;, &#39;[&#39;), &#39;]]&#39;, &#39;]&#39;), &#39;],[&#39;, &#39;];[&#39;) test FROM tablename) t</span>
                  <span class="c1"># # UNION ALL</span>
                  <span class="c1"># # SELECT id,</span>
                         <span class="c1"># # SUBSTR(rest, 1, STRPOS(rest || &#39;;&#39;, &#39;;&#39;) - 1),</span>
                         <span class="c1"># # SUBSTR(rest, STRPOS(rest || &#39;;&#39;, &#39;;&#39;) + 1)</span>
                  <span class="c1"># # FROM cte</span>
                  <span class="c1"># # WHERE LENGTH(rest) &gt; 0</span>
                <span class="c1"># # )</span>
                <span class="c1"># # SELECT STRING_AGG(CASE WHEN col LIKE &#39;[&#39;&#39;a&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;b&#39;&#39;,%&#39; THEN col END, &#39;,&#39;) x,</span>
                       <span class="c1"># # STRING_AGG(CASE WHEN col LIKE &#39;[&#39;&#39;c&#39;&#39;,%&#39; THEN col END, &#39;,&#39;) y,</span>
                       <span class="c1"># # STRING_AGG(CASE WHEN col LIKE &#39;[&#39;&#39;d&#39;&#39;,%&#39; THEN col END, &#39;,&#39;) z</span>
                <span class="c1"># # FROM cte</span>
                <span class="c1"># # GROUP BY id</span>
        
            <span class="c1"># elif server==&#39;sqlite&#39;:        </span>
            
                
                <span class="c1"># sqlite_DB_path = &#39;{}{}{}&#39;.format(self.HOME, os.sep,&quot;pyarchinit_DB_folder&quot;)</span>
                
                <span class="c1"># file_path_sqlite = sqlite_DB_path+os.sep+db_names</span>
                <span class="c1"># conn = sq.connect(file_path_sqlite)</span>
                <span class="c1"># conn.enable_load_extension(True)</span>
                
                
                <span class="c1"># #now we can load the extension</span>
                <span class="c1"># # depending on your OS and sqlite/spatialite version you might need to add </span>
                <span class="c1"># # &#39;.so&#39; (Linux) or &#39;.dll&#39; (Windows) to the extension name</span>

                <span class="c1"># #mod_spatialite (recommended)</span>
                <span class="c1"># conn.execute(&#39;SELECT load_extension(&quot;mod_spatialite&quot;)&#39;)   </span>
                <span class="c1"># conn.execute(&#39;SELECT InitSpatialMetaData(1);&#39;)  </span>
                <span class="c1"># cur = conn.cursor()</span>
                <span class="c1"># cur2 = conn.cursor()</span>
                
                <span class="c1"># name_= &#39;%s&#39; % (sito_location+&#39;_&#39; +  time.strftime(&#39;%Y%m%d_&#39;) + &#39;.xlsx&#39;)</span>
                <span class="c1"># dump_dir=os.path.join(self.MATRIX_PATH, name_)</span>
                <span class="c1"># writer = pd.ExcelWriter(dump_dir, engine=&#39;xlsxwriter&#39;)</span>
                <span class="c1"># workbook  = writer.book</span>
                
                
                <span class="c1"># cur.execute(&quot;SELECT  area, us, attivita,datazione From us_table where sito=&#39;%s&#39; order by rowid;&quot; % sito_location)</span>
                <span class="c1"># rows1 = cur.fetchall()</span>
                <span class="c1"># col_names1 = [&#39;Area&#39;,&#39;US&#39;,&#39;Attivit√†&#39;,&#39;Epoca&#39;]</span>
                <span class="c1"># t1=pd.DataFrame(rows1,columns=col_names1).applymap(self.list2pipe)</span>
                <span class="c1"># t1.to_excel(writer, sheet_name=&#39;US&#39;,index=False)</span>
                
                <span class="c1"># cur2.execute(&quot;&quot;&quot;WITH cte AS </span>
                    <span class="c1"># (   SELECT rowid ,</span>
                   <span class="c1"># SUBSTR(rapporti,  1, INSTR(rapporti || &#39;;&#39;, &#39;;&#39;) -1) col,</span>
                   <span class="c1"># SUBSTR(rapporti, INSTR(rapporti || &#39;;&#39;, &#39;;&#39;) + 1) rest</span>
                   <span class="c1"># FROM (SELECT rowid, REPLACE(REPLACE(REPLACE(rapporti, &#39;[[&#39;, &#39;[&#39;), &#39;]]&#39;, &#39;]&#39;), &#39;], [&#39;, &#39;];[&#39;) rapporti FROM us_table</span>
                   <span class="c1"># WHERE sito = &quot;&quot;&quot;+&quot;&#39;&quot;+sito_location+&quot;&#39;&quot;+&quot;&quot;&quot;)</span>
                   <span class="c1"># UNION all</span>
                   <span class="c1"># SELECT rowid us,</span>
                   <span class="c1"># SUBSTR(rest, 1, INSTR(rest || &#39;;&#39;, &#39;;&#39;)  -1),</span>
                   <span class="c1"># SUBSTR(rest, INSTR(rest || &#39;;&#39;, &#39;;&#39;) + 1)   FROM cte   WHERE LENGTH(rest) &gt; 0 )</span>
                   <span class="c1"># SELECT </span>
                   <span class="c1"># GROUP_CONCAT(CASE WHEN col LIKE &#39;[&#39;&#39;Copre&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;Taglia&#39;&#39;,%&#39;</span>
                   <span class="c1"># OR col LIKE &#39;[&#39;&#39;Riempie&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;Si appoggia a&#39;&#39;,%&#39;  THEN col END) post,</span>
                   
                   <span class="c1"># GROUP_CONCAT(CASE WHEN col LIKE &#39;[&#39;&#39;Coperto da&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;Riempito da&#39;&#39;,%&#39;</span>
                   <span class="c1"># OR col LIKE &#39;[&#39;&#39;Tagliato da&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;Gli si appoggia&#39;&#39;,%&#39; THEN col END) ante,</span>
                   
                   <span class="c1"># GROUP_CONCAT(CASE WHEN col LIKE &#39;[&#39;&#39;Si lega a&#39;&#39;,%&#39; or col LIKE &#39;[&#39;&#39;Uguale a&#39;&#39;,%&#39; THEN col END) contemp</span>
            
                    <span class="c1"># FROM cte GROUP BY rowid order by rowid&quot;&quot;&quot;)</span>
                <span class="c1"># rows2 = cur2.fetchall()</span>
                <span class="c1"># col_names2 = [&#39;Rapporto Posteriore&#39;,&#39;Rapporto Anteriore&#39;, &#39;Rapporto Contemporaneo&#39;]</span>
                <span class="c1"># t2=pd.DataFrame(rows2,columns=col_names2).applymap(self.list2pipe)</span>
                <span class="c1"># t2.to_excel(writer, sheet_name=&#39;Rapporti&#39;,index=False)</span>
                
                <span class="c1"># worksheet1 = writer.sheets[&#39;US&#39;]</span>
                <span class="c1"># worksheet1.set_column(&#39;A:A&#39;, 30, None)</span>
                <span class="c1"># worksheet1.set_column(&#39;B:B&#39;, 30, None)</span>
                <span class="c1"># worksheet1.set_column(&#39;C:C&#39;, 30, None)</span>
                <span class="c1"># worksheet1.set_column(&#39;D:D&#39;, 30, None)</span>
                <span class="c1"># worksheet1.set_column(&#39;E:E&#39;, 30, None)</span>
                
                
                <span class="c1"># worksheet2 = writer.sheets[&#39;Rapporti&#39;]</span>
                <span class="c1"># worksheet2.set_column(&#39;A:A&#39;, 30, None)</span>
                <span class="c1"># worksheet2.set_column(&#39;B:B&#39;, 30, None)</span>
                <span class="c1"># worksheet2.set_column(&#39;C:C&#39;, 30, None)</span>
                <span class="c1"># writer.save()</span>
            <span class="c1"># QMessageBox.information(self, &quot;INFO&quot;, &quot;Conversion completed&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
        <span class="c1"># except KeyError as e:</span>
            <span class="c1"># QMessageBox.warning(self, &quot;Error&quot;, str(e),</span>
                                <span class="c1"># QMessageBox.Ok)</span>
       
        
    <span class="c1"># def openpdfDir(self):</span>
        <span class="c1"># HOME = os.environ[&#39;PYARCHINIT_HOME&#39;]</span>
        <span class="c1"># path = &#39;{}{}{}&#39;.format(HOME, os.sep, &quot;pyarchinit_PDF_folder&quot;)</span>
        <span class="c1"># if platform.system() == &quot;Windows&quot;:</span>
            <span class="c1"># os.startfile(path)</span>
        <span class="c1"># elif platform.system() == &quot;Darwin&quot;:</span>
            <span class="c1"># subprocess.Popen([&quot;open&quot;, path])</span>
        <span class="c1"># else:</span>
            <span class="c1"># subprocess.Popen([&quot;xdg-open&quot;, path])</span>
    <span class="c1"># def on_pushButton_export_matrix_pressed(self):</span>
        <span class="c1"># if self.checkBox_ED.isChecked():</span>
            
            <span class="c1"># id_us_dict = {}</span>
            <span class="c1"># for i in range(len(self.DATA_LIST)):</span>
                <span class="c1"># id_us_dict[self.DATA_LIST[i].us] = self.DATA_LIST[i].id_us</span>
                
            <span class="c1"># dlg = pyarchinit_Interactive_Matrix(self.iface, self.DATA_LIST, id_us_dict)</span>
            <span class="c1"># data_plot=dlg.generate_matrix_2()</span>
            
            <span class="c1"># # ###interactive matrix###</span>
            <span class="c1"># # matrix_path = &#39;{}{}{}&#39;.format(self.HOME, os.sep, &quot;pyarchinit_Matrix_folder&quot;)</span>
            <span class="c1"># # filename=&#39;Harris_matrix2ED_graphml.dot&#39;</span>
            <span class="c1"># # hm=os.path.join(matrix_path, filename)</span>
            <span class="c1"># # gv = pgv.AGraph(hm, strict=False, directed=False)</span>
            <span class="c1"># # dlg.plot_matrix(gv)</span>
            <span class="c1"># # dlg.exec_()</span>
        <span class="c1"># if not self.checkBox_ED.isChecked():</span>
            <span class="c1"># id_us_dict = {}</span>
            <span class="c1"># for i in range(len(self.DATA_LIST)):</span>
                <span class="c1"># id_us_dict[self.DATA_LIST[i].us] = self.DATA_LIST[i].id_us</span>
            <span class="c1"># dlg = pyarchinit_Interactive_Matrix(self.iface, self.DATA_LIST, id_us_dict)</span>
            <span class="c1"># data_plot=dlg.generate_matrix()</span>
            
            <span class="c1"># ###interactive matrix###</span>
        <span class="c1"># # if self.checkBox_IM.isChecked():    </span>
            <span class="c1"># # matrix_path = &#39;{}{}{}&#39;.format(self.HOME, os.sep, &quot;pyarchinit_Matrix_folder&quot;)</span>
            <span class="c1"># # filename=&#39;Harris_matrix_tred.dot&#39;</span>
            <span class="c1"># # hm=os.path.join(matrix_path, filename)</span>
            <span class="c1"># # gv = pgv.AGraph(hm, strict=False, directed=True)</span>
            <span class="c1"># # dlg.plot_matrix(gv)</span>
            <span class="c1"># # dlg.exec_()</span>
    <span class="c1"># def launch_matrix_exp_if(self, msg):</span>
        <span class="c1"># if msg == QMessageBox.Ok:</span>
            <span class="c1"># self.on_pushButton_export_matrix_pressed()</span>
        <span class="c1"># else:</span>
            <span class="c1"># pass</span>
    <span class="c1"># def on_pushButton_orderLayers_pressed(self):</span>
        <span class="c1"># # QMessageBox.warning(self, &#39;ATTENZIONE&#39;,</span>
        <span class="c1"># #                     &quot;&quot;&quot;Il sistema accetta come dataset da elaborare ricerche su singolo SITO e AREA. Se state lanciando il sistema su siti o aree differenti, i dati di siti differenti saranno sovrascritti. Per terminare il sistema dopo l&#39;Ok premere Cancel.&quot;&quot;&quot;,</span>
        <span class="c1"># #                     QMessageBox.Ok)</span>
        <span class="c1"># # self.launch_matrix_exp_if(QMessageBox.warning(self, &#39;ATTENZIONE&#39;,</span>
        <span class="c1"># #                                               &quot;Si consiglia di lanciare il matrix e controllare se sono presenti paradossi stratigrafici prima di proseguire&quot;,</span>
        <span class="c1"># #                                               QMessageBox.Ok | QMessageBox.Cancel))</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># self.launch_order_layer_if(QMessageBox.warning(self, &#39;ATTENZIONE&#39;,</span>
                                                       <span class="c1"># &quot;Se saranno presenti paradossi stratigrafici l&#39;order layer non andr√† a buon fine&quot;,</span>
                                                       <span class="c1"># QMessageBox.Ok))</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># self.launch_order_layer_if(QMessageBox.warning(self, &#39;ACHTUNG&#39;,</span>
                                                       <span class="c1"># &quot;Bist du sicher das du fortfahren m√∂chtest? Wenn aktuell stratigraphische Paradoxa auftauchen K√∂nnte das System zusammenbrechen!&quot;,</span>
                                                       <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
        <span class="c1"># else:</span>
            <span class="c1"># self.launch_order_layer_if(QMessageBox.warning(self, &#39;ATTENZIONE&#39;,</span>
                                                       <span class="c1"># &quot;Are you sure you want to go on? If there are stratigraphic paradoxes, the system could crush!&quot;,</span>
                                                       <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
    <span class="c1"># def launch_order_layer_if(self, msg):</span>
        <span class="c1"># if msg == QMessageBox.Ok:</span>
            <span class="c1"># # report errori rapporti stratigrafici</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># msg_tipo_rapp = &quot;Manca il tipo di rapporto nell&#39;US: \n&quot;</span>
                <span class="c1"># msg_nr_rapp = &quot;Manca il numero del rapporto nell&#39;US: \n&quot;</span>
                <span class="c1"># msg_paradx_rapp = &quot;Paradosso nei rapporti: \n&quot;</span>
                <span class="c1"># msg_us_mancanti = &quot;Mancano le seguenti schede US presenti nei rapporti: \n&quot;</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># msg_tipo_rapp = &quot;Der Beziehungstyp fehlt in den SE: \n&quot;</span>
                <span class="c1"># msg_nr_rapp = &quot;Die Berichtsnummer fehlt in den SE: \n&quot;</span>
                <span class="c1"># msg_paradx_rapp = &quot;Paradox in Beziehungen: \n&quot;</span>
                <span class="c1"># msg_us_mancanti = &quot;Folgende SE-formular fehlen in den Berichten: \n&quot;</span>
            <span class="c1"># else:</span>
                <span class="c1"># msg_tipo_rapp = &quot;The relationship type is missing in the SU: \n&quot;</span>
                <span class="c1"># msg_nr_rapp = &quot;The report number is missing in the SU: \n&quot;</span>
                <span class="c1"># msg_paradx_rapp = &quot;Paradox in relationships: \n&quot;</span>
                <span class="c1"># msg_us_mancanti = &quot;The following SU forms are missing from the reports: \n&quot;</span>
            <span class="c1"># # report errori rapporti stratigrafici</span>
            <span class="c1"># data = []</span>
            <span class="c1"># # Blocca il sistema di ordinamento su un sito ed area specifci in base alla ricerca eseguita sulla scheda US</span>
            
            
            
            
            
            <span class="c1"># for sing_rec in self.DATA_LIST:</span>
                <span class="c1"># us = sing_rec.us</span>
                <span class="c1"># rapporti_stratigrafici = eval(sing_rec.rapporti)</span>
                <span class="c1"># # [l.pop(4) for l in rapporti_stratigrafici]</span>
                <span class="c1"># # [l.pop(3) for l in rapporti_stratigrafici]</span>
                <span class="c1"># # [l.pop(2) for l in rapporti_stratigrafici]</span>
                
                <span class="c1"># for sing_rapp in rapporti_stratigrafici:</span>
                    
                    
                    <span class="c1"># if len(sing_rapp) !=2:##cambiato da 2 a 5</span>
                        <span class="c1"># if self.L==&#39;it&#39;:</span>
                            <span class="c1"># msg_nr_rapp = msg_nr_rapp + str(sing_rapp[0]) + &quot;relativo a: &quot; + str(us) + &quot; \n&quot;</span>
                        <span class="c1"># elif self.L==&#39;de&#39;:</span>
                            <span class="c1"># msg_nr_rapp = msg_nr_rapp + str(sing_rapp[0]) + &quot;bez√ºglich: &quot; + str(us) + &quot; \n&quot;</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># msg_nr_rapp = msg_nr_rapp + str(sing_rapp[0]) + &quot;concerning: &quot; + str(us) + &quot; \n&quot;</span>
                    <span class="c1"># try:</span>
                        <span class="c1"># if sing_rapp[0] == &#39;Cuts&#39; or  sing_rapp[0] == &#39;Covers&#39; or  sing_rapp[0] == &#39;Abuts&#39; or  sing_rapp[0] == &#39;Fills&#39; or sing_rapp[0] == &#39;Taglia&#39; or  sing_rapp[0] == &#39;Copre&#39; or  sing_rapp[0] == &#39;Si appoggia a&#39; or  sing_rapp[0] == &#39;Riempie&#39;  or  sing_rapp[0] == &#39;Schneidet&#39; or  sing_rapp[0] == &#39;Liegt √ºber&#39; or  sing_rapp[0] == &#39;St√ºtzt sich auf&#39; or  sing_rapp[0] == &#39;Verf√ºllt&#39;:</span>
                            <span class="c1"># try:</span>
                                <span class="c1"># if sing_rapp[1] != &#39;&#39;:</span>
                                    <span class="c1"># harris_rapp = (int(us), int(sing_rapp[1]))</span>
                                    <span class="c1"># ##                                  if harris_rapp== (1, 67):</span>
                                    <span class="c1"># ##                                      QMessageBox.warning(self, &quot;Messaggio&quot;, &quot;Magagna&quot;, QMessageBox.Ok)</span>
                                    <span class="c1"># data.append(harris_rapp)</span>
                            <span class="c1"># except:</span>
                                <span class="c1"># msg_nr_rapp = msg_nr_rapp + str(us) + &quot; \n&quot;</span>
                    <span class="c1"># except:</span>
                        <span class="c1"># msg_tipo_rapp = msg_tipo_rapp + str(us) + &quot; \n&quot;</span>
            <span class="c1"># for i in data:</span>
                <span class="c1"># temp_tup = (i[1], i[</span>
                    <span class="c1"># 0])  # controlla che nn vi siano rapporti inversi dentro la lista DA PROBLEMI CON GLI UGUALE A E I SI LEGA A</span>
                <span class="c1"># # QMessageBox.warning(self, &quot;Messaggio&quot;, &quot;Temp_tup&quot; + str(temp_tup), QMessageBox.Ok)</span>
                <span class="c1"># if data.count(temp_tup) != 0:</span>
                    <span class="c1"># msg_paradx_rapp = msg_paradx_rapp + &#39;\n&#39; + str(i) + &#39;\n&#39; + str(temp_tup)</span>
                    <span class="c1"># data.remove(i)</span>
                    <span class="c1"># # OK</span>
                    <span class="c1"># ## QMessageBox.warning(self, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(data), QMessageBox.Ok)</span>
                    <span class="c1"># # Blocca il sistema di ordinamento su un sito ed area specifci in base alla ricerca eseguita sulla scheda US</span>
            
            
            <span class="c1"># sito = self.DATA_LIST[0].sito  # self.comboBox_sito_rappcheck.currentText()</span>
            <span class="c1"># area = self.DATA_LIST[0].area  # self.comboBox_area.currentText()</span>
            <span class="c1"># # script order layer from pyqgis</span>
            <span class="c1"># OL = Order_layer_v2(self.DB_MANAGER, sito, area)</span>
            <span class="c1"># # QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(OL), QMessageBox.Ok)</span>
            <span class="c1"># order_layer_dict = OL.main_order_layer()</span>
            <span class="c1"># #QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(order_layer_dict), QMessageBox.Ok)</span>
            <span class="c1"># # order_number = &quot;&quot;</span>
            <span class="c1"># # us = &quot;&quot;</span>
            <span class="c1"># for k, v in order_layer_dict.items():#era iteritems prima </span>
                <span class="c1"># order_number = str(k)</span>
                <span class="c1"># us = v</span>
                <span class="c1"># # QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(k)+str(v), QMessageBox.Ok)</span>
                <span class="c1"># for sing_us in v:</span>
                    <span class="c1"># search_dict = {&#39;sito&#39;: &quot;&#39;&quot;+str(sito)+&quot;&#39;&quot;, &#39;area&#39;: &quot;&#39;&quot;+str(area)+&quot;&#39;&quot;,</span>
                                   <span class="c1"># &#39;us&#39;: int(sing_us)}</span>
                    <span class="c1"># #QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(search_dict), QMessageBox.Ok)</span>
                    <span class="c1"># try:</span>
                        <span class="c1"># records = self.DB_MANAGER.query_bool(search_dict, self.MAPPER_TABLE_CLASS)  # carica tutti i dati di uno scavo ordinati per numero di US</span>
                        <span class="c1"># #QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;records&quot; + str(records), QMessageBox.Ok)</span>
                        <span class="c1"># a= self.DB_MANAGER.update(self.MAPPER_TABLE_CLASS, self.ID_TABLE, [int(records[0].id_us)], [&#39;order_layer&#39;], [order_number])</span>
                        <span class="c1"># #QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;records&quot; + str(a), QMessageBox.Ok)</span>
                        <span class="c1"># self.on_pushButton_view_all_pressed()</span>
                    <span class="c1"># except Exception as e:</span>
                        <span class="c1"># QMessageBox.warning(self, u&#39;ACHTUNG&#39;, str(e), QMessageBox.Ok)</span>
            <span class="c1"># # blocco output errori</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># filename_tipo_rapporti_mancanti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;tipo_rapporti_mancanti.txt&#39;)</span>
                <span class="c1"># filename_nr_rapporti_mancanti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;nr_rapporti_mancanti.txt&#39;)</span>
                <span class="c1"># filename_paradosso_rapporti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;paradosso_rapporti.txt&#39;)</span>
                <span class="c1"># filename_us_mancanti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;us_mancanti.txt&#39;)</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># filename_tipo_rapporti_mancanti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;type_missing_relationships.txt&#39;)</span>
                <span class="c1"># filename_nr_rapporti_mancanti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;nr_missing relashionships.txt&#39;)</span>
                <span class="c1"># filename_paradosso_rapporti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;relashionships_paradox.txt&#39;)</span>
                <span class="c1"># filename_us_mancanti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;su_missing.txt&#39;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># filename_tipo_rapporti_mancanti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;type_missing_relationships.txt&#39;)</span>
                <span class="c1"># filename_nr_rapporti_mancanti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;nr_missing relashionships.txt&#39;)</span>
                <span class="c1"># filename_paradosso_rapporti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;relashionships_paradox.txt&#39;)</span>
                <span class="c1"># filename_us_mancanti = &#39;{}{}{}&#39;.format(self.REPORT_PATH, os.sep, &#39;su_missing.txt&#39;)</span>
            <span class="c1"># self.testing(filename_tipo_rapporti_mancanti, str(msg_tipo_rapp))</span>
            <span class="c1"># self.testing(filename_nr_rapporti_mancanti, str(msg_nr_rapp))</span>
            <span class="c1"># self.testing(filename_paradosso_rapporti, str(msg_paradx_rapp))</span>
            <span class="c1"># self.testing(filename_us_mancanti, str(msg_us_mancanti))</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, u&#39;ATTENZIONE&#39;, u&quot;Sistema di ordinamento Terminato&quot;, QMessageBox.Ok)</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, u&#39;ACHTUNG&#39;, &quot;Ordnungssystem beendet&quot;, QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.warning(self, u&#39;WARNING&#39;, &quot;Sorting system Complete&quot;, QMessageBox.Ok)</span>
        <span class="c1"># else:</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, u&#39;ATTENZIONE&#39;, u&quot;Sistema di ordinamento US abortito&quot;, QMessageBox.Ok)</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &#39;ACHTUNG&#39;, u&quot;Ordnungssystem verlassen&quot;, QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.warning(self, &#39;WARNING&#39;, &quot;SU aborted sorting system&quot;, QMessageBox.Ok)</span>
           <span class="c1"># # blocco output errori</span>
    <span class="c1"># def on_toolButtonPan_toggled(self):</span>
        <span class="c1"># self.toolPan = QgsMapToolPan(self.mapPreview)</span>
        <span class="c1"># self.mapPreview.setMapTool(self.toolPan)</span>
    <span class="c1"># def on_pushButton_showSelectedFeatures_pressed(self):</span>
        <span class="c1"># # field_position = self.pyQGIS.findFieldFrDict(self.ID_TABLE) #ricava la posizione del campo</span>
        <span class="c1"># try:</span>
            <span class="c1"># layer = self.iface.mapCanvas().currentLayer()</span>
            <span class="c1"># fieldname = self.ID_TABLE</span>
            <span class="c1"># if not layer:</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;ATTENZIONE&#39;, &quot;Nessun elemento selezionato&quot;, QMessageBox.Ok)</span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;ACHTUNG&#39;, &quot;keine Elemente ausgew√§hlt&quot;, QMessageBox.Ok)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;WARNING&#39;, &quot;No items selected&quot;, QMessageBox.Ok)</span>
            <span class="c1"># features_list = layer.selectedFeatures()</span>
            <span class="c1"># field_position = &quot;&quot;</span>
            <span class="c1"># for single in layer.getFeatures():</span>
                <span class="c1"># field_position = single.fieldNameIndex(fieldname)</span>
            <span class="c1"># id_list = []</span>
            <span class="c1"># for feat in features_list:</span>
                <span class="c1"># attr_list = feat.attributes()</span>
                <span class="c1"># id_list.append(attr_list[field_position])</span>
                <span class="c1"># # viene impostata la query per il database</span>
            <span class="c1"># items, order_type = [self.ID_TABLE], &quot;asc&quot;</span>
            <span class="c1"># self.empty_fields()</span>
            <span class="c1"># self.DATA_LIST = []</span>
            <span class="c1"># temp_data_list = self.DB_MANAGER.query_sort(id_list, items, order_type, self.MAPPER_TABLE_CLASS, self.ID_TABLE)</span>
            <span class="c1"># for us in temp_data_list:</span>
                <span class="c1"># self.DATA_LIST.append(us)</span>
                <span class="c1"># # vengono riempiti i campi con i dati trovati</span>
            <span class="c1"># self.fill_fields()</span>
            <span class="c1"># self.BROWSE_STATUS = &#39;b&#39;</span>
            <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
            <span class="c1"># if type(self.REC_CORR) == &quot;&lt;type &#39;str&#39;&gt;&quot;:</span>
                <span class="c1"># corr = 0</span>
            <span class="c1"># else:</span>
                <span class="c1"># corr = self.REC_CORR</span>
            <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
            <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
            <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
        <span class="c1"># except Exception as e:</span>
            <span class="c1"># QMessageBox.warning(self, &#39;ATTENZIONE&#39;, str(e), QMessageBox.Ok)</span>
    
    <span class="c1"># def on_pushButton_sort_pressed(self):</span>
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># if self.check_record_state() == 1:</span>
            <span class="c1"># pass</span>
        <span class="c1"># else:</span>
            <span class="c1"># dlg = SortPanelMain(self)</span>
            <span class="c1"># dlg.insertItems(self.SORT_ITEMS)</span>
            <span class="c1"># dlg.exec_()</span>
            <span class="c1"># items, order_type = dlg.ITEMS, dlg.TYPE_ORDER</span>
            <span class="c1"># self.SORT_ITEMS_CONVERTED = []</span>
            <span class="c1"># for i in items:</span>
                <span class="c1"># # QMessageBox.warning(self, &quot;Messaggio&quot;,i, QMessageBox.Ok)</span>
                <span class="c1"># self.SORT_ITEMS_CONVERTED.append(</span>
                    <span class="c1"># self.CONVERSION_DICT[str(i)])  # apportare la modifica nellle altre schede</span>
            <span class="c1"># self.SORT_MODE = order_type</span>
            <span class="c1"># self.empty_fields()</span>
            <span class="c1"># id_list = []</span>
            <span class="c1"># for i in self.DATA_LIST:</span>
                <span class="c1"># id_list.append(eval(&quot;i.&quot; + self.ID_TABLE))</span>
            <span class="c1"># self.DATA_LIST = []</span>
            <span class="c1"># temp_data_list = self.DB_MANAGER.query_sort(id_list, self.SORT_ITEMS_CONVERTED, self.SORT_MODE,</span>
                                                        <span class="c1"># self.MAPPER_TABLE_CLASS, self.ID_TABLE)</span>
            <span class="c1"># for i in temp_data_list:</span>
                <span class="c1"># self.DATA_LIST.append(i)</span>
            <span class="c1"># self.BROWSE_STATUS = &#39;b&#39;</span>
            <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
            <span class="c1"># if type(self.REC_CORR) == &quot;&lt;type &#39;str&#39;&gt;&quot;:</span>
                <span class="c1"># corr = 0</span>
            <span class="c1"># else:</span>
                <span class="c1"># corr = self.REC_CORR</span>
            <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
            <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
            <span class="c1"># self.SORT_STATUS = &quot;o&quot;</span>
            <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
            <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
            <span class="c1"># self.fill_fields()</span>
    <span class="c1"># def on_toolButtonGis_toggled(self):</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># if self.toolButtonGis.isChecked():</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;,</span>
                                    <span class="c1"># &quot;Modalita&#39; GIS attiva. Da ora le tue ricerche verranno visualizzate sul GIS&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;,</span>
                                    <span class="c1"># &quot;Modalita&#39; GIS disattivata. Da ora le tue ricerche non verranno piu&#39; visualizzate sul GIS&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># if self.toolButtonGis.isChecked():</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;Modalit√§t&#39; GIS aktiv. Von jetzt wird Deine Untersuchung mit Gis visualisiert&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;Modalit√§t&#39; GIS deaktiviert. Von jetzt an wird deine Untersuchung nicht mehr mit Gis visualisiert&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
        <span class="c1"># else:</span>
            <span class="c1"># if self.toolButtonGis.isChecked():</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;GIS mode active. From now on your searches will be displayed on the GIS&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;GIS mode disabled. From now on, your searches will no longer be displayed on the GIS.&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
    <span class="c1"># def on_toolButtonPreview_toggled(self):</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># if self.toolButtonPreview.isChecked():</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;,</span>
                                    <span class="c1"># &quot;Modalita&#39; Preview US attivata. Le piante delle US saranno visualizzate nella sezione Piante&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
                <span class="c1"># self.loadMapPreview()</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.loadMapPreview(1)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># if self.toolButtonPreview.isChecked():</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;Modalit√§t&#39; Preview der aktivierten SE. Die Plana der SE werden in der Auswahl der Plana visualisiert&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
                <span class="c1"># self.loadMapPreview()</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.loadMapPreview(1)</span>
        <span class="c1"># else:</span>
            <span class="c1"># if self.toolButtonPreview.isChecked():</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;Preview SU mode enabled. US plants will be displayed in the Plants section&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
                <span class="c1"># self.loadMapPreview()</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.loadMapPreview(1)</span>
    <span class="c1"># # def on_toolButtonPreviewMedia_toggled(self):</span>
        <span class="c1"># # if self.L==&#39;it&#39;:</span>
            <span class="c1"># # if self.toolButtonPreviewMedia.isChecked() == True:</span>
                <span class="c1"># # QMessageBox.warning(self, &quot;Messaggio&quot;,</span>
                                    <span class="c1"># # &quot;Modalita&#39; Preview Media US attivata. Le immagini delle US saranno visualizzate nella sezione Media&quot;,</span>
                                    <span class="c1"># # QMessageBox.Ok)</span>
                <span class="c1"># # self.loadMediaPreview()</span>
            <span class="c1"># # else:</span>
                <span class="c1"># # self.loadMediaPreview(1)</span>
        <span class="c1"># # elif self.L==&#39;de&#39;:</span>
            <span class="c1"># # if self.toolButtonPreviewMedia.isChecked()== True:</span>
                <span class="c1"># # QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># # &quot;Modalit√§t&#39; Preview Media SE aktiviert. Die Bilder der SE werden in der Preview media Auswahl visualisiert&quot;,</span>
                                    <span class="c1"># # QMessageBox.Ok)</span>
                <span class="c1"># # self.loadMediaPreview()</span>
            <span class="c1"># # else:</span>
                <span class="c1"># # self.loadMediaPreview(1)</span>
        <span class="c1"># # else:</span>
            <span class="c1"># # if self.toolButtonPreviewMedia.isChecked()== True:</span>
                <span class="c1"># # QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># # &quot;SU Media Preview mode enabled. US images will be displayed in the Media section&quot;,</span>
                                    <span class="c1"># # QMessageBox.Ok)</span>
                <span class="c1"># # self.loadMediaPreview()</span>
            <span class="c1"># # else:</span>
                <span class="c1"># # self.loadMediaPreview(1)        </span>
    <span class="c1"># def on_pushButton_addRaster_pressed(self):</span>
        <span class="c1"># if self.toolButtonGis.isChecked():</span>
            <span class="c1"># self.pyQGIS.addRasterLayer()</span>
    <span class="c1"># def on_pushButton_new_rec_pressed(self):</span>
        <span class="c1"># conn = Connection()</span>
        
        <span class="c1"># sito_set= conn.sito_set()</span>
        <span class="c1"># sito_set_str = sito_set[&#39;sito_set&#39;]</span>
        <span class="c1"># if bool(self.DATA_LIST):</span>
            <span class="c1"># if self.data_error_check() == 1:</span>
                <span class="c1"># pass</span>
            <span class="c1"># # else:</span>
                <span class="c1"># # if self.BROWSE_STATUS == &quot;b&quot;:</span>
                    <span class="c1"># # if self.DATA_LIST:</span>
                        <span class="c1"># # if self.records_equal_check() == 1:</span>
                            <span class="c1"># # if self.L==&#39;it&#39;:</span>
                                <span class="c1"># # self.update_if(QMessageBox.warning(self, &#39;Errore&#39;,</span>
                                                                   <span class="c1"># # &quot;Il record e&#39; stato modificato. Vuoi salvare le modifiche?&quot;,QMessageBox.Ok | QMessageBox.Cancel))</span>
                            <span class="c1"># # elif self.L==&#39;de&#39;:</span>
                                <span class="c1"># # self.update_if(QMessageBox.warning(self, &#39;Error&#39;,</span>
                                                                   <span class="c1"># # &quot;Der Record wurde ge√§ndert. M√∂chtest du die √Ñnderungen speichern?&quot;,</span>
                                                                   <span class="c1"># # QMessageBox.Ok | QMessageBox.Cancel))</span>
                            <span class="c1"># # else:</span>
                                <span class="c1"># # self.update_if(QMessageBox.warning(self, &#39;Error&#39;,</span>
                                                                   <span class="c1"># # &quot;The record has been changed. Do you want to save the changes?&quot;,</span>
                                                                   <span class="c1"># # QMessageBox.Ok | QMessageBox.Cancel))</span>
        <span class="c1"># if self.BROWSE_STATUS != &quot;n&quot;:</span>
            <span class="c1"># if bool(self.comboBox_sito.currentText()) and self.comboBox_sito.currentText()==sito_set_str:</span>
                <span class="c1"># self.BROWSE_STATUS = &quot;n&quot;</span>
                <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                <span class="c1"># self.empty_fields_nosite()</span>
                
                <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_area&quot;], 1)</span>
                <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_unita_tipo&quot;], 1)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], False)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], True)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], True)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_unita_tipo&quot;], True)</span>
                <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
                <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
                <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                <span class="c1"># self.set_rec_counter(&#39;&#39;, &#39;&#39;)</span>
                <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[&quot;n&quot;])</span>
                
            <span class="c1"># else:</span>
                <span class="c1"># self.BROWSE_STATUS = &quot;n&quot;</span>
                <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                <span class="c1"># self.empty_fields()</span>
                <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_sito&quot;], 1)</span>
                <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_area&quot;], 1)</span>
                <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_unita_tipo&quot;], 1)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;True&quot;)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;True&quot;)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;True&quot;)</span>
                <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_unita_tipo&quot;], &quot;True&quot;)</span>
                <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
                <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
                
                <span class="c1"># self.set_rec_counter(&#39;&#39;, &#39;&#39;)</span>
                <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[&quot;n&quot;])</span>
                
            
            <span class="c1"># self.enable_button(0)</span>
    
    <span class="c1"># def save_rapp(self):</span>
        
        
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># if self.BROWSE_STATUS == &quot;b&quot;:</span>
            <span class="c1"># if self.data_error_check() == 0:</span>
                <span class="c1"># if self.records_equal_check() == 1:</span>
                    
                    <span class="c1"># if self.update_if(QMessageBox.Ok):</span>
                        <span class="c1"># QMessageBox.Ok</span>
                        
                    
                    <span class="c1"># # self.empty_fields()</span>
                    <span class="c1"># # self.SORT_STATUS = &quot;n&quot;</span>
                    <span class="c1"># # self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
                    <span class="c1"># # self.enable_button(1)</span>
                    
                    <span class="c1"># # self.fill_fields(self.REC_CORR)</span>
                <span class="c1"># # else:</span>
                    <span class="c1"># # if self.L==&#39;it&#39;:</span>
                        <span class="c1"># # QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Non √® stata realizzata alcuna modifica.&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># # elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># # QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Keine √Ñnderung vorgenommen&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># # else:</span>
                        <span class="c1"># # QMessageBox.warning(self, &quot;Warning&quot;, &quot;No changes have been made&quot;, QMessageBox.Ok)       </span>
        <span class="c1"># # else:</span>
            <span class="c1"># # if self.data_error_check() == 0:</span>
                <span class="c1"># # test_insert = self.insert_new_rec()</span>
                <span class="c1"># # if test_insert == 1:</span>
                    <span class="c1"># # self.empty_fields()</span>
                    <span class="c1"># # self.SORT_STATUS = &quot;n&quot;</span>
                    <span class="c1"># # self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
                    <span class="c1"># # self.charge_records()</span>
                    <span class="c1"># # self.charge_list()</span>
                    <span class="c1"># # self.set_sito()</span>
                    <span class="c1"># # self.BROWSE_STATUS = &quot;b&quot;</span>
                    <span class="c1"># # self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># # self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), len(self.DATA_LIST) - 1</span>
                    <span class="c1"># # self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
                    <span class="c1"># # self.setComboBoxEditable([&quot;self.comboBox_sito&quot;], 1)</span>
                    <span class="c1"># # self.setComboBoxEditable([&quot;self.comboBox_area&quot;], 1)</span>
                    <span class="c1"># # self.setComboBoxEditable([&quot;self.comboBox_unita_tipo&quot;], 1)</span>
                    <span class="c1"># # self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;False&quot;)</span>
                    <span class="c1"># # self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;False&quot;)</span>
                    <span class="c1"># # self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;False&quot;)</span>
                    <span class="c1"># # self.setComboBoxEnable([&quot;self.comboBox_unita_tipo&quot;], &quot;True&quot;)</span>
                    <span class="c1"># # self.fill_fields(self.REC_CORR)</span>
                    <span class="c1"># # self.enable_button(1)</span>
            <span class="c1"># # else:</span>
                <span class="c1"># # if self.L==&#39;it&#39;:</span>
                    <span class="c1"># # QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Problema nell&#39;inserimento dati&quot;, QMessageBox.Ok)</span>
                <span class="c1"># # elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># # QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Problem der Dateneingabe&quot;, QMessageBox.Ok)</span>
                <span class="c1"># # else:</span>
                    <span class="c1"># # QMessageBox.warning(self, &quot;Warning&quot;, &quot;Problem with data entry&quot;, QMessageBox.Ok) </span>
    <span class="c1"># def on_pushButton_save_pressed(self):</span>
        
        
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># if self.BROWSE_STATUS == &quot;b&quot;:</span>
            <span class="c1"># if self.data_error_check() == 0:</span>
                <span class="c1"># if self.records_equal_check() == 1:</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># self.update_if(QMessageBox.warning(self, &#39;Errore&#39;,</span>
                                                           <span class="c1"># &quot;Il record e&#39; stato modificato. Vuoi salvare le modifiche?&quot;,QMessageBox.Ok | QMessageBox.Cancel))</span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># self.update_if(QMessageBox.warning(self, &#39;Error&#39;,</span>
                                                           <span class="c1"># &quot;Der Record wurde ge√§ndert. M√∂chtest du die √Ñnderungen speichern?&quot;,</span>
                                                           <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># self.update_if(QMessageBox.warning(self, &#39;Error&#39;,</span>
                                                           <span class="c1"># &quot;The record has been changed. Do you want to save the changes?&quot;,</span>
                                                           <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
                    <span class="c1"># self.empty_fields()</span>
                    <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
                    <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
                    <span class="c1"># self.enable_button(1)</span>
                    
                    <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Non √® stata realizzata alcuna modifica.&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Keine √Ñnderung vorgenommen&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;Warning&quot;, &quot;No changes have been made&quot;, QMessageBox.Ok)       </span>
        <span class="c1"># else:</span>
            <span class="c1"># if self.data_error_check() == 0:</span>
                <span class="c1"># test_insert = self.insert_new_rec()</span>
                <span class="c1"># if test_insert == 1:</span>
                    <span class="c1"># self.empty_fields()</span>
                    <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
                    <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
                    <span class="c1"># self.charge_records()</span>
                    <span class="c1"># self.charge_list()</span>
                    <span class="c1"># self.set_sito()</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), len(self.DATA_LIST) - 1</span>
                    <span class="c1"># self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_sito&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_area&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_unita_tipo&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_unita_tipo&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                    <span class="c1"># self.enable_button(1)</span>
            <span class="c1"># else:</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Problema nell&#39;inserimento dati&quot;, QMessageBox.Ok)</span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Problem der Dateneingabe&quot;, QMessageBox.Ok)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Warning&quot;, &quot;Problem with data entry&quot;, QMessageBox.Ok) </span>
    <span class="c1"># def on_pushButton_rapp_check_pressed(self):</span>
        <span class="c1"># sito_check = str(self.comboBox_sito_rappcheck.currentText())</span>
        <span class="c1"># area_check = str(self.comboBox_area_rappcheck.currentText())</span>
        <span class="c1"># try:</span>
            <span class="c1"># self.rapporti_stratigrafici_check(sito_check, area_check)</span>
            <span class="c1"># self.def_strati_to_rapporti_stratigrafici_check(sito_check, area_check)  # SPERIMENTALE</span>
        <span class="c1"># except Exception as e:</span>
            <span class="c1"># QMessageBox.warning(self, &quot;Initial Message&quot;, str(e), QMessageBox.Ok)</span>
        <span class="c1"># else:</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;,</span>
                                    <span class="c1"># &quot;Controllo Rapporti Stratigrafici. \n Controllo eseguito con successo&quot;, QMessageBox.Ok)</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;Pr√ºfen der stratigraphischen Beziehung.  Kontrolle erfolgereich&quot;, QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;Monitoring of stratigraphic relationships. \n Control performed successfully&quot;, QMessageBox.Ok)                     </span>
    
    <span class="c1"># def on_pushButton_h_check_pressed(self):</span>
        <span class="c1"># self.listWidget_rapp.clear()</span>
        <span class="c1"># sito_check = str(self.comboBox_sito.currentText())</span>
        <span class="c1"># area_check = str(self.comboBox_area.currentText())</span>
        <span class="c1"># try:</span>
            
            <span class="c1"># self.rapporti_stratigrafici_check(sito_check, area_check)</span>
            <span class="c1"># self.def_strati_to_rapporti_stratigrafici_check(sito_check, area_check)  # SPERIMENTALE</span>
            <span class="c1"># self.periodi_to_rapporti_stratigrafici_check(sito_check, area_check)</span>
            <span class="c1"># self.automaticform_check(sito_check, area_check)</span>
        <span class="c1"># except Exception as e:</span>
            <span class="c1"># self.listWidget_rapp.addItem(str(e))</span>
        <span class="c1"># else:</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># self.listWidget_rapp.addItem(&quot;Controllo Rapporti Stratigrafici.\nControllo eseguito con successo.&quot;)</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># Qself.listWidget_rapp.addItem(&quot;Pr√ºfen der stratigraphischen Beziehung.  Kontrolle erfolgereich&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.listWidget_rapp.addItem(&quot;Monitoring of stratigraphic relationships. \n Control performed successfully&quot;)  </span>
    
    
    <span class="c1"># def data_error_check(self):</span>
        <span class="c1"># test = 0</span>
        <span class="c1"># EC = Error_check()</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># if EC.data_is_empty(str(self.comboBox_sito.currentText())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Sito. \n Il campo non deve essere vuoto&quot;, QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># if EC.data_is_empty(str(self.comboBox_area.currentText())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Area. \n Il campo non deve essere vuoto&quot;, QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># if EC.data_is_empty(str(self.lineEdit_us.text())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo US. \n Il campo non deve essere vuoto&quot;, QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># if EC.data_is_empty(str(self.comboBox_unita_tipo.currentText())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Tipo US/USM. \n Il campo non deve essere vuoto&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># &quot;&quot;&quot;controllo campi numerici&quot;&quot;&quot;</span>
            <span class="c1"># area = self.comboBox_area.currentText()</span>
            <span class="c1"># us = self.lineEdit_us.text()</span>
            <span class="c1"># if area != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_int(area) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Area. \n Il valore deve essere di tipo numerico&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if us != &quot;&quot; :</span>
                <span class="c1"># if EC.data_is_int(us) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo US. \n Il valore deve essere di tipo numerico&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># &quot;&quot;&quot;controllo campi numerici float&quot;&quot;&quot;</span>
            <span class="c1"># #TAB USM</span>
            <span class="c1"># spessore_usm = self.lineEdit_spessore_usm.text()</span>
            <span class="c1"># qmin_usm = self.lineEdit_qmin_usm.text()</span>
            <span class="c1"># qmax_usm = self.lineEdit_qmax_usm.text()</span>
            <span class="c1"># lunghezza_usm = self.lineEdit_lunghezza_usm.text()</span>
            <span class="c1"># altezza_usm = self.lineEdit_altezza_usm.text()</span>
            <span class="c1"># #TAB MISURE</span>
            <span class="c1"># quota_abs = self.lineEdit_quota_abs.text()</span>
            <span class="c1"># quota_relativa = self.lineEdit_quota_relativa.text()</span>
            <span class="c1"># quota_max_abs = self.lineEdit_quota_max_abs.text()</span>
            <span class="c1"># quota_max_rel = self.lineEdit_quota_max_rel.text()</span>
            <span class="c1"># quota_min_abs = self.lineEdit_quota_min_abs.text()</span>
            <span class="c1"># quota_min_rel = self.lineEdit_quota_min_rel.text()</span>
            <span class="c1"># larghezza_media = self.lineEdit_larghezza_media.text()</span>
            <span class="c1"># lunghezza_max = self.lineEdit_lunghezza_max.text()</span>
            <span class="c1"># profondita_min = self.lineEdit_profondita_min.text()</span>
            <span class="c1"># profondita_max = self.lineEdit_profondita_max.text()</span>
            <span class="c1"># altezza_max = self.lineEdit_altezza_max.text()</span>
            <span class="c1"># altezza_min = self.lineEdit_altezza_min.text()</span>
            <span class="c1"># if spessore_usm != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(spessore_usm) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo USM-Spessore USM. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if qmin_usm != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(qmin_usm) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo USM 3-Quota minima USM. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if qmax_usm != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(qmax_usm) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo USM 3-Quota max USM. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if lunghezza_usm != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(lunghezza_usm) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo USM 3-Lunghezza USM. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if altezza_usm != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(altezza_usm) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo USM 3-Altezza USM. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># ###########################</span>
            <span class="c1"># if quota_abs != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(quota_abs) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Quota Assoluta. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if quota_relativa != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(quota_relativa) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Quota Relativa. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if quota_max_abs != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(quota_max_abs) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Quota Massima Assoluta. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if quota_max_rel != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(quota_max_rel) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Quota Massima Relativa. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if quota_min_abs != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(quota_min_abs) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Quota Minima Assoluta. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if quota_min_rel != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(quota_min_rel) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Quota Minima Relativa. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if larghezza_media != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(larghezza_media) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Larghezza Media. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if lunghezza_max != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(lunghezza_max) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Lunghezza Massima. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if profondita_min != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(profondita_min) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Profondit√† Minima. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if profondita_max != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(profondita_max) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Profondit√† Massima. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if altezza_max != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(altezza_max) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Spessore. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if altezza_min != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_float(altezza_min) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Spessore Minima. \n Il valore deve essere di tipo numerico. \n (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># &quot;&quot;&quot;controllo lunghezza campo alfanumerico&quot;&quot;&quot;</span>
            <span class="c1"># attivita = self.lineEdit_attivita.text()</span>
            <span class="c1"># colore = self.comboBox_colore.currentText()</span>
            <span class="c1"># anno_scavo = self.lineEdit_anno.text()</span>
            <span class="c1"># formazione = self.comboBox_formazione.currentText()</span>
            <span class="c1"># stato_conservazione = self.comboBox_conservazione.currentText()</span>
            <span class="c1"># colore = self.comboBox_colore.currentText()</span>
            <span class="c1"># consistenza = self.comboBox_consistenza.currentText()</span>
            <span class="c1"># struttura = self.comboBox_struttura.currentText()</span>
            <span class="c1"># cont_per = self.lineEdit_codice_periodo.text()</span>
            <span class="c1"># d_interpretativa=self.comboBox_def_intepret.currentText()</span>
            <span class="c1"># d_stratigrafica=self.comboBox_def_strat.currentText()</span>
            <span class="c1"># if attivita != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(attivita, 3) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;,</span>
                                        <span class="c1"># &quot;Campo Attivita. \n Il valore non deve superare i 4 caratteri alfanumerici&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># # if anno_scavo != &quot;&quot;:</span>
            <span class="c1"># # if EC.data_lenght(anno_scavo,3) == 0:</span>
            <span class="c1"># #       QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Anno. \n immettere una sola data (es. 2014)&quot;,  QMessageBox.Ok)</span>
            <span class="c1"># #       test = 1</span>
            
            <span class="c1"># if formazione != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(d_interpretativa, 254) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;,</span>
                                        <span class="c1"># &quot;Campo definizione interpreta. \n Il valore non deve superare i 255 caratteri alfanumerici&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            
            <span class="c1"># if formazione != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(d_stratigrafica, 254) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;,</span>
                                        <span class="c1"># &quot;Campo definizione stratigrafica. \n Il valore non deve superare i 255 caratteri alfanumerici&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            
            <span class="c1"># if formazione != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(formazione, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;,</span>
                                        <span class="c1"># &quot;Campo Formazione. \n Il valore non deve superare i 20 caratteri alfanumerici&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if stato_conservazione != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(stato_conservazione, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;,</span>
                                        <span class="c1"># &quot;Campo Conservazione. \n Il valore non deve superare i 20 caratteri alfanumerici&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if colore != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(colore, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;,</span>
                                        <span class="c1"># &quot;Campo Colore. \n Il valore non deve superare i 20 caratteri alfanumerici&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if consistenza != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(consistenza, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;,</span>
                                        <span class="c1"># &quot;Campo Consistenza. \n Il valore non deve superare i 20 caratteri alfanumerici&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if struttura != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(struttura, 29) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;,</span>
                                        <span class="c1"># &quot;Campo Struttura. \n Il valore non deve superare i 30 caratteri alfanumerici&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># if EC.data_is_empty(str(self.comboBox_sito.currentText())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot; Feld Ausgrabungst√§tte. \n Das Feld darf nicht leer sein&quot;, QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># if EC.data_is_empty(str(self.comboBox_area.currentText())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Feld Areal. \n Das Feld darf nicht leer sein&quot;, QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># if EC.data_is_empty(str(self.lineEdit_us.text())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Feld SE. \n Das Feld darf nicht leer sein&quot;, QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># if EC.data_is_empty(str(self.comboBox_unita_tipo.currentText())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Feld SE/MSE Typ. \n Das Feld darf nicht leer sein&quot;,   QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># area = self.comboBox_area.currentText()</span>
            <span class="c1"># us = self.lineEdit_us.text()</span>
            <span class="c1"># attivita = self.lineEdit_attivita.text()</span>
            <span class="c1"># colore = self.comboBox_colore.currentText()</span>
            <span class="c1"># anno_scavo = self.lineEdit_anno.text()</span>
            <span class="c1"># formazione = self.comboBox_formazione.currentText()</span>
            <span class="c1"># stato_conservazione = self.comboBox_conservazione.currentText()</span>
            <span class="c1"># colore = self.comboBox_colore.currentText()</span>
            <span class="c1"># consistenza = self.comboBox_consistenza.currentText()</span>
            <span class="c1"># struttura = self.comboBox_struttura.currentText()</span>
            <span class="c1"># cont_per = self.lineEdit_codice_periodo.text()</span>
            <span class="c1"># if area != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_int(area) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Feld Areal. \n Der Wert muss numerisch eingegeben werden&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if us != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_int(us) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Feld SE. \n Der Wert muss numerisch eingegeben werden&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if attivita != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(attivita, 3) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;,</span>
                                        <span class="c1"># &quot;Feld aktiviert. \n Der Wert darf nicht mehr als 4 alphanumerische Zeichen enthalten&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
                    <span class="c1"># # if anno_scavo != &quot;&quot;:</span>
            <span class="c1"># # if EC.data_lenght(anno_scavo,3) == 0:</span>
            <span class="c1"># #       QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Anno. \n immettere una sola data (es. 2014)&quot;,  QMessageBox.Ok)</span>
            <span class="c1"># #       test = 1</span>
            <span class="c1"># if formazione != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(formazione, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;,</span>
                                        <span class="c1"># &quot;Feld Bodenart. \n Der Wert darf nicht mehr als 20 alphanumerische Zeichen enthalten&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if stato_conservazione != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(stato_conservazione, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;,</span>
                                        <span class="c1"># &quot;Feld Erhaltungszustand.  Der Wert darf nicht mehr als 20 alphanumerische Zeichen enthalten&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if colore != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(colore, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;,</span>
                                        <span class="c1"># &quot;Feld Farbe. \n Der Wert darf nicht mehr als 20 alphanumerische Zeichen enthalten&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if consistenza != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(consistenza, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;,</span>
                                        <span class="c1"># &quot;Feld Konsistenz. \n Der Wert darf nicht mehr als 20 alphanumerische Zeichen enthalten&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if struttura != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(struttura, 29) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;,</span>
                                        <span class="c1"># &quot;Feld Struktur. \n Der Wert darf nicht mehr als 30 alphanumerische Zeichen enthalten&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
        <span class="c1"># else:   </span>
            <span class="c1"># if EC.data_is_empty(str(self.comboBox_sito.currentText())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;, &quot;Site Field. \n The field must not be empty&quot;, QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># if EC.data_is_empty(str(self.comboBox_area.currentText())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;, &quot;Area Field. \n The field must not be empty&quot;, QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># if EC.data_is_empty(str(self.lineEdit_us.text())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;, &quot;SU Field. \n The field must not be empty&quot;, QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># if EC.data_is_empty(str(self.comboBox_unita_tipo.currentText())) == 0:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;, &quot;SU-WSU Field. \n The field must not be empty&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
            <span class="c1"># area = self.comboBox_area.currentText()</span>
            <span class="c1"># us = self.lineEdit_us.text()</span>
            <span class="c1"># attivita = self.lineEdit_attivita.text()</span>
            <span class="c1"># colore = self.comboBox_colore.currentText()</span>
            <span class="c1"># anno_scavo = self.lineEdit_anno.text()</span>
            <span class="c1"># formazione = self.comboBox_formazione.currentText()</span>
            <span class="c1"># stato_conservazione = self.comboBox_conservazione.currentText()</span>
            <span class="c1"># colore = self.comboBox_colore.currentText()</span>
            <span class="c1"># consistenza = self.comboBox_consistenza.currentText()</span>
            <span class="c1"># struttura = self.comboBox_struttura.currentText()</span>
            <span class="c1"># cont_per = self.lineEdit_codice_periodo.text()</span>
            <span class="c1"># if area != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_int(area) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;, &quot;Area Field. \n The value must be numerical&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if us != &quot;&quot;:</span>
                <span class="c1"># if EC.data_is_int(us) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;, &quot;SU Field. \n The value must be numerical&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if attivita != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(attivita, 3) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;,</span>
                                        <span class="c1"># &quot;Activity Field. \n The value must not exceed 4 alphanumeric characters&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
                    <span class="c1"># # if anno_scavo != &quot;&quot;:</span>
            <span class="c1"># # if EC.data_lenght(anno_scavo,3) == 0:</span>
            <span class="c1"># #       QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Anno. \n immettere una sola data (es. 2014)&quot;,  QMessageBox.Ok)</span>
            <span class="c1"># #       test = 1</span>
            <span class="c1"># if formazione != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(formazione, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;,</span>
                                        <span class="c1"># &quot;Formation Field. \n The value must not exceed 20 alphanumeric characters&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if stato_conservazione != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(stato_conservazione, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;,</span>
                                        <span class="c1"># &quot;Conservation Field. \n The value must not exceed 20 alphanumeric characters&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if colore != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(colore, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;,</span>
                                        <span class="c1"># &quot;Color Field. \n The value must not exceed 20 alphanumeric characters&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if consistenza != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(consistenza, 19) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;,</span>
                                        <span class="c1"># &quot;Texture Field. \n The value must not exceed 20 alphanumeric characters&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
            <span class="c1"># if struttura != &quot;&quot;:</span>
                <span class="c1"># if EC.data_lenght(struttura, 29) == 0:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;,</span>
                                        <span class="c1"># &quot;Structure Field. \n The value must not exceed 20 alphanumeric characters&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok)</span>
                    <span class="c1"># test = 1</span>
                <span class="c1"># # if cont_per != &quot;&quot;:</span>
                <span class="c1"># #   if EC.data_lenght(cont_per,199) == 0:</span>
                <span class="c1"># #       QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo codice periodo. \n Il valore non deve superare i 200 caratteri numerici&quot;,  QMessageBox.Ok)</span>
                <span class="c1"># #       test = 1</span>
                <span class="c1"># # PERIODIZZAZIONE CHECK</span>
                <span class="c1"># # periodo iniz compilato e fase vuota  il blocco deve essere utilizzato meglio a partire dai signals</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># if self.comboBox_per_iniz.currentText() != &quot;&quot; and self.comboBox_fas_iniz.currentText() == &quot;&quot;:</span>
            <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Fase iniziale \n Specificare la Fase iniziale oltre al Periodo&quot;,  QMessageBox.Ok)</span>
            <span class="c1"># test = 1</span>
        <span class="c1"># if self.comboBox_per_fin.currentText()  != &quot;&quot; and self.comboBox_fas_fin.currentText() == &quot;&quot;:</span>
            <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Fase finale \n Specificare la Fase finale oltre al Periodo&quot;,  QMessageBox.Ok)</span>
            <span class="c1"># test = 1</span>
        <span class="c1"># if self.comboBox_per_iniz.currentText()  == &quot;&quot; and self.comboBox_fas_iniz.currentText() != &quot;&quot;:</span>
            <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Periodo iniziale \n Specificare un Periodo iniziale oltre alla Fase&quot;,  QMessageBox.Ok)</span>
            <span class="c1"># test = 1</span>
        <span class="c1"># if self.comboBox_per_fin.currentText()  == &quot;&quot; and self.comboBox_fas_fin.currentText() != &quot;&quot;:</span>
            <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Periodo iniziale \n Specificare un Periodo finale oltre alla Fase&quot;,  QMessageBox.Ok)</span>
            <span class="c1"># test = 1</span>
        <span class="c1"># if self.comboBox_per_fin.currentText()  != &quot;&quot; and self.comboBox_fas_fin.currentText() != &quot;&quot; and self.comboBox_per_iniz.currentText()  == &quot;&quot; and self.comboBox_fas_iniz.currentText() == &quot;&quot;:</span>
            <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campi Periodo e Fase iniziali \n Specificare un Periodo e Fase iniziali se si vuole inserire un Periodo e Fase finali&quot;,  QMessageBox.Ok)</span>
            <span class="c1"># test = 1</span>
        <span class="c1"># if self.comboBox_per_fin.currentText()  != &quot;&quot; and self.comboBox_fas_fin.currentText() != &quot;&quot; and self.comboBox_per_iniz.currentText()  == &quot;&quot; and self.comboBox_fas_iniz.currentText() == &quot;&quot;:</span>
            <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campi Periodo e Fase iniziali \n Specificare un Periodo e Fase iniziali se si vuole inserire un Periodo e Fase finali&quot;,  QMessageBox.Ok)</span>
            <span class="c1"># test = 1</span>
        <span class="c1"># if self.comboBox_per_iniz.currentText()  != &quot;&quot; and self.comboBox_fas_iniz.currentText() != &quot;&quot;:</span>
            <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;sito&#39;  : &quot;&#39;&quot;+str(self.comboBox_sito.currentText())+&quot;&#39;&quot;,</span>
            <span class="c1"># &#39;periodo&#39;  : &quot;&#39;&quot;+str(self.comboBox_per_iniz.currentText())+&quot;&#39;&quot;,</span>
            <span class="c1"># }</span>
            <span class="c1"># if  bool(self.DB_MANAGER.query_bool(search_dict, &#39;PERIODIZZAZIONE&#39;)) == False:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campi Periodo e Fase iniziali \n E&#39; stata inserita una periodizzazione inesistente&quot;,  QMessageBox.Ok)</span>
                <span class="c1"># test = 1</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># return test</span>
    
    <span class="c1"># def automaticform_check(self, sito_check, area_check):</span>
        
        <span class="c1"># search_dict = {&#39;sito&#39;: &quot;&#39;&quot; + str(sito_check) + &quot;&#39;&quot;, &#39;area&#39;: &quot;&#39;&quot; + str(area_check) + &quot;&#39;&quot;}</span>
        <span class="c1"># records = self.DB_MANAGER.query_bool(search_dict,</span>
                                             <span class="c1"># self.MAPPER_TABLE_CLASS)  # carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># report_rapporti3 = &#39;Report controllo e conteggio delle Schede create automatcamente - Sito: %s \n&#39; % (</span>
                <span class="c1"># sito_check)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># report_rapporti3 = &#39;Kontrollbericht Definition Stratigraphische zu Stratigraphische Berichte - Ausgrabungsst√§tte: %s \n&#39; % (</span>
                <span class="c1"># sito_check)</span>
        <span class="c1"># else:</span>
            <span class="c1"># report_rapporti3 = &#39;Control and count of forms automatically created - Site: %s \n&#39; % (</span>
                <span class="c1"># sito_check)     </span>
        <span class="c1"># for rec in range(len(records)):</span>
            <span class="c1"># sito = &quot;&#39;&quot; + str(records[rec].sito) + &quot;&#39;&quot;</span>
            <span class="c1"># area = &quot;&#39;&quot; + str(records[rec].area) + &quot;&#39;&quot;</span>
            <span class="c1"># us = int(records[rec].us)</span>
            <span class="c1"># def_stratigrafica = &quot;&#39;&quot; + str(records[rec].d_stratigrafica) + &quot;&#39;&quot;</span>
            <span class="c1"># rapporti = records[rec].rapporti  # caricati i rapporti nella variabile</span>
            <span class="c1"># rapporti = eval(def_stratigrafica)</span>
            <span class="c1"># #for sing_rapp in range(len(records)):  # itera sulla serie di rapporti</span>
            <span class="c1"># report3 = &quot;&quot;</span>

            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># if def_stratigrafica.find(&#39;SCHEDA CREATA IN AUTOMATICO&#39;)  &gt;=0:</span>


                    <span class="c1"># report3 = &#39;Sito: %s, Area: %s, US: %d - %s. Da rivedere &#39; % (</span>
                        <span class="c1"># sito, area, int(us), def_stratigrafica)</span>
            <span class="c1"># else:</span>
                <span class="c1"># if def_stratigrafica.find(&#39;FORM MADE AUTOMATIC&#39;) &gt;= 0:</span>


                    <span class="c1"># report3 = &#39;Sito: %s, Area: %s, US: %d - %s. Review it &#39; % (</span>
                        <span class="c1"># sito, area, int(us), def_stratigrafica)</span>
            <span class="c1"># if report3 != &quot;&quot;:</span>
                <span class="c1"># report_rapporti3 = report_rapporti3 + report3 + &#39;\n&#39; </span>
                <span class="c1"># # self.listWidget_rapp.item(0).setForeground(QtCore.Qt.blue)</span>
                <span class="c1"># # self.listWidget_rapp.item(1).setForeground(QtCore.Qt.blue)</span>
                <span class="c1"># #self.listWidget_rapp.clear() </span>
        <span class="c1"># self.listWidget_rapp.addItem(report_rapporti3)    </span>
        <span class="c1"># HOME = os.environ[&#39;PYARCHINIT_HOME&#39;]</span>
        <span class="c1"># report_path = &#39;{}{}{}&#39;.format(HOME, os.sep, &quot;pyarchinit_Report_folder&quot;)</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_schedeautomatiche.txt&#39;)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_def_strat_to_SE relation.txt&#39;)</span>
        <span class="c1"># elif self.L==&#39;en&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_strat_def_to_SU relation.txt&#39;) </span>
        <span class="c1"># f = open(filename, &quot;w&quot;)</span>
        <span class="c1"># f.write(report_rapporti3)</span>
        <span class="c1"># f.close()</span>
    
    <span class="c1"># def rapporti_stratigrafici_check(self, sito_check, area_check):</span>
        <span class="c1"># self.listWidget_rapp.clear()</span>
        <span class="c1"># conversion_dict = {&#39;Covers&#39;:&#39;Covered by&#39;,</span>
                           <span class="c1"># &#39;Covered by&#39;: &#39;Covers&#39;,</span>
                           <span class="c1"># &#39;Fills&#39;: &#39;Filled by&#39;,</span>
                           <span class="c1"># &#39;Filled by&#39;:&#39;Fills&#39;, </span>
                           <span class="c1"># &#39;Cuts&#39;: &#39;Cutted by&#39;,</span>
                           <span class="c1"># &#39;Cutted by&#39;: &#39;Cuts&#39;,</span>
                           <span class="c1"># &#39;Abuts&#39;: &#39;Supports&#39;,</span>
                           <span class="c1"># &#39;Supports&#39;: &#39;Abuts&#39;, </span>
                           <span class="c1"># &#39;Connected to&#39;: &#39;Connected to&#39;,</span>
                           <span class="c1"># &#39;Same as&#39;:&#39;Same as&#39;,</span>
                           <span class="c1"># &#39;Copre&#39;:&#39;Coperto da&#39;,</span>
                           <span class="c1"># &#39;Coperto da&#39;: &#39;Copre&#39;,</span>
                           <span class="c1"># &#39;Riempie&#39;: &#39;Riempito da&#39;,</span>
                           <span class="c1"># &#39;Riempito da&#39; : &#39;Riempie&#39;,</span>
                           <span class="c1"># &#39;Taglia&#39;: &#39;Tagliato da&#39;,</span>
                           <span class="c1"># &#39;Tagliato da&#39;: &#39;Taglia&#39;,</span>
                           <span class="c1"># &#39;Si appoggia a&#39;: &#39;Gli si appoggia&#39;,</span>
                           <span class="c1"># &#39;Gli si appoggia&#39;: &#39;Si appoggia a&#39;,</span>
                           <span class="c1"># &#39;Si lega a&#39;: &#39;Si lega a&#39;,</span>
                           <span class="c1"># &#39;Uguale a&#39;:&#39;Uguale a&#39;,</span>
                           <span class="c1"># &#39;Liegt √ºber&#39;:&#39;Liegt unter&#39;,</span>
                           <span class="c1"># &#39;Liegt unter&#39;:&#39;Liegt √ºber&#39;,</span>
                           <span class="c1"># &#39;Schneidet&#39;:&#39;Wird geschnitten&#39;,</span>
                           <span class="c1"># &#39;Wird geschnitten&#39;:&#39;Schneidet&#39;,</span>
                           <span class="c1"># &#39;Verf√ºllt&#39;:&#39;Wird verf√ºllt durch&#39;,</span>
                           <span class="c1"># &#39;Wird verf√ºllt durch&#39;:&#39;Verf√ºllt&#39;,</span>
                           <span class="c1"># &#39;St√ºtzt sich auf&#39;:&#39;Wird gest√ºzt von&#39;,</span>
                           <span class="c1"># &#39;Wird gest√ºzt von&#39;:&#39;St√ºtzt sich auf&#39;,</span>
                           <span class="c1"># &#39;Bindet an&#39;:&#39;Bindet an&#39;,</span>
                           <span class="c1"># &#39;Entspricht&#39;:&#39;Entspricht&#39;,</span>
                           <span class="c1"># &#39;&gt;&gt;&#39;:&#39;&lt;&lt;&#39;,</span>
                           <span class="c1"># &#39;&lt;&lt;&#39;:&#39;&gt;&gt;&#39;,</span>
                           <span class="c1"># &#39;&lt;&#39;:&#39;&gt;&#39;,</span>
                           <span class="c1"># &#39;&gt;&#39;:&#39;&lt;&#39;,</span>
                           <span class="c1"># &#39;&lt;-&gt;&#39;:&#39;&lt;-&gt;&#39;</span>
                           <span class="c1"># }</span>
        <span class="c1"># search_dict = {&#39;sito&#39;: &quot;&#39;&quot; + str(sito_check) + &quot;&#39;&quot;, &#39;area&#39;: &quot;&#39;&quot; + str(area_check) + &quot;&#39;&quot;}</span>
        <span class="c1"># records = self.DB_MANAGER.query_bool(search_dict,</span>
                                             <span class="c1"># self.MAPPER_TABLE_CLASS)  # carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># report_rapporti = &#39;Report controllo Rapporti Stratigrafici - Sito: %s \n&#39; % (sito_check)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># report_rapporti = &#39;Kontrollbericht Stratigraphische Beziehungen - Ausgrabungsst√§tte: %s \n&#39; % (sito_check)</span>
        <span class="c1"># else:</span>
            <span class="c1"># report_rapporti = &#39;Control report Stratigraphic relationships - Site: %s \n&#39; % (sito_check)   </span>
        <span class="c1"># for rec in range(len(records)):</span>
            <span class="c1"># sito = &quot;&#39;&quot; + str(records[rec].sito) + &quot;&#39;&quot;</span>
            <span class="c1"># area = &quot;&#39;&quot; + str(records[rec].area) + &quot;&#39;&quot;</span>
            <span class="c1"># us = int(records[rec].us)</span>
            <span class="c1"># rapporti = records[rec].rapporti  # caricati i rapporti nella variabile</span>
            <span class="c1"># rapporti = eval(rapporti)</span>
            <span class="c1"># report = &#39;&#39;</span>
            <span class="c1"># for sing_rapp in rapporti:  # itera sulla serie di rapporti</span>
                
                
                <span class="c1"># if str(us).find(&#39;0&#39;) or str(us).find(&#39;1&#39;) &gt;=0:</span>
                    <span class="c1"># if len(sing_rapp) == 2:</span>
                        
                        <span class="c1"># rapp_converted = conversion_dict[sing_rapp[0]]</span>
                        
                        <span class="c1"># serch_dict_rapp = {&#39;sito&#39;: sito, &#39;area&#39;: area, &#39;us&#39;: sing_rapp[1]}</span>
                        <span class="c1"># us_rapp = self.DB_MANAGER.query_bool(serch_dict_rapp, self.MAPPER_TABLE_CLASS)</span>
                        
                        <span class="c1"># if not bool(us_rapp):</span>
                            <span class="c1"># if self.L==&#39;it&#39;:</span>
                                <span class="c1"># report = &#39;Sito: %s, Area: %s, US: %d %s US: %d: Scheda US non esistente&#39; % (</span>
                                    <span class="c1"># sito, area, int(us), sing_rapp[0], int(sing_rapp[1]))</span>
                            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                                <span class="c1"># report = &#39;Ausgrabungsst√§tte: %s, Areal: %s, SE: %d %s SE: %d: SE formular nicht existent&#39; % (</span>
                                    <span class="c1"># sito, area, int(us), sing_rapp[0], int(sing_rapp[1]))</span>
                            <span class="c1"># else:</span>
                                <span class="c1"># report = &#39;Site: %s, Area: %s, SU: %d %s SU: %d: SU form not-existent&#39; % (</span>
                                    <span class="c1"># sito, area, int(us), sing_rapp[0], int(sing_rapp[1]))       </span>
                            <span class="c1"># # new system rapp_check</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># rapporti_check = eval(us_rapp[0].rapporti)</span>
                            
                            <span class="c1"># us_rapp_check=(&#39;%s&#39;) % str(us)</span>
                            
                            <span class="c1"># if rapporti_check.count([rapp_converted, us_rapp_check]) == 1:</span>
                                <span class="c1"># report = &quot;&quot;</span>
                            <span class="c1"># else:</span>
                                <span class="c1"># if self.L==&#39;it&#39;:</span>
                                    <span class="c1"># report = &#39;Sito: %s, Area: %s, US: %d %s US: %d: Rapporto non verificato&#39; % (</span>
                                        <span class="c1"># sito, area, int(us), sing_rapp[0], int(sing_rapp[1]))</span>
                                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                                    <span class="c1"># report = &#39;Ausgrabungsst√§tte: %s, Areal: %s, SE: %d %s SE: %d: nicht gepr√ºfter Bericht&#39; % (</span>
                                        <span class="c1"># sito, area, int(us), sing_rapp[0], int(sing_rapp[1]))</span>
                                <span class="c1"># else:</span>
                                    <span class="c1"># report = &#39;Site: %s, Area: %s, SU: %d %s SU: %d: relashionships not verified&#39; % (</span>
                                        <span class="c1"># sito, area, int(us), sing_rapp[0], int(sing_rapp[1]))       </span>
                        
                <span class="c1"># if report != &quot;&quot;:</span>
                    <span class="c1"># report_rapporti = report_rapporti + report + &#39;\n&#39;</span>
                   
        <span class="c1"># self.listWidget_rapp.addItem(report_rapporti)</span>
            
            <span class="c1"># # self.progressBar_3.setHidden(False)</span>
            <span class="c1"># # value = (float(rec)/float(len(records)))*100</span>
            <span class="c1"># # self.progressBar_3.setValue(value)</span>
            <span class="c1"># # QApplication.processEvents()</span>
        <span class="c1"># # self.progressBar_3.reset()           </span>
        
        <span class="c1"># HOME = os.environ[&#39;PYARCHINIT_HOME&#39;]</span>
        <span class="c1"># report_path = &#39;{}{}{}&#39;.format(HOME, os.sep, &quot;pyarchinit_Report_folder&quot;)</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_rapporti_US.txt&#39;)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_SE.txt&#39;)</span>
        <span class="c1"># else:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_SU_relations.txt&#39;)     </span>
        <span class="c1"># f = open(filename, &quot;w&quot;)</span>
        <span class="c1"># f.write(report_rapporti)</span>
        <span class="c1"># f.close()</span>
    <span class="c1"># def def_strati_to_rapporti_stratigrafici_check(self, sito_check, area_check):</span>
        <span class="c1"># conversion_dict = {&#39;Covers&#39;:&#39;Covered by&#39;,</span>
                           <span class="c1"># &#39;Covered by&#39;: &#39;Covers&#39;,</span>
                           <span class="c1"># &#39;Fills&#39;: &#39;Filled by&#39;,</span>
                           <span class="c1"># &#39;Filled by&#39;:&#39;Fills&#39;, </span>
                           <span class="c1"># &#39;Cuts&#39;: &#39;Cutted by&#39;,</span>
                           <span class="c1"># &#39;Cutted by&#39;: &#39;Cuts&#39;,</span>
                           <span class="c1"># &#39;Abuts&#39;: &#39;Supports&#39;,</span>
                           <span class="c1"># &#39;Supports&#39;: &#39;Abuts&#39;, </span>
                           <span class="c1"># &#39;Connected to&#39;: &#39;Connected to&#39;,</span>
                           <span class="c1"># &#39;Same as&#39;:&#39;Same as&#39;,</span>
                           <span class="c1"># &#39;Copre&#39;:&#39;Coperto da&#39;,</span>
                           <span class="c1"># &#39;Coperto da&#39;: &#39;Copre&#39;,</span>
                           <span class="c1"># &#39;Riempie&#39;: &#39;Riempito da&#39;,</span>
                           <span class="c1"># &#39;Riempito da&#39; : &#39;Riempie&#39;,</span>
                           <span class="c1"># &#39;Taglia&#39;: &#39;Tagliato da&#39;,</span>
                           <span class="c1"># &#39;Tagliato da&#39;: &#39;Taglia&#39;,</span>
                           <span class="c1"># &#39;Si appoggia a&#39;: &#39;Gli si appoggia&#39;,</span>
                           <span class="c1"># &#39;Gli si appoggia&#39;: &#39;Si appoggia a&#39;,</span>
                           <span class="c1"># &#39;Si lega a&#39;: &#39;Si lega a&#39;,</span>
                           <span class="c1"># &#39;Uguale a&#39;:&#39;Uguale a&#39;,</span>
                           <span class="c1"># &#39;Liegt √ºber&#39;:&#39;Liegt unter&#39;,</span>
                           <span class="c1"># &#39;Liegt unter&#39;:&#39;Liegt √ºber&#39;,</span>
                           <span class="c1"># &#39;Schneidet&#39;:&#39;Wird geschnitten&#39;,</span>
                           <span class="c1"># &#39;Wird geschnitten&#39;:&#39;Schneidet&#39;,</span>
                           <span class="c1"># &#39;Verf√ºllt&#39;:&#39;Wird verf√ºllt durch&#39;,</span>
                           <span class="c1"># &#39;Wird verf√ºllt durch&#39;:&#39;Verf√ºllt&#39;,</span>
                           <span class="c1"># &#39;St√ºtzt sich auf&#39;:&#39;Wird gest√ºzt von&#39;,</span>
                           <span class="c1"># &#39;Wird gest√ºzt von&#39;:&#39;St√ºtzt sich auf&#39;,</span>
                           <span class="c1"># &#39;Bindet an&#39;:&#39;Bindet an&#39;,</span>
                           <span class="c1"># &#39;Entspricht&#39;:&#39;Entspricht&#39;,</span>
                           <span class="c1"># &#39;&gt;&gt;&#39;:&#39;&lt;&lt;&#39;,</span>
                           <span class="c1"># &#39;&lt;&lt;&#39;:&#39;&gt;&gt;&#39;,</span>
                           <span class="c1"># &#39;&lt;&#39;:&#39;&gt;&#39;,</span>
                           <span class="c1"># &#39;&gt;&#39;:&#39;&lt;&#39;,</span>
                           <span class="c1"># &#39;&lt;-&gt;&#39;:&#39;&lt;-&gt;&#39;</span>
                           <span class="c1"># }</span>
        <span class="c1"># search_dict = {&#39;sito&#39;: &quot;&#39;&quot; + str(sito_check) + &quot;&#39;&quot;, &#39;area&#39;: &quot;&#39;&quot; + str(area_check) + &quot;&#39;&quot;}</span>
        <span class="c1"># records = self.DB_MANAGER.query_bool(search_dict,</span>
                                             <span class="c1"># self.MAPPER_TABLE_CLASS)  # carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># report_rapporti1 = &#39;Report controllo Definizione Stratigrafica a Rapporti Stratigrafici - Sito: %s \n&#39; % (</span>
                <span class="c1"># sito_check)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># report_rapporti1 = &#39;Kontrollbericht Definition Stratigraphische zu Stratigraphische Berichte - Ausgrabungsst√§tte: %s \n&#39; % (</span>
                <span class="c1"># sito_check)</span>
        <span class="c1"># else:</span>
            <span class="c1"># report_rapporti1 = &#39;Control report Definition Stratigraphic to Stratigraphic Reports - Site: %s \n&#39; % (</span>
                <span class="c1"># sito_check)     </span>
        <span class="c1"># for rec in range(len(records)):</span>
            <span class="c1"># sito = &quot;&#39;&quot; + str(records[rec].sito) + &quot;&#39;&quot;</span>
            <span class="c1"># area = &quot;&#39;&quot; + str(records[rec].area) + &quot;&#39;&quot;</span>
            <span class="c1"># us = int(records[rec].us)</span>
            <span class="c1"># def_stratigrafica = &quot;&#39;&quot; + str(records[rec].d_stratigrafica) + &quot;&#39;&quot;</span>
            <span class="c1"># rapporti = records[rec].rapporti  # caricati i rapporti nella variabile</span>
            <span class="c1"># rapporti = eval(rapporti)</span>
            
           
            <span class="c1"># for sing_rapp in rapporti:  # itera sulla serie di rapporti</span>
                <span class="c1"># report = &quot;&quot;</span>
                <span class="c1"># if def_stratigrafica.find(&#39;Strato&#39;) &gt;= 0:  # Paradosso strati che tagliano o si legano</span>
                    <span class="c1"># if sing_rapp[0] == &#39;Si lega a&#39;:</span>
                        <span class="c1"># report = &#39;Sito: %s, Area: %s, US: %d - %s: lo strato %s US: %d: &#39; % (</span>
                            <span class="c1"># sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="c1"># if def_stratigrafica.find(&#39;Riempimento&#39;) &gt;= 0:  # Paradosso riempimentiche tagliano o si legano</span>
                    <span class="c1"># if sing_rapp[0] == &#39;Taglia&#39; or sing_rapp[0] == &#39;Si lega a&#39;or sing_rapp[0] == &#39;Si appoggia a&#39; or sing_rapp[0] == &#39;Gli si appoggia&#39; or sing_rapp[0] == &#39;Taglia&#39;:</span>
                        <span class="c1"># report = &#39;Sito: %s, Area: %s, US: %d - %s: lo strato %s US: %d: &#39; % (</span>
                            <span class="c1"># sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="c1"># if def_stratigrafica.find(&#39;Taglio&#39;) &gt;= 0:  # Paradosso riempimentiche tagliano o si legano</span>
                    <span class="c1"># if sing_rapp[0] == &#39;Riempie&#39; or sing_rapp[0] == &#39;Si lega a&#39; or sing_rapp[0] == &#39;Si appoggia a&#39;  or sing_rapp[0] == &#39;Gli si appoggia&#39;:</span>
                        <span class="c1"># report = &#39;Sito: %s, Area: %s, US: %d - %s: lo strato %s US: %d: &#39; % (</span>
                            <span class="c1"># sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="c1"># if report != &quot;&quot;:</span>
                    <span class="c1"># report_rapporti1 = report_rapporti1 + report + &#39;\n&#39;</span>
                <span class="c1"># #versione inglese</span>
                <span class="c1"># elif def_stratigrafica.find(&#39;Stra&#39;) &gt;= 0:  # Paradosso strati che tagliano o si legano</span>
                    <span class="c1"># if sing_rapp[0] == &#39;Connected to&#39;:</span>
                        <span class="c1"># report = &#39;Site: %s, Area: %s, SU: %d - %s: the stratum %s SU: %d: &#39; % (</span>
                            <span class="c1"># sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="c1"># if def_stratigrafica.find(&#39;Fills&#39;) &gt;= 0:  # Paradosso riempimentiche tagliano o si legano</span>
                    <span class="c1"># if sing_rapp[0] == &#39;Cuts&#39; or sing_rapp[0] == &#39;Connected to&#39;:</span>
                        <span class="c1"># report = &#39;Site: %s, Area: %s, SU: %d - %s: the startum %s SU: %d: &#39; % (</span>
                            <span class="c1"># sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="c1"># # if def_stratigrafica.find(&#39;Filling&#39;) &gt;= 0:  # Paradosso riempimentiche tagliano o si legano</span>
                    <span class="c1"># # if sing_rapp[0] == &#39;Cuts&#39; or sing_rapp[0] == &#39;Connected to&#39;:</span>
                        <span class="c1"># # report = &#39;Site: %s, Area: %s, SU: %d - %s: the stratum %s SU: %d: &#39; % (</span>
                            <span class="c1"># # sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="c1"># if report != &quot;&quot;:</span>
                    <span class="c1"># report_rapporti1 = report_rapporti1 + report + &#39;\n&#39;</span>
                <span class="c1"># #versione tedesca   </span>
                <span class="c1"># elif def_stratigrafica.find(&#39;Stratum&#39;) &gt;= 0:  # Paradosso strati che tagliano o si legano</span>
                    <span class="c1"># if sing_rapp[0] == &#39;Bindet an&#39;:</span>
                        <span class="c1"># report = &#39;Sito: %s, Area: %s, SE: %d - %s: die startum %s US: %d: &#39; % (</span>
                            <span class="c1"># sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="c1"># if def_stratigrafica.find(&#39;Verfull√ºng&#39;) &gt;= 0:  # Paradosso riempimentiche tagliano o si legano</span>
                    <span class="c1"># if sing_rapp[0] == &#39;Schneidet&#39; or sing_rapp[0] == &#39;Bindet an&#39;:</span>
                        <span class="c1"># report = &#39;Sito: %s, Area: %s, SE: %d - %s: die stratum %s US: %d: &#39; % (</span>
                            <span class="c1"># sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="c1"># # if def_stratigrafica.find(&#39;Verfull√ºng&#39;) &gt;= 0:  # Paradosso riempimentiche tagliano o si legano</span>
                    <span class="c1"># # if sing_rapp[0] == &#39;Schneidet&#39; or sing_rapp[0] == &#39;Bindet an&#39;:</span>
                        <span class="c1"># # report = &#39;Sito: %s, Area: %s, SE: %d - %s: die startum %s US: %d: &#39; % (</span>
                            <span class="c1"># # sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="c1"># if report != &quot;&quot;:</span>
                    <span class="c1"># report_rapporti1 = report_rapporti1 + report + &#39;\n&#39; </span>
                
        <span class="c1"># self.listWidget_rapp.addItem(report_rapporti1)    </span>
             
        <span class="c1"># HOME = os.environ[&#39;PYARCHINIT_HOME&#39;]</span>
        <span class="c1"># report_path = &#39;{}{}{}&#39;.format(HOME, os.sep, &quot;pyarchinit_Report_folder&quot;)</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_def_strat_a_rapporti_US.txt&#39;)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_def_strat_to_SE relation.txt&#39;)</span>
        <span class="c1"># elif self.L==&#39;en&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_strat_def_to_SU relation.txt&#39;) </span>
        <span class="c1"># f = open(filename, &quot;w&quot;)</span>
        <span class="c1"># f.write(report_rapporti1)</span>
        <span class="c1"># f.close()</span>
    
    <span class="c1"># def concat(self,a, b):</span>
        <span class="c1"># return eval(f&quot;{a}{b}&quot;)</span>
    
    <span class="c1"># def periodi_to_rapporti_stratigrafici_check(self, sito_check, area_check):</span>
        <span class="c1"># conversion_dict = {&#39;Covers&#39;:&#39;Covered by&#39;,</span>
                           <span class="c1"># &#39;Covered by&#39;: &#39;Covers&#39;,</span>
                           <span class="c1"># &#39;Fills&#39;: &#39;Filled by&#39;,</span>
                           <span class="c1"># &#39;Filled by&#39;:&#39;Fills&#39;, </span>
                           <span class="c1"># &#39;Cuts&#39;: &#39;Cutted by&#39;,</span>
                           <span class="c1"># &#39;Cutted by&#39;: &#39;Cuts&#39;,</span>
                           <span class="c1"># &#39;Abuts&#39;: &#39;Supports&#39;,</span>
                           <span class="c1"># &#39;Supports&#39;: &#39;Abuts&#39;, </span>
                           <span class="c1"># &#39;Connected to&#39;: &#39;Connected to&#39;,</span>
                           <span class="c1"># &#39;Same as&#39;:&#39;Same as&#39;,</span>
                           <span class="c1"># &#39;Copre&#39;:&#39;Coperto da&#39;,</span>
                           <span class="c1"># &#39;Coperto da&#39;: &#39;Copre&#39;,</span>
                           <span class="c1"># &#39;Riempie&#39;: &#39;Riempito da&#39;,</span>
                           <span class="c1"># &#39;Riempito da&#39; : &#39;Riempie&#39;,</span>
                           <span class="c1"># &#39;Taglia&#39;: &#39;Tagliato da&#39;,</span>
                           <span class="c1"># &#39;Tagliato da&#39;: &#39;Taglia&#39;,</span>
                           <span class="c1"># &#39;Si appoggia a&#39;: &#39;Gli si appoggia&#39;,</span>
                           <span class="c1"># &#39;Gli si appoggia&#39;: &#39;Si appoggia a&#39;,</span>
                           <span class="c1"># &#39;Si lega a&#39;: &#39;Si lega a&#39;,</span>
                           <span class="c1"># &#39;Uguale a&#39;:&#39;Uguale a&#39;,</span>
                           <span class="c1"># &#39;Liegt √ºber&#39;:&#39;Liegt unter&#39;,</span>
                           <span class="c1"># &#39;Liegt unter&#39;:&#39;Liegt √ºber&#39;,</span>
                           <span class="c1"># &#39;Schneidet&#39;:&#39;Wird geschnitten&#39;,</span>
                           <span class="c1"># &#39;Wird geschnitten&#39;:&#39;Schneidet&#39;,</span>
                           <span class="c1"># &#39;Verf√ºllt&#39;:&#39;Wird verf√ºllt durch&#39;,</span>
                           <span class="c1"># &#39;Wird verf√ºllt durch&#39;:&#39;Verf√ºllt&#39;,</span>
                           <span class="c1"># &#39;St√ºtzt sich auf&#39;:&#39;Wird gest√ºzt von&#39;,</span>
                           <span class="c1"># &#39;Wird gest√ºzt von&#39;:&#39;St√ºtzt sich auf&#39;,</span>
                           <span class="c1"># &#39;Bindet an&#39;:&#39;Bindet an&#39;,</span>
                           <span class="c1"># &#39;Entspricht&#39;:&#39;Entspricht&#39;,</span>
                           <span class="c1"># &#39;&gt;&gt;&#39;:&#39;&lt;&lt;&#39;,</span>
                           <span class="c1"># &#39;&lt;&lt;&#39;:&#39;&gt;&gt;&#39;,</span>
                           <span class="c1"># &#39;&lt;&#39;:&#39;&gt;&#39;,</span>
                           <span class="c1"># &#39;&gt;&#39;:&#39;&lt;&#39;,</span>
                           <span class="c1"># &#39;&lt;-&gt;&#39;:&#39;&lt;-&gt;&#39;</span>
                           <span class="c1"># }</span>
        <span class="c1"># search_dict = {&#39;sito&#39;: &quot;&#39;&quot; + str(sito_check) + &quot;&#39;&quot;, &#39;area&#39;: &quot;&#39;&quot; + str(area_check) + &quot;&#39;&quot;}</span>
        <span class="c1"># records = self.DB_MANAGER.query_bool(search_dict,</span>
                                             <span class="c1"># self.MAPPER_TABLE_CLASS)  # carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># report_rapporti2 = &#39;Report controllo Periodi/Unit√† Tipo a Rapporti Stratigrafici - Sito: %s \n&#39; % (</span>
                <span class="c1"># sito_check)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># report_rapporti2 = &#39;Kontrollbericht Periodization/Type Unit zu Stratigraphische Berichte - Ausgrabungsst√§tte: %s \n&#39; % (</span>
                <span class="c1"># sito_check)</span>
        <span class="c1"># else:</span>
            <span class="c1"># report_rapporti2 = &#39;Control report Periodization/Type Unit to Stratigraphic Reports - Site: %s \n&#39; % (</span>
                <span class="c1"># sito_check)     </span>
        <span class="c1"># for rec in range(len(records)):</span>
            <span class="c1"># sito = &quot;&#39;&quot; + str(records[rec].sito) + &quot;&#39;&quot;</span>
            <span class="c1"># area = &quot;&#39;&quot; + str(records[rec].area) + &quot;&#39;&quot;</span>
            <span class="c1"># us = int(records[rec].us)</span>
            <span class="c1"># periodo_in = str(records[rec].periodo_iniziale)</span>
            <span class="c1"># fase_in = str(records[rec].fase_iniziale)</span>
            <span class="c1"># periodo_fin =  str(records[rec].periodo_finale) </span>
            <span class="c1"># fase_fin =  str(records[rec].fase_iniziale) </span>
            <span class="c1"># ut=str(records[rec].unita_tipo)</span>
            <span class="c1"># rapporti = records[rec].rapporti  # caricati i rapporti nella variabile</span>
            <span class="c1"># rapporti = eval(rapporti)</span>
            <span class="c1"># rapporti2 = records[rec].rapporti2  # caricati i rapporti nella variabile</span>
            <span class="c1"># rapporti2 = eval(rapporti2)</span>
            
            
            <span class="c1"># for sing_rapp in rapporti2:  # itera sulla serie di rapporti</span>
                <span class="c1"># report = &quot;&quot;</span>
                <span class="c1"># report2 = &quot;&quot;</span>
                
                <span class="c1"># # rapp_sing=sing_rapp[4].split()</span>
                <span class="c1"># # QMessageBox.information(self,&#39;&#39;,str(rapp_sing))</span>
                <span class="c1"># if str(periodo_in).find(&#39;1&#39;) or str(periodo_in).find(&#39;2&#39;) or str(periodo_in).find(&#39;3&#39;) or str(periodo_in).find(&#39;4&#39;) or str(periodo_in).find(&#39;5&#39;) or str(periodo_in).find(&#39;6&#39;) or str(periodo_in).find(&#39;7&#39;) or str(periodo_in).find(&#39;8&#39;) or str(periodo_in).find(&#39;9&#39;) or str(periodo_in).find(&#39;10&#39;) or str(periodo_in).find(&#39;11&#39;) or str(periodo_in).find(&#39;12&#39;) or str(periodo_in).find(&#39;13&#39;) or str(periodo_in).find(&#39;14&#39;) or str(periodo_in).find(&#39;15&#39;)&gt;=0:</span>
                    
                    <span class="c1"># if str(periodo_in)+&#39;-&#39;+str(fase_in)!=sing_rapp[4]:</span>
                        <span class="c1"># if sing_rapp[0] == &#39;Si lega a&#39; or sing_rapp[0] == &#39;Uguale a&#39; or sing_rapp[0] == &#39;Same as&#39; or sing_rapp[0] == &#39;Connected to&#39;:</span>
                            <span class="c1"># report = &#39;Sito: %s, Area: %s, %s: %d -  Il periodo e fase iniziale %s: deve essere: %s corrispondente con la %s : %d: &#39; % (</span>
                                <span class="c1"># sito, area, ut, int(us), str(periodo_in)+&#39;-&#39;+str(fase_in), sing_rapp[0], sing_rapp[2], int(sing_rapp[1]))</span>
                    
                    <span class="c1"># # if not bool(sing_rapp):</span>
                        <span class="c1"># # report2:&#39;la table widget deve essere riempita&#39; </span>
                    <span class="c1"># if sing_rapp[0] == &#39;Si lega a&#39; and sing_rapp[2]==&#39;US&#39;:</span>
                    
                        <span class="c1"># report2 = &#39;%s : %d - %s : %d: devono essere USM&#39; % (</span>
                            <span class="c1"># ut, int(us), sing_rapp[2], int(sing_rapp[1]))</span>
                    
                    <span class="c1"># if sing_rapp[0] == &#39;Connected to&#39; and sing_rapp[2]==&#39;SU&#39;:</span>
                    
                        <span class="c1"># report2 = &#39;%s : %d - %s : %d: should be WSU&#39; % (</span>
                            <span class="c1"># ut, int(us), sing_rapp[2], int(sing_rapp[1]))</span>
                    
                    <span class="c1"># if sing_rapp[0] == &#39;Uguale a&#39; and sing_rapp[2]==&#39;USM&#39;:</span>
                    
                        <span class="c1"># report2 = &#39;%s : %d - %s : %d: devono essere US&#39; % (</span>
                            <span class="c1"># ut, int(us), sing_rapp[2], int(sing_rapp[1]))</span>
            
                    <span class="c1"># if sing_rapp[0] == &#39;Same as&#39; and sing_rapp[2]==&#39;WSU&#39;:</span>
                    
                        <span class="c1"># report2 = &#39;%s : %d - %s : %d: should be SU&#39; % (</span>
                            <span class="c1"># ut, int(us), sing_rapp[2], int(sing_rapp[1]))</span>
                    
                    <span class="c1"># if sing_rapp[0] == &#39;Si appoggia a&#39; and sing_rapp[2]==&#39;US&#39;:</span>
                    
                        <span class="c1"># report2 = &#39;%s : %d - %s : %d: devono essere USM&#39; % (</span>
                            <span class="c1"># ut, int(us), sing_rapp[2], int(sing_rapp[1]))</span>
                            
                    <span class="c1"># if sing_rapp[0] == &#39;Gli si appoggia&#39; and sing_rapp[2]==&#39;US&#39;:</span>
                    
                        <span class="c1"># report2 = &#39;%s : %d - %s : %d: devono essere USM&#39; % (</span>
                            <span class="c1"># ut, int(us), sing_rapp[2], int(sing_rapp[1]))</span>
                
                    <span class="c1"># if sing_rapp[0] == &#39;Abuts&#39; and sing_rapp[2]==&#39;SU&#39;:</span>
                    
                        <span class="c1"># report2 = &#39;%s : %d - %s : %d: should be WSU&#39; % (</span>
                            <span class="c1"># ut, int(us), sing_rapp[2], int(sing_rapp[1]))</span>
                            
                    <span class="c1"># if sing_rapp[0] == &#39;Supports&#39; and sing_rapp[2]==&#39;SU&#39;:</span>
                    
                        <span class="c1"># report2 = &#39;%s : %d - %s : %d: should be WSU&#39; % (</span>
                            <span class="c1"># ut, int(us), sing_rapp[2], int(sing_rapp[1]))</span>
                
                    <span class="c1"># if sing_rapp[4]!=&#39;-&#39;:</span>
                    
                        <span class="c1"># if sing_rapp[0] == &#39;Covers&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&lt;self.concat(int(periodo_in),int(fase_in)):</span>
                            
                            <span class="c1"># report2 = &#39;%s : %d : %s- should be Covered by %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1],  str(periodo_in),str(fase_in))</span>
                                
                        <span class="c1"># if sing_rapp[0] == &#39;Covered by&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&gt;self.concat(int(periodo_in),int(fase_in)):</span>
                        
                            <span class="c1"># report2 = &#39;%s : %d : %s- should be Covers %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1], str(periodo_in),str(fase_in))</span>
                    
                        <span class="c1"># if sing_rapp[0] == &#39;Fills&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&lt;self.concat(int(periodo_in),int(fase_in)):</span>
                            
                            <span class="c1"># report2 = &#39;%s : %d : %s- Should be Filled by %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1],  str(periodo_in),str(fase_in))</span>
                                
                        <span class="c1"># if sing_rapp[0] == &#39;Filled by&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&gt;self.concat(int(periodo_in),int(fase_in)):</span>
                        
                            <span class="c1"># report2 = &#39;%s : %d : %s- Shuld be Fills %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1], str(periodo_in),str(fase_in))</span>
                    
                        <span class="c1"># if sing_rapp[0] == &#39;Cuts&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&lt;self.concat(int(periodo_in),int(fase_in)):</span>
                            
                            <span class="c1"># report2 = &#39;%s : %d : %s- Shuld be Cutted by %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1],  str(periodo_in),str(fase_in))</span>
                                
                        <span class="c1"># if sing_rapp[0] == &#39;Cutted by&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&gt;self.concat(int(periodo_in),int(fase_in)):</span>
                        
                            <span class="c1"># report2 = &#39;%s : %d : %s- Shuld be Cuts %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1], str(periodo_in),str(fase_in))</span>
                        
                        <span class="c1"># if sing_rapp[0] == &#39;Abuts&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&lt;self.concat(int(periodo_in),int(fase_in)):</span>
                            
                            <span class="c1"># report2 = &#39;%s : %d : %s- Shuld be Supports %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1],  str(periodo_in),str(fase_in))</span>
                                
                        <span class="c1"># if sing_rapp[0] == &#39;Supports&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&gt;self.concat(int(periodo_in),int(fase_in)):</span>
                        
                            <span class="c1"># report2 = &#39;%s : %d : %s- Shuld be Abuts %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1], str(periodo_in),str(fase_in))</span>
                                          
                        <span class="c1"># if sing_rapp[0] == &#39;Copre&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&lt;self.concat(int(periodo_in),int(fase_in)):</span>
                            
                            <span class="c1"># report2 = &#39;%s : %d : %s- Dovrebbe essere Coperto da %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1],  str(periodo_in),str(fase_in))</span>
                                
                        <span class="c1"># if sing_rapp[0] == &#39;Coperto da&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&gt;self.concat(int(periodo_in),int(fase_in)):</span>
                        
                            <span class="c1"># report2 = &#39;%s : %d : %s- Dovrebbe Coprire %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1], str(periodo_in),str(fase_in))</span>
                    
                        <span class="c1"># if sing_rapp[0] == &#39;Riempie&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&lt;self.concat(int(periodo_in),int(fase_in)):</span>
                            
                            <span class="c1"># report2 = &#39;%s : %d : %s- Dovrebbe essere Riempito da %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1],  str(periodo_in),str(fase_in))</span>
                                
                        <span class="c1"># if sing_rapp[0] == &#39;Riempito da&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&gt;self.concat(int(periodo_in),int(fase_in)):</span>
                        
                            <span class="c1"># report2 = &#39;%s : %d : %s- Dovrebbe Riempire %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1], str(periodo_in),str(fase_in))</span>
                    
                        <span class="c1"># if sing_rapp[0] == &#39;Taglia&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&lt;self.concat(int(periodo_in),int(fase_in)):</span>
                            
                            <span class="c1"># report2 = &#39;%s : %d : %s- Dovrebbe essere Tagliato da %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1],  str(periodo_in),str(fase_in))</span>
                                
                        <span class="c1"># if sing_rapp[0] == &#39;Tagliato da&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&gt;self.concat(int(periodo_in),int(fase_in)):</span>
                        
                            <span class="c1"># report2 = &#39;%s : %d : %s- Dovrebbe Tagliare %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1], str(periodo_in),str(fase_in))</span>
                    
                        <span class="c1"># if sing_rapp[0] == &#39;Si appoggia a&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&lt;self.concat(int(periodo_in),int(fase_in)):</span>
                            
                            <span class="c1"># report2 = &#39;%s : %d : %s- Dovrebbe essere Gli si appoggia %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1],  str(periodo_in),str(fase_in))</span>
                                
                        <span class="c1"># if sing_rapp[0] == &#39;Gli si appoggia&#39; and int(sing_rapp[4].replace(&#39;-&#39;,&#39;&#39;))&gt;self.concat(int(periodo_in),int(fase_in)):</span>
                        
                            <span class="c1"># report2 = &#39;%s : %d : %s- Dovrebbe Si appoggia a %s : %s-%s&#39; % (</span>
                                <span class="c1"># ut, int(us),str(sing_rapp[4]), sing_rapp[1], str(periodo_in),str(fase_in))</span>
                    <span class="c1"># if sing_rapp[4]==&#39;-&#39;:</span>
                        <span class="c1"># if self.L==&#39;it&#39;:</span>
                            <span class="c1"># report2 = &#39;Manca la peridizzazione in %s %s&#39;% (sing_rapp[2], sing_rapp[1])</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># report2 = &#39;Missing the periodization in %s %s&#39;% (sing_rapp[2], sing_rapp[1])</span>
                
                
                
                <span class="c1"># if report2 != &quot;&quot;:</span>
                    <span class="c1"># report_rapporti2 = report_rapporti2 + report + report2+&#39;\n&#39;</span>
                
        <span class="c1"># self.listWidget_rapp.addItem(report_rapporti2)    </span>
        
           
          
        <span class="c1"># HOME = os.environ[&#39;PYARCHINIT_HOME&#39;]</span>
        <span class="c1"># report_path = &#39;{}{}{}&#39;.format(HOME, os.sep, &quot;pyarchinit_Report_folder&quot;)</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_per_ut_a_rapporti_US.txt&#39;)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_per_ut_to_SE relation.txt&#39;)</span>
        <span class="c1"># elif self.L==&#39;en&#39;:</span>
            <span class="c1"># filename = &#39;{}{}{}&#39;.format(report_path, os.sep, &#39;log_per_ut_to_SU relation.txt&#39;) </span>
        <span class="c1"># f = open(filename, &quot;w&quot;)</span>
        <span class="c1"># f.write(report_rapporti2)</span>
        <span class="c1"># f.close()</span>
   
    <span class="c1"># def insert_new_rec(self):</span>
        <span class="c1"># # TableWidget</span>
        <span class="c1"># #Rapporti</span>
        <span class="c1"># rapporti = self.table2dict(&quot;self.tableWidget_rapporti&quot;)</span>
        <span class="c1"># rapporti2 = self.table2dict(&quot;self.tableWidget_rapporti2&quot;)</span>
        <span class="c1"># #Inclusi</span>
        <span class="c1"># inclusi = self.table2dict(&quot;self.tableWidget_inclusi&quot;)</span>
        <span class="c1"># #Campioni</span>
        <span class="c1"># campioni = self.table2dict(&quot;self.tableWidget_campioni&quot;)</span>
        <span class="c1"># #organici</span>
        <span class="c1"># organici = self.table2dict(&quot;self.tableWidget_organici&quot;)</span>
        <span class="c1"># #inorganici</span>
        <span class="c1"># inorganici = self.table2dict(&quot;self.tableWidget_inorganici&quot;)</span>
        <span class="c1"># #Documentazione</span>
        <span class="c1"># documentazione = self.table2dict(&quot;self.tableWidget_documentazione&quot;)</span>
        <span class="c1"># #Colore legante usm</span>
        <span class="c1"># colore_legante_usm = self.table2dict(&quot;self.tableWidget_colore_legante_usm&quot;)</span>
        <span class="c1"># #Inclusi leganti usm</span>
        <span class="c1"># aggreg_legante_usm = self.table2dict(&quot;self.tableWidget_inclusi_leganti_usm&quot;)</span>
        <span class="c1"># #Consistenza texture mat_usm</span>
        <span class="c1"># consistenza_texture_mat_usm = self.table2dict(&quot;self.tableWidget_consistenza_texture_mat_usm&quot;)</span>
        <span class="c1"># #inclusi_materiali_usm</span>
        <span class="c1"># inclusi_materiali_usm = self.table2dict(&quot;self.tableWidget_inclusi_materiali_usm&quot;)</span>
        <span class="c1"># #colore_materiale_usm</span>
        <span class="c1"># colore_materiale_usm = self.table2dict(&quot;self.tableWidget_colore_materiale_usm&quot;)</span>
        <span class="c1"># if self.lineEditOrderLayer.text() == &quot;&quot;:</span>
            <span class="c1"># order_layer = 0</span>
        <span class="c1"># else:</span>
            <span class="c1"># order_layer = int(self.lineEditOrderLayer.text())</span>
        <span class="c1"># ##quota min usm</span>
        <span class="c1"># if self.lineEdit_qmin_usm.text() == &quot;&quot;:</span>
            <span class="c1"># qmin_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># qmin_usm = float(self.lineEdit_qmin_usm.text())</span>
        <span class="c1"># ##quota max usm</span>
        <span class="c1"># if self.lineEdit_qmax_usm.text() == &quot;&quot;:</span>
            <span class="c1"># qmax_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># qmax_usm = float(self.lineEdit_qmax_usm.text())</span>
        <span class="c1"># ##quota relativa</span>
        <span class="c1"># if self.lineEdit_quota_relativa.text() == &quot;&quot;:</span>
            <span class="c1"># quota_relativa = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_relativa = float(self.lineEdit_quota_relativa.text())</span>
        <span class="c1"># ##quota abs</span>
        <span class="c1"># if self.lineEdit_quota_abs.text() == &quot;&quot;:</span>
            <span class="c1"># quota_abs = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_abs = float(self.lineEdit_quota_abs.text())</span>
        <span class="c1"># ##lunghezza max</span>
        <span class="c1"># if self.lineEdit_lunghezza_max.text() == &quot;&quot;:</span>
            <span class="c1"># lunghezza_max = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># lunghezza_max = float(self.lineEdit_lunghezza_max.text())</span>
        <span class="c1"># ##altezza max</span>
        <span class="c1"># if self.lineEdit_altezza_max.text() == &quot;&quot;:</span>
            <span class="c1"># altezza_max = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># altezza_max = float(self.lineEdit_altezza_max.text())</span>
        <span class="c1"># ##altezza min</span>
        <span class="c1"># if self.lineEdit_altezza_min.text() == &quot;&quot;:</span>
            <span class="c1"># altezza_min = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># altezza_min = float(self.lineEdit_altezza_min.text())</span>
        <span class="c1"># ##profondita max</span>
        <span class="c1"># if self.lineEdit_profondita_max.text() == &quot;&quot;:</span>
            <span class="c1"># profondita_max = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># profondita_max = float(self.lineEdit_profondita_max.text())</span>
        <span class="c1"># ##profondita min</span>
        <span class="c1"># if self.lineEdit_profondita_min.text() == &quot;&quot;:</span>
            <span class="c1"># profondita_min = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># profondita_min = float(self.lineEdit_profondita_min.text())</span>
        <span class="c1"># ##larghezza media</span>
        <span class="c1"># if self.lineEdit_larghezza_media.text() == &quot;&quot;:</span>
            <span class="c1"># larghezza_media = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># larghezza_media = float(self.lineEdit_larghezza_media.text())</span>
        <span class="c1"># ##quota max abs</span>
        <span class="c1"># if self.lineEdit_quota_max_abs.text() == &quot;&quot;:</span>
            <span class="c1"># quota_max_abs = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_max_abs = float(self.lineEdit_quota_max_abs.text())</span>
        <span class="c1"># ##quota max relativa</span>
        <span class="c1"># if self.lineEdit_quota_max_rel.text() == &quot;&quot;:</span>
            <span class="c1"># quota_max_rel = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_max_rel = float(self.lineEdit_quota_max_rel.text())</span>
        <span class="c1"># ##quota min abs</span>
        <span class="c1"># if self.lineEdit_quota_min_abs.text() == &quot;&quot;:</span>
            <span class="c1"># quota_min_abs = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_min_abs = float(self.lineEdit_quota_min_abs.text())</span>
        <span class="c1"># ##quota min relativa</span>
        <span class="c1"># if self.lineEdit_quota_min_rel.text() == &quot;&quot;:</span>
            <span class="c1"># quota_min_rel = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_min_rel = float(self.lineEdit_quota_min_rel.text())</span>
        <span class="c1"># ##lunghezza usm</span>
        <span class="c1"># if self.lineEdit_lunghezza_usm.text() == &quot;&quot;:</span>
            <span class="c1"># lunghezza_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># lunghezza_usm = float(self.lineEdit_lunghezza_usm.text())</span>
        <span class="c1"># ##altezza usm</span>
        <span class="c1"># if self.lineEdit_altezza_usm.text() == &quot;&quot;:</span>
            <span class="c1"># altezza_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># altezza_usm = float(self.lineEdit_altezza_usm.text())</span>
        <span class="c1"># ##spessore usm</span>
        <span class="c1"># if self.lineEdit_spessore_usm.text() == &quot;&quot;:</span>
            <span class="c1"># spessore_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># spessore_usm = float(self.lineEdit_spessore_usm.text())</span>
        <span class="c1"># try:</span>
            <span class="c1"># # data</span>
            <span class="c1"># data = self.DB_MANAGER.insert_values(</span>
                <span class="c1"># self.DB_MANAGER.max_num_id(self.MAPPER_TABLE_CLASS, self.ID_TABLE) + 1,</span>
                <span class="c1"># str(self.comboBox_sito.currentText()),  # 1 - Sito</span>
                <span class="c1"># str(self.comboBox_area.currentText()),  # 2 - Area</span>
                <span class="c1"># int(self.lineEdit_us.text()),  # 3 - US</span>
                <span class="c1"># str(self.comboBox_def_strat.currentText()),  # 4 - Definizione stratigrafica</span>
                <span class="c1"># str(self.comboBox_def_intepret.currentText()),  # 5 - Definizione intepretata</span>
                <span class="c1"># str(self.textEdit_descrizione.toPlainText()),  # 6 - descrizione</span>
                <span class="c1"># str(self.textEdit_interpretazione.toPlainText()),  # 7 - interpretazione</span>
                <span class="c1"># str(self.comboBox_per_iniz.currentText()),  # 8 - periodo iniziale</span>
                <span class="c1"># str(self.comboBox_fas_iniz.currentText()),  # 9 - fase iniziale</span>
                <span class="c1"># str(self.comboBox_per_fin.currentText()),  # 10 - periodo finale iniziale</span>
                <span class="c1"># str(self.comboBox_fas_fin.currentText()),  # 11 - fase finale</span>
                <span class="c1"># str(self.comboBox_scavato.currentText()),  # 12 - scavato</span>
                <span class="c1"># str(self.lineEdit_attivita.text()),  # 13 - attivita</span>
                <span class="c1"># str(self.lineEdit_anno.text()),  # 14 - anno scavo</span>
                <span class="c1"># str(self.comboBox_metodo.currentText()),  # 15 - metodo</span>
                <span class="c1"># str(inclusi),  # 16 - inclusi</span>
                <span class="c1"># str(campioni),  # 17 - campioni</span>
                <span class="c1"># str(rapporti),  # 18 - rapporti</span>
                <span class="c1"># #str(organici), # componenti organici</span>
                <span class="c1"># #str(inorganici), #componenti inorganici</span>
                <span class="c1"># str(self.lineEdit_data_schedatura.text()),  # 19 - data schedatura</span>
                <span class="c1"># str(self.comboBox_schedatore.currentText()),  # 20 - schedatore</span>
                <span class="c1"># str(self.comboBox_formazione.currentText()),  # 21 - formazione</span>
                <span class="c1"># str(self.comboBox_conservazione.currentText()),  # 22 - conservazione</span>
                <span class="c1"># str(self.comboBox_colore.currentText()),  # 23 - colore</span>
                <span class="c1"># str(self.comboBox_consistenza.currentText()),  # 24 - consistenza</span>
                <span class="c1"># str(self.comboBox_struttura.currentText()),  # 25 - struttura</span>
                <span class="c1"># str(self.lineEdit_codice_periodo.text()),  # 26 - continuita  periodo</span>
                <span class="c1"># order_layer,  # 27 - order layer</span>
                <span class="c1"># str(documentazione),  # 28 - documentazione</span>
                <span class="c1"># str(self.comboBox_unita_tipo.currentText()),  # 29 us_tipo            NUOVI CAMPI NUOVI CAMPI</span>
                <span class="c1"># str(self.comboBox_settore.currentText()),  # 30 settore</span>
                <span class="c1"># str(self.lineEdit_quadrato.text()),  # 31 quadrato</span>
                <span class="c1"># str(self.lineEdit_ambiente.text()),  # 32 ambiente</span>
                <span class="c1"># str(self.lineEdit_saggio.text()),  # 33 saggio</span>
                <span class="c1"># str(self.textEdit_elementi_datanti.toPlainText()),  # 34 elementi datanti</span>
                <span class="c1"># str(self.comboBox_funz_statica_usm.currentText()),  # 35 funzione statica</span>
                <span class="c1"># str(self.comboBox_lavorazione_usm.currentText()),  # 36 lavorazione usm</span>
                <span class="c1"># str(self.lineEdit_spessore_giunti_usm.text()),  # 37 spessore giunti</span>
                <span class="c1"># str(self.lineEdit_letti_di_posa_giunti_usm.text()),  # 38 letti posa giunti usm</span>
                <span class="c1"># str(self.lineEdit_h_modulo_c_corsi_usm.text()),  # 39 altezza modulo corsi usm</span>
                <span class="c1"># str(self.comboBox_unita_edilizia_riassuntiva_usm.currentText()),  # 40 unita edilizia riassuntiva</span>
                <span class="c1"># str(self.comboBox_reimpiego_usm.currentText()),  # 41 unita edilizia riassuntiva</span>
                <span class="c1"># str(self.comboBox_posa_in_opera_usm.currentText()),  # 42 posa in opera</span>
                <span class="c1"># qmin_usm,  # 43 quota minima</span>
                <span class="c1"># qmax_usm,  # 44 quota massima</span>
                <span class="c1"># str(self.comboBox_consistenza_legante_usm.currentText()),  #  1 45 consitenza legante usm</span>
                <span class="c1"># str(colore_legante_usm),  # 2 46 colore legante usm</span>
                <span class="c1"># str(aggreg_legante_usm),  # 47 3 aggreg legante usm</span>
                <span class="c1"># str(consistenza_texture_mat_usm),  # 4 48 consistenza text mat</span>
                <span class="c1"># str(colore_materiale_usm),  # 5 49 colore materiale usm</span>
                <span class="c1"># str(inclusi_materiali_usm), # 6 50 inclusi_mat_usm</span>
                <span class="c1"># str(self.lineEdit_n_catalogo_generale.text()), # 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
                <span class="c1"># str(self.lineEdit_n_catalogo_interno.text()), # 52 nr catalogo interno</span>
                <span class="c1"># str(self.lineEdit_n_catalogo_internazionale.text()), # 53 nr catalogo internazionale</span>
                <span class="c1"># str(self.comboBox_soprintendenza.currentText()), # 54 nr soprintendenza</span>
                <span class="c1"># quota_relativa, #55 quota relativa</span>
                <span class="c1"># quota_abs, #56 quota abs</span>
                <span class="c1"># str(self.lineEdit_ref_tm.text()),  # 57 ref tm</span>
                <span class="c1"># str(self.comboBox_ref_ra.currentText()),  # 58 ref ra</span>
                <span class="c1"># str(self.lineEdit_ref_n.text()),  # 59 ref n</span>
                <span class="c1"># str(self.comboBox_posizione.currentText()),  # 60 posizione</span>
                <span class="c1"># str(self.lineEdit_criteri_distinzione.text()),  # 61 criteri distinzione</span>
                <span class="c1"># str(self.comboBox_modo_formazione.currentText()),  # 62 modo formazione</span>
                <span class="c1"># str(organici),  # 63 componenti organici</span>
                <span class="c1"># str(inorganici),  # 64 componenti inorganici</span>
                <span class="c1"># lunghezza_max,  # 65</span>
                <span class="c1"># altezza_max,  # 66</span>
                <span class="c1"># altezza_min,  # 67</span>
                <span class="c1"># profondita_max,  # 68</span>
                <span class="c1"># profondita_min,  # 69</span>
                <span class="c1"># larghezza_media,  # 70</span>
                <span class="c1"># quota_max_abs,  # 71</span>
                <span class="c1"># quota_max_rel,  # 72</span>
                <span class="c1"># quota_min_abs,  # 73</span>
                <span class="c1"># quota_min_rel,  # 74</span>
                <span class="c1"># str(self.textEdit_osservazioni.toPlainText()),  # 75 osservazioni</span>
                <span class="c1"># str(self.comboBox_datazione.currentText()),  # 76 datazione</span>
                <span class="c1"># str(self.comboBox_flottazione.currentText()),  # 77 flottazione</span>
                <span class="c1"># str(self.comboBox_setacciatura.currentText()),  # 78 setacciatura</span>
                <span class="c1"># str(self.comboBox_affidabilita.currentText()),  # 79 affidabilita</span>
                <span class="c1"># str(self.comboBox_direttore_us.currentText()),  # 80 direttore us</span>
                <span class="c1"># str(self.comboBox_responsabile_us.currentText()),  # 81 responsabile us</span>
                <span class="c1"># str(self.lineEdit_cod_ente_schedatore.text()),  # 82 cod ente schedatore</span>
                <span class="c1"># str(self.lineEdit_data_rilevazione.text()),  # 83 data rilevazione</span>
                <span class="c1"># str(self.lineEdit_data_rielaborazione.text()),  # 84 data rielaborazione</span>
                <span class="c1"># lunghezza_usm,  # 85</span>
                <span class="c1"># altezza_usm,  # 86</span>
                <span class="c1"># spessore_usm,  # 87</span>
                <span class="c1"># str(self.comboBox_tecnica_muraria_usm.currentText()),  # 88 tecnica muraria usm</span>
                <span class="c1"># str(self.comboBox_modulo_usm.currentText()),  # 89 modulo usm</span>
                <span class="c1"># str(self.lineEdit_campioni_malta_usm.text()),  # 90 campioni malta usm</span>
                <span class="c1"># str(self.lineEdit_campioni_mattone_usm.text()),  # 91 campioni mattone usm</span>
                <span class="c1"># str(self.lineEdit_campioni_pietra_usm.text()),  # 92 campioni pietra usm</span>
                <span class="c1"># str(self.lineEdit_provenienza_materiali_usm.text()),  # 93 provenienza_materiali_usm</span>
                <span class="c1"># str(self.lineEdit_criteri_distinzione_usm.text()),  # 94 criteri distinzione usm</span>
                <span class="c1"># str(self.comboBox_uso_primario_usm.currentText()),</span>
                <span class="c1"># str(self.comboBox_tipologia_opera.currentText()),</span>
                <span class="c1"># str(self.comboBox_sezione_muraria.currentText()),</span>
                <span class="c1"># str(self.comboBox_superficie_analizzata.currentText()),</span>
                <span class="c1"># str(self.comboBox_orientamento.currentText()),</span>
                <span class="c1"># str(self.comboBox_materiali_lat.currentText()),</span>
                <span class="c1"># str(self.comboBox_lavorazione_lat.currentText()),</span>
                <span class="c1"># str(self.comboBox_consistenza_lat.currentText()),</span>
                <span class="c1"># str(self.comboBox_forma_lat.currentText()),</span>
                <span class="c1"># str(self.comboBox_colore_lat.currentText()),</span>
                <span class="c1"># str(self.comboBox_impasto_lat.currentText()),</span>
                <span class="c1"># str(self.comboBox_forma_p.currentText()),</span>
                <span class="c1"># str(self.comboBox_colore_p.currentText()),</span>
                <span class="c1"># str(self.comboBox_taglio_p.currentText()),</span>
                <span class="c1"># str(self.comboBox_posa_opera_p.currentText()),</span>
                <span class="c1"># str(self.comboBox_inerti_usm.currentText()),  # 95 uso primario usm</span>
                <span class="c1"># str(self.comboBox_tipo_legante_usm.currentText()),  # 95 uso primario usm</span>
                <span class="c1"># str(self.comboBox_rifinitura_usm.currentText()),  # 95 uso primario usm</span>
                <span class="c1"># str(self.comboBox_materiale_p.currentText()),  # 95 uso primario usm</span>
                <span class="c1"># str(self.comboBox_consistenza_p.currentText()),  # 95 uso primario usm</span>
                <span class="c1"># str(rapporti2),</span>
                <span class="c1"># str(self.mQgsFileWidget.text())</span>
                <span class="c1"># )</span>
            <span class="c1"># # todelete</span>
            <span class="c1"># # f = open(&quot;C:\\Users\\Luca\\pyarchinit_Report_folder\\data_insert_list.txt&quot;, &quot;w&quot;)</span>
            <span class="c1"># # f.write(str(data))</span>
            <span class="c1"># # f.close</span>
            <span class="c1"># # todelete</span>
            <span class="c1"># try:</span>
                <span class="c1"># self.DB_MANAGER.insert_data_session(data)</span>
                <span class="c1"># return 1</span>
            <span class="c1"># except Exception as e:</span>
                <span class="c1"># e_str = str(e)</span>
                <span class="c1"># if e_str.__contains__(&quot;IntegrityError&quot;):</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># msg = &quot;US gi√† presente nel database&quot;</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;Error&quot;, &quot;Error: &quot; + str(msg), QMessageBox.Ok)</span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># msg = self.ID_TABLE + &quot; bereits in der Datenbank&quot;</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;Error&quot;, &quot;Error: &quot; + str(msg), QMessageBox.Ok)  </span>
                    <span class="c1"># else:</span>
                        <span class="c1"># msg = self.ID_TABLE + &quot; exist in db&quot;</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;Error&quot;, &quot;Error: &quot; + str(msg), QMessageBox.Ok)  </span>
                <span class="c1"># else:</span>
                    <span class="c1"># msg = e</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Error&quot;, &quot;Error 1 \n&quot; + str(msg), QMessageBox.Ok)</span>
                <span class="c1"># return 0</span>
        <span class="c1"># except Exception as e:</span>
            <span class="c1"># QMessageBox.warning(self, &quot;Error&quot;, &quot;Error 2 \n&quot; + str(e), QMessageBox.Ok)</span>
            <span class="c1"># return 0</span>
            <span class="c1"># # insert new row into tableWidget</span>
    <span class="c1"># def on_pushButton_insert_row_rapporti_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_rapporti&#39;)</span>
        
    <span class="c1"># def on_pushButton_remove_row_rapporti_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_rapporti&#39;)</span>

    <span class="c1"># def on_pushButton_insert_row_rapporti2_pressed(self):</span>
       
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_rapporti2&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_rapporti2_pressed(self):</span>
        
        <span class="c1"># self.remove_row(&#39;self.tableWidget_rapporti2&#39;)</span>
    
    <span class="c1"># def on_pushButton_insert_row_inclusi_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_inclusi&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_inclusi_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_inclusi&#39;)</span>
    <span class="c1"># def on_pushButton_insert_row_campioni_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_campioni&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_campioni_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_campioni&#39;)</span>
    <span class="c1"># def on_pushButton_insert_row_organici_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_organici&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_organici_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_organici&#39;)</span>
    <span class="c1"># def on_pushButton_insert_row_inorganici_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_inorganici&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_inorganici_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_inorganici&#39;)</span>
    <span class="c1"># def on_pushButton_insert_row_documentazione_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_documentazione&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_documentazione_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_documentazione&#39;)</span>
    <span class="c1"># def on_pushButton_insert_row_inclusi_materiali_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_inclusi_materiali_usm&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_inclusi_materiali_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_inclusi_materiali_usm&#39;)</span>
    <span class="c1"># def on_pushButton_insert_row_inclusi_leganti_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_inclusi_leganti_usm&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_inclusi_leganti_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_inclusi_leganti_usm&#39;)</span>
    <span class="c1"># def on_pushButton_insert_row_colore_legante_usm_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_colore_legante_usm&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_colore_legante_usm_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_colore_legante_usm&#39;)</span>
    <span class="c1"># def on_pushButton_insert_row_consistenza_texture_mat_usm_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_consistenza_texture_mat_usm&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_consistenza_texture_mat_usm_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_consistenza_texture_mat_usm&#39;)</span>
    <span class="c1"># def on_pushButton_insert_row_colore_materiale_usm_pressed(self):</span>
        <span class="c1"># self.insert_new_row(&#39;self.tableWidget_colore_materiale_usm&#39;)</span>
    <span class="c1"># def on_pushButton_remove_row_colore_materiale_usm_pressed(self):</span>
        <span class="c1"># self.remove_row(&#39;self.tableWidget_colore_materiale_usm&#39;)</span>
    <span class="c1"># def check_record_state(self):</span>
        <span class="c1"># ec = self.data_error_check()</span>
        <span class="c1"># if ec == 1:</span>
            <span class="c1"># return 1  # ci sono errori di immissione</span>
        <span class="c1"># elif self.records_equal_check() == 1 and ec == 0:</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># self.update_if(</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;Errore&#39;, &quot;Il record e&#39; stato modificato. Vuoi salvare le modifiche?&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># self.update_if(</span>
                    <span class="c1"># QMessageBox.warning(self, &#39;Errore&#39;, &quot;Der Record wurde ge√§ndert. M√∂chtest du die √Ñnderungen speichern?&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.update_if(</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Error&quot;, &quot;The record has been changed. You want to save the changes?&quot;,</span>
                                        <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
            <span class="c1"># return 0  </span>
            <span class="c1"># # records surf functions</span>
    <span class="c1"># def on_pushButton_view_all_pressed(self):</span>
        
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># self.empty_fields()</span>
        <span class="c1"># self.charge_records()</span>
        <span class="c1"># self.fill_fields()</span>
        <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
        <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
        <span class="c1"># if type(self.REC_CORR) == &quot;&lt;class &#39;str&#39;&gt;&quot;:</span>
            <span class="c1"># corr = 0</span>
        <span class="c1"># else:</span>
            <span class="c1"># corr = self.REC_CORR</span>
        <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
        <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
        <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
        <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
        <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
        <span class="c1"># # records surf functions</span>
    <span class="c1"># def on_pushButton_first_rec_pressed(self):</span>
        
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># if self.check_record_state() == 1:</span>
            <span class="c1"># pass</span>
        <span class="c1"># else:</span>
            <span class="c1"># try:</span>
                <span class="c1"># self.empty_fields()</span>
                <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
                <span class="c1"># self.fill_fields(0)</span>
                <span class="c1"># self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
            <span class="c1"># except :</span>
                <span class="c1"># pass</span>
    <span class="c1"># def on_pushButton_last_rec_pressed(self):</span>
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># if self.check_record_state() == 1:</span>
            <span class="c1"># pass</span>
        <span class="c1"># else:</span>
            <span class="c1"># try:</span>
                <span class="c1"># self.empty_fields()</span>
                <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), len(self.DATA_LIST) - 1</span>
                <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                <span class="c1"># self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
            <span class="c1"># except:</span>
                <span class="c1"># pass</span>
    <span class="c1"># def on_pushButton_prev_rec_pressed(self):</span>
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># rec_goto = int(self.lineEdit_goto.text())</span>
        <span class="c1"># if self.check_record_state() == 1:</span>
            <span class="c1"># pass</span>
        <span class="c1"># else:</span>
            <span class="c1"># self.REC_CORR = self.REC_CORR - rec_goto</span>
        <span class="c1"># if self.REC_CORR &lt;= -1:</span>
            <span class="c1"># self.REC_CORR = self.REC_CORR + rec_goto</span>
            <span class="c1"># #QMessageBox.information(self, &quot;Warning&quot;, &quot;you are to the first record&quot;, QMessageBox.Ok)</span>
        <span class="c1"># else:</span>
            <span class="c1"># try:</span>
                <span class="c1"># self.empty_fields()</span>
                <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                <span class="c1"># self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
            <span class="c1"># except:# Exception as e:</span>
                <span class="c1"># pass#QMessageBox.warning(self, &quot;Error&quot;, str(e), QMessageBox.Ok)</span>
    <span class="c1"># def on_pushButton_next_rec_pressed(self):</span>
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># rec_goto = int(self.lineEdit_goto.text())</span>
        
        
        
        <span class="c1"># if self.check_record_state() == 1:</span>
            <span class="c1"># pass</span>
        <span class="c1"># else:</span>
            <span class="c1"># self.REC_CORR = self.REC_CORR + rec_goto</span>
        <span class="c1"># if self.REC_CORR &gt;= self.REC_TOT:</span>
            <span class="c1"># self.REC_CORR = self.REC_CORR - rec_goto</span>
            <span class="c1"># #QMessageBox.information(self, &quot;Warning&quot;, &quot;you are to the last record&quot;, QMessageBox.Ok)</span>
        <span class="c1"># else:</span>
            <span class="c1"># try:</span>
                <span class="c1"># self.empty_fields()</span>
                <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                <span class="c1"># self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
            <span class="c1"># except :#Exception as e:</span>
                <span class="c1"># pass#QMessageBox.warning(self, &quot;Error&quot;, str(e), QMessageBox.Ok)</span>
    
    
        <span class="c1"># if self.checkBox_validate.isChecked():</span>
            <span class="c1"># self.selectRows()</span>
            <span class="c1"># # while True:</span>
                <span class="c1"># # try:</span>
                    <span class="c1"># # self.empty_fields()</span>
                    <span class="c1"># # self.fill_fields(self.REC_CORR)</span>
                    <span class="c1"># # self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
                <span class="c1"># # except :#Exception as e:</span>
                    <span class="c1"># # pass#QMessageBox.warning(self, &quot;Error&quot;, str(e), QMessageBox.Ok)</span>
                <span class="c1"># # #continue</span>
                <span class="c1"># # else:</span>
                    <span class="c1"># # break</span>
    <span class="c1"># def on_pushButton_delete_pressed(self):</span>
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># msg = QMessageBox.warning(self, &quot;Attenzione!!!&quot;,</span>
                                      <span class="c1"># &quot;Vuoi veramente eliminare il record? \n L&#39;azione √® irreversibile&quot;,</span>
                                      <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel)</span>
            <span class="c1"># if msg == QMessageBox.Cancel:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Messagio!!!&quot;, &quot;Azione Annullata!&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># try:</span>
                    <span class="c1"># id_to_delete = eval(&quot;self.DATA_LIST[self.REC_CORR].&quot; + self.ID_TABLE)</span>
                    <span class="c1"># self.DB_MANAGER.delete_one_record(self.TABLE_NAME, self.ID_TABLE, id_to_delete)</span>
                    <span class="c1"># self.charge_records()  # charge records from DB</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Messaggio!!!&quot;, &quot;Record eliminato!&quot;)</span>
                <span class="c1"># except Exception as e:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Messaggio!!!&quot;, &quot;Tipo di errore: &quot; + str(e))</span>
                <span class="c1"># if not bool(self.DATA_LIST):</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Attenzione&quot;, &quot;Il database √® vuoto!&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># self.DATA_LIST = []</span>
                    <span class="c1"># self.DATA_LIST_REC_CORR = []</span>
                    <span class="c1"># self.DATA_LIST_REC_TEMP = []</span>
                    <span class="c1"># self.REC_CORR = 0</span>
                    <span class="c1"># self.REC_TOT = 0</span>
                    <span class="c1"># self.empty_fields()</span>
                    <span class="c1"># self.set_rec_counter(0, 0)</span>
                    <span class="c1"># # check if DB is empty</span>
                <span class="c1"># if bool(self.DATA_LIST):</span>
                    <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
                    <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
                    <span class="c1"># self.charge_list()</span>
                    <span class="c1"># self.fill_fields()</span>
                    <span class="c1"># self.set_sito()</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># msg = QMessageBox.warning(self, &quot;Achtung!!!&quot;,</span>
                                      <span class="c1"># &quot;Willst du wirklich diesen Eintrag l√∂schen? \n Der Vorgang ist unumkehrbar&quot;,</span>
                                      <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel)</span>
            <span class="c1"># if msg == QMessageBox.Cancel:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message!!!&quot;, &quot;Aktion annulliert!&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># try:</span>
                    <span class="c1"># id_to_delete = eval(&quot;self.DATA_LIST[self.REC_CORR].&quot; + self.ID_TABLE)</span>
                    <span class="c1"># self.DB_MANAGER.delete_one_record(self.TABLE_NAME, self.ID_TABLE, id_to_delete)</span>
                    <span class="c1"># self.charge_records()  # charge records from DB</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Message!!!&quot;, &quot;Record gel√∂scht!&quot;)</span>
                <span class="c1"># except Exception as e:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Messagge!!!&quot;, &quot;Errortyp: &quot; + str(e))</span>
                <span class="c1"># if not bool(self.DATA_LIST):</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Attenzione&quot;, &quot;Die Datenbank ist leer!&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># self.DATA_LIST = []</span>
                    <span class="c1"># self.DATA_LIST_REC_CORR = []</span>
                    <span class="c1"># self.DATA_LIST_REC_TEMP = []</span>
                    <span class="c1"># self.REC_CORR = 0</span>
                    <span class="c1"># self.REC_TOT = 0</span>
                    <span class="c1"># self.empty_fields()</span>
                    <span class="c1"># self.set_rec_counter(0, 0)</span>
                    <span class="c1"># # check if DB is empty</span>
                <span class="c1"># if bool(self.DATA_LIST):</span>
                    <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
                    <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
                    <span class="c1"># self.charge_list()</span>
                    <span class="c1"># self.fill_fields()</span>
                    <span class="c1"># self.set_sito()</span>
        <span class="c1"># else:</span>
            <span class="c1"># msg = QMessageBox.warning(self, &quot;Warning!!!&quot;,</span>
                                      <span class="c1"># &quot;Do you really want to break the record? \n Action is irreversible.&quot;,</span>
                                      <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel)</span>
            <span class="c1"># if msg == QMessageBox.Cancel:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message!!!&quot;, &quot;Action deleted!&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># try:</span>
                    <span class="c1"># id_to_delete = eval(&quot;self.DATA_LIST[self.REC_CORR].&quot; + self.ID_TABLE)</span>
                    <span class="c1"># self.DB_MANAGER.delete_one_record(self.TABLE_NAME, self.ID_TABLE, id_to_delete)</span>
                    <span class="c1"># self.charge_records()  # charge records from DB</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Message!!!&quot;, &quot;Record deleted!&quot;)</span>
                <span class="c1"># except Exception as e:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;, &quot;error type: &quot; + str(e))</span>
                <span class="c1"># if not bool(self.DATA_LIST):</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Warning&quot;, &quot;the db is empty!&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># self.DATA_LIST = []</span>
                    <span class="c1"># self.DATA_LIST_REC_CORR = []</span>
                    <span class="c1"># self.DATA_LIST_REC_TEMP = []</span>
                    <span class="c1"># self.REC_CORR = 0</span>
                    <span class="c1"># self.REC_TOT = 0</span>
                    <span class="c1"># self.empty_fields()</span>
                    <span class="c1"># self.set_rec_counter(0, 0)</span>
                    <span class="c1"># # check if DB is empty</span>
                <span class="c1"># if bool(self.DATA_LIST):</span>
                    <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
                    <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
                    <span class="c1"># self.charge_list()</span>
                    <span class="c1"># self.fill_fields()  </span>
                    <span class="c1"># self.set_sito()</span>
            <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
            <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
            <span class="c1"># #</span>
    <span class="c1"># def on_pushButton_new_search_pressed(self):</span>
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.checkBox_query.isChecked():</span>
            <span class="c1"># self.model_a.database().close()</span>
        <span class="c1"># if self.BROWSE_STATUS != &quot;f&quot; and self.check_record_state() == 1:</span>
            <span class="c1"># pass</span>
        <span class="c1"># else:</span>
            <span class="c1"># self.enable_button_search(0)</span>
            <span class="c1"># conn = Connection()</span>
        
            <span class="c1"># sito_set= conn.sito_set()</span>
            <span class="c1"># sito_set_str = sito_set[&#39;sito_set&#39;]</span>
            <span class="c1"># if self.BROWSE_STATUS != &quot;f&quot;:</span>
                <span class="c1"># if bool(self.comboBox_sito.currentText()) and self.comboBox_sito.currentText()==sito_set_str:</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;f&quot;</span>
                    <span class="c1"># self.empty_fields_nosite()</span>
                    <span class="c1"># self.lineEdit_data_schedatura.setText(&quot;&quot;)</span>
                    <span class="c1"># self.lineEdit_anno.setText(&quot;&quot;)</span>
                    <span class="c1"># self.comboBox_formazione.setEditText(&quot;&quot;)</span>
                    <span class="c1"># self.comboBox_metodo.setEditText(&quot;&quot;)</span>
                    <span class="c1"># #self.setComboBoxEditable([&quot;self.comboBox_sito&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_area&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_unita_tipo&quot;],1)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_unita_tipo&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.textEdit_descrizione&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.textEdit_interpretazione&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setTableEnable(</span>
                        <span class="c1"># [&quot;self.tableWidget_campioni&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_rapporti&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inclusi&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_organici&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inorganici&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_documentazione&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inclusi_materiali_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_colore_legante_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inclusi_leganti_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_consistenza_texture_mat_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_colore_materiale_usm&quot;,&quot;self.tableWidget_rapporti2&quot;], &quot;False&quot;)</span>
                    <span class="c1"># ###</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.set_rec_counter(&#39;&#39;, &#39;&#39;)</span>
                    <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[&quot;n&quot;])</span>
                    <span class="c1"># #self.charge_list()</span>
                    
                <span class="c1"># else:</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;f&quot;</span>
                    <span class="c1"># ###</span>
                    <span class="c1"># self.lineEdit_data_schedatura.setText(&quot;&quot;)</span>
                    <span class="c1"># self.lineEdit_anno.setText(&quot;&quot;)</span>
                    <span class="c1"># self.comboBox_formazione.setEditText(&quot;&quot;)</span>
                    <span class="c1"># self.comboBox_metodo.setEditText(&quot;&quot;)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_sito&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_area&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_unita_tipo&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_unita_tipo&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.textEdit_descrizione&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.textEdit_interpretazione&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setTableEnable(</span>
                        <span class="c1"># [&quot;self.tableWidget_campioni&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_rapporti&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inclusi&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_organici&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inorganici&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_documentazione&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inclusi_materiali_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_colore_legante_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inclusi_leganti_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_consistenza_texture_mat_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_colore_materiale_usm&quot;,&quot;self.tableWidget_rapporti2&quot;], &quot;False&quot;)</span>
                    <span class="c1"># ###</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.set_rec_counter(&#39;&#39;, &#39;&#39;)</span>
                    <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[&quot;n&quot;])</span>
                    <span class="c1"># self.charge_list()</span>
                    <span class="c1"># self.empty_fields()</span>
    <span class="c1"># def on_pushButton_showLayer_pressed(self):</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># for sing_us in range(len(self.DATA_LIST)):</span>
            <span class="c1"># sing_layer = [self.DATA_LIST[sing_us]]</span>
            <span class="c1"># self.pyQGIS.charge_vector_layers(sing_layer)</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># sing_layer = [self.DATA_LIST[self.REC_CORR]]</span>
        <span class="c1"># self.pyQGIS.charge_vector_layers(sing_layer)</span>
        <span class="c1"># self.pyQGIS.charge_usm_layers(sing_layer)</span>
    <span class="c1"># def on_pushButton_crea_codice_periodo_pressed(self):</span>
        <span class="c1"># try:</span>
            <span class="c1"># self.set_sito()</span>
            <span class="c1"># sito = str(self.comboBox_sito.currentText())</span>
            <span class="c1"># self.DB_MANAGER.update_cont_per(sito)</span>
            <span class="c1"># self.empty_fields()</span>
            <span class="c1"># #self.charge_records()</span>
            <span class="c1"># self.fill_fields(self.REC_CORR)  # ricaricare tutti i record in uso e passare il valore REC_CORR a fill_fields</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;INFO&quot;, &quot;Codice periodo aggiornato per lo scavo %s&quot; % (sito), QMessageBox.Ok)</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;INFO&quot;, &quot;Der Zeitstellungscode wurde f√ºr die Ausgrabung hochgeladen %s&quot; % (sito), QMessageBox.Ok)</span>
            <span class="c1"># elif self.L==&#39;en&#39;:   </span>
                <span class="c1"># QMessageBox.warning(self, &quot;INFO&quot;, &quot;Updated period code for excavation %s&quot; % (sito), QMessageBox.Ok)</span>
        <span class="c1"># except KeyError as e:</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Attenzione&quot;, str(e), QMessageBox.Ok)</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Achtung&quot;, str(e), QMessageBox.Ok)</span>
            <span class="c1"># elif self.L==&#39;en&#39;:   </span>
                <span class="c1"># QMessageBox.warning(self, &quot;Attention&quot;, str(e), QMessageBox.Ok)</span>
    <span class="c1"># def on_pushButton_search_go_pressed(self):</span>
        <span class="c1"># self.checkBox_query.setChecked(False)</span>
        <span class="c1"># if self.BROWSE_STATUS != &quot;f&quot;:</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Per eseguire una nuova ricerca clicca sul pulsante &#39;new search&#39; &quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Um eine neue Abfrage zu starten dr√ºcke  &#39;new search&#39; &quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;, &quot;To perform a new search click on the &#39;new search&#39; button &quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)                     </span>
        <span class="c1"># else:</span>
            <span class="c1"># # TableWidget</span>
            <span class="c1"># if self.lineEdit_us.text() != &quot;&quot;:</span>
                <span class="c1"># us = int(self.lineEdit_us.text())</span>
            <span class="c1"># else:</span>
                <span class="c1"># us = &quot;&quot;</span>
            <span class="c1"># ##qmin_usm</span>
            <span class="c1"># if self.lineEdit_qmin_usm.text() != &quot;&quot;:</span>
                <span class="c1"># qmin_usm = float(self.lineEdit_qmin_usm.text())</span>
            <span class="c1"># else:</span>
                <span class="c1"># qmin_usm = None</span>
            <span class="c1"># ##qmax_usm</span>
            <span class="c1"># if self.lineEdit_qmax_usm.text() != &quot;&quot;:</span>
                <span class="c1"># qmax_usm = float(self.lineEdit_qmax_usm.text())</span>
            <span class="c1"># else:</span>
                <span class="c1"># qmax_usm = None</span>
            <span class="c1"># #pre pyarchinit 3.0</span>
            <span class="c1"># ##quota relativa</span>
            <span class="c1"># if self.lineEdit_quota_relativa.text() == &quot;&quot;:</span>
                <span class="c1"># quota_relativa = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_relativa = float(self.lineEdit_quota_relativa.text())</span>
            <span class="c1"># ##quota abs</span>
            <span class="c1"># if self.lineEdit_quota_abs.text() == &quot;&quot;:</span>
                <span class="c1"># quota_abs = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_abs = float(self.lineEdit_quota_abs.text())</span>
            <span class="c1"># ##lunghezza max</span>
            <span class="c1"># if self.lineEdit_lunghezza_max.text() == &quot;&quot;:</span>
                <span class="c1"># lunghezza_max = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># lunghezza_max = float(self.lineEdit_lunghezza_max.text())</span>
            <span class="c1"># ##altezza max</span>
            <span class="c1"># if self.lineEdit_altezza_max.text() == &quot;&quot;:</span>
                <span class="c1"># altezza_max = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># altezza_max = float(self.lineEdit_altezza_max.text())</span>
            <span class="c1"># ##altezza min</span>
            <span class="c1"># if self.lineEdit_altezza_min.text() == &quot;&quot;:</span>
                <span class="c1"># altezza_min = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># altezza_min = float(self.lineEdit_altezza_min.text())</span>
            <span class="c1"># ##profondita max</span>
            <span class="c1"># if self.lineEdit_profondita_max.text() == &quot;&quot;:</span>
                <span class="c1"># profondita_max = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># profondita_max = float(self.lineEdit_profondita_max.text())</span>
            <span class="c1"># ##profondita min</span>
            <span class="c1"># if self.lineEdit_profondita_min.text() == &quot;&quot;:</span>
                <span class="c1"># profondita_min = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># profondita_min = float(self.lineEdit_profondita_min.text())</span>
            <span class="c1"># ##larghezza media</span>
            <span class="c1"># if self.lineEdit_larghezza_media.text() == &quot;&quot;:</span>
                <span class="c1"># larghezza_media = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># larghezza_media = float(self.lineEdit_larghezza_media.text())</span>
            <span class="c1"># ##quota max abs</span>
            <span class="c1"># if self.lineEdit_quota_max_abs.text() == &quot;&quot;:</span>
                <span class="c1"># quota_max_abs = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_max_abs = float(self.lineEdit_quota_max_abs.text())</span>
            <span class="c1"># ##quota max relativa</span>
            <span class="c1"># if self.lineEdit_quota_max_rel.text() == &quot;&quot;:</span>
                <span class="c1"># quota_max_rel = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_max_rel = float(self.lineEdit_quota_max_rel.text())</span>
            <span class="c1"># ##quota min abs</span>
            <span class="c1"># if self.lineEdit_quota_min_abs.text() == &quot;&quot;:</span>
                <span class="c1"># quota_min_abs = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_min_abs = float(self.lineEdit_quota_min_abs.text())</span>
            <span class="c1"># ##quota min relativa</span>
            <span class="c1"># if self.lineEdit_quota_min_rel.text() == &quot;&quot;:</span>
                <span class="c1"># quota_min_rel = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># quota_min_rel = float(self.lineEdit_quota_min_rel.text())</span>
            <span class="c1"># ##lunghezza usm</span>
            <span class="c1"># if self.lineEdit_lunghezza_usm.text() == &quot;&quot;:</span>
                <span class="c1"># lunghezza_usm = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># lunghezza_usm = float(self.lineEdit_lunghezza_usm.text())</span>
            <span class="c1"># ##altezza usm</span>
            <span class="c1"># if self.lineEdit_altezza_usm.text() == &quot;&quot;:</span>
                <span class="c1"># altezza_usm = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># altezza_usm = float(self.lineEdit_altezza_usm.text())</span>
            <span class="c1"># ##spessore usm</span>
            <span class="c1"># if self.lineEdit_spessore_usm.text() == &quot;&quot;:</span>
                <span class="c1"># spessore_usm = None</span>
            <span class="c1"># else:</span>
                <span class="c1"># spessore_usm = float(self.lineEdit_spessore_usm.text())</span>
            <span class="c1"># search_dict = {</span>
                <span class="c1"># self.TABLE_FIELDS[0]: &quot;&#39;&quot; + str(self.comboBox_sito.currentText()) + &quot;&#39;&quot;,  # 1 - Sito</span>
                <span class="c1"># self.TABLE_FIELDS[1]: &quot;&#39;&quot; + str(self.comboBox_area.currentText()) + &quot;&#39;&quot;,  # 2 - Area</span>
                <span class="c1"># self.TABLE_FIELDS[2]: us,  # 3 - US</span>
                <span class="c1"># self.TABLE_FIELDS[3]: &quot;&#39;&quot; + str(self.comboBox_def_strat.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># # 4 - Definizione stratigrafica</span>
                <span class="c1"># self.TABLE_FIELDS[4]: &quot;&#39;&quot; + str(self.comboBox_def_intepret.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># # 5 - Definizione intepretata</span>
                <span class="c1"># self.TABLE_FIELDS[5]: str(self.textEdit_descrizione.toPlainText()),  # 6 - descrizione</span>
                <span class="c1"># self.TABLE_FIELDS[6]: str(self.textEdit_interpretazione.toPlainText()),  # 7 - interpretazione</span>
                <span class="c1"># self.TABLE_FIELDS[7]: &quot;&#39;&quot; + str(self.comboBox_per_iniz.currentText()) + &quot;&#39;&quot;,  # 8 - periodo iniziale</span>
                <span class="c1"># self.TABLE_FIELDS[8]: &quot;&#39;&quot; + str(self.comboBox_fas_iniz.currentText()) + &quot;&#39;&quot;,  # 9 - fase iniziale</span>
                <span class="c1"># self.TABLE_FIELDS[9]: &quot;&#39;&quot; + str(self.comboBox_per_fin.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># # 10 - periodo finale iniziale</span>
                <span class="c1"># self.TABLE_FIELDS[10]: &quot;&#39;&quot; + str(self.comboBox_fas_fin.currentText()) + &quot;&#39;&quot;,  # 11 - fase finale</span>
                <span class="c1"># self.TABLE_FIELDS[11]: &quot;&#39;&quot; + str(self.comboBox_scavato.currentText()) + &quot;&#39;&quot;,  # 12 - scavato</span>
                <span class="c1"># self.TABLE_FIELDS[12]: &quot;&#39;&quot; + str(self.lineEdit_attivita.text()) + &quot;&#39;&quot;,  # 13 - attivita</span>
                <span class="c1"># self.TABLE_FIELDS[13]: &quot;&#39;&quot; + str(self.lineEdit_anno.text()) + &quot;&#39;&quot;,  # 14 - anno scavo</span>
                <span class="c1"># self.TABLE_FIELDS[14]: &quot;&#39;&quot; + str(self.comboBox_metodo.currentText()) + &quot;&#39;&quot;,  # 15 - metodo</span>
                <span class="c1"># self.TABLE_FIELDS[18]: &quot;&#39;&quot; + str(self.lineEdit_data_schedatura.text()) + &quot;&#39;&quot;,  # 16 - data schedatura</span>
                <span class="c1"># self.TABLE_FIELDS[19]: &quot;&#39;&quot; + str(self.comboBox_schedatore.currentText()) + &quot;&#39;&quot;,  # 17 - schedatore</span>
                <span class="c1"># self.TABLE_FIELDS[20]: &quot;&#39;&quot; + str(self.comboBox_formazione.currentText()) + &quot;&#39;&quot;,  # 18 - formazione</span>
                <span class="c1"># self.TABLE_FIELDS[21]: &quot;&#39;&quot; + str(self.comboBox_conservazione.currentText()) + &quot;&#39;&quot;,  # 19 - conservazione</span>
                <span class="c1"># self.TABLE_FIELDS[22]: &quot;&#39;&quot; + str(self.comboBox_colore.currentText()) + &quot;&#39;&quot;,  # 20 - colore</span>
                <span class="c1"># self.TABLE_FIELDS[23]: &quot;&#39;&quot; + str(self.comboBox_consistenza.currentText()) + &quot;&#39;&quot;,  # 21 - consistenza</span>
                <span class="c1"># self.TABLE_FIELDS[24]: &quot;&#39;&quot; + str(self.comboBox_struttura.currentText()) + &quot;&#39;&quot;,  # 22 - struttura</span>
                <span class="c1"># self.TABLE_FIELDS[25]: &quot;&#39;&quot; + str(self.lineEdit_codice_periodo.text()) + &quot;&#39;&quot;,  # 23 - codice_periodo</span>
                <span class="c1"># self.TABLE_FIELDS[26]: &quot;&#39;&quot; + str(self.lineEditOrderLayer.text()) + &quot;&#39;&quot;,  # 24 - order layer</span>
                <span class="c1"># self.TABLE_FIELDS[28]: &quot;&#39;&quot; + str(self.comboBox_unita_tipo.currentText()) + &quot;&#39;&quot;,  # 24 - order layer</span>
                <span class="c1"># self.TABLE_FIELDS[29]: &quot;&#39;&quot; + str(self.comboBox_settore.currentText()) + &quot;&#39;&quot;,  # 24 - order layer</span>
                <span class="c1"># self.TABLE_FIELDS[30]: &quot;&#39;&quot; + str(self.lineEdit_quadrato.text()) + &quot;&#39;&quot;,  # 30 quadrato</span>
                <span class="c1"># self.TABLE_FIELDS[31]: &quot;&#39;&quot; + str(self.lineEdit_ambiente.text()) + &quot;&#39;&quot;,  # 30 quadrato</span>
                <span class="c1"># self.TABLE_FIELDS[32]: &quot;&#39;&quot; + str(self.lineEdit_saggio.text()) + &quot;&#39;&quot;,  # 30 quadrato</span>
                <span class="c1"># self.TABLE_FIELDS[33]: str(self.textEdit_elementi_datanti.toPlainText()),  # 6 - descrizione</span>
                <span class="c1"># self.TABLE_FIELDS[34]: &quot;&#39;&quot; + str(self.comboBox_funz_statica_usm.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># # 24 - order layer</span>
                <span class="c1"># self.TABLE_FIELDS[35]: &quot;&#39;&quot; + str(self.comboBox_lavorazione_usm.currentText()) + &quot;&#39;&quot;,  # 30 quadrato</span>
                <span class="c1"># self.TABLE_FIELDS[36]: &quot;&#39;&quot; + str(self.lineEdit_spessore_giunti_usm.text()) + &quot;&#39;&quot;,  # 30 quadrato</span>
                <span class="c1"># self.TABLE_FIELDS[37]: &quot;&#39;&quot; + str(self.lineEdit_letti_di_posa_giunti_usm.text()) + &quot;&#39;&quot;,</span>
                <span class="c1"># self.TABLE_FIELDS[38]: &quot;&#39;&quot; + str(self.lineEdit_h_modulo_c_corsi_usm.text()) + &quot;&#39;&quot;,</span>
                <span class="c1"># self.TABLE_FIELDS[39]: &quot;&#39;&quot; + str(self.comboBox_unita_edilizia_riassuntiva_usm.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># self.TABLE_FIELDS[40]: &quot;&#39;&quot; + str(self.comboBox_reimpiego_usm.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># self.TABLE_FIELDS[41]: &quot;&#39;&quot; + str(self.comboBox_posa_in_opera_usm.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># self.TABLE_FIELDS[42]: qmin_usm,</span>
                <span class="c1"># self.TABLE_FIELDS[43]: qmax_usm,</span>
                <span class="c1"># self.TABLE_FIELDS[44]: &quot;&#39;&quot; + str(self.comboBox_consistenza_legante_usm.currentText()) + &quot;&#39;&quot;,</span>
                <span class="c1"># self.TABLE_FIELDS[50]: &quot;&#39;&quot; + str(self.lineEdit_n_catalogo_generale.text()) + &quot;&#39;&quot;,</span>
            <span class="c1"># # 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
                <span class="c1"># self.TABLE_FIELDS[51]: &quot;&#39;&quot; + str(self.lineEdit_n_catalogo_interno.text()) + &quot;&#39;&quot;,</span>
            <span class="c1"># # 52 nr catalogo interno</span>
                <span class="c1"># self.TABLE_FIELDS[52]: &quot;&#39;&quot; + str(self.lineEdit_n_catalogo_internazionale.text()) + &quot;&#39;&quot;,</span>
            <span class="c1"># # 53 nr catalogo internazionale</span>
                <span class="c1"># self.TABLE_FIELDS[53]: &quot;&#39;&quot; + str(self.comboBox_soprintendenza.currentText()) + &quot;&#39;&quot;,</span>
            <span class="c1"># # 54 nr soprintendenza</span>
                <span class="c1"># self.TABLE_FIELDS[54]:  quota_relativa,  # 55 quota relativa</span>
                <span class="c1"># self.TABLE_FIELDS[55]:  quota_abs,  # 56 quota abs</span>
                <span class="c1"># self.TABLE_FIELDS[56]: &quot;&#39;&quot; + str(self.lineEdit_ref_tm.text()) + &quot;&#39;&quot;,  # 57 ref tm</span>
                <span class="c1"># self.TABLE_FIELDS[57]: &quot;&#39;&quot; + str(self.comboBox_ref_ra.currentText()) + &quot;&#39;&quot;,  # 58 ref ra</span>
                <span class="c1"># self.TABLE_FIELDS[58]: &quot;&#39;&quot; + str(self.lineEdit_ref_n.text()) + &quot;&#39;&quot;,  # 59 ref n</span>
                <span class="c1"># self.TABLE_FIELDS[59]: &quot;&#39;&quot; + str(self.comboBox_posizione.currentText()) + &quot;&#39;&quot;,  # 60 posizione</span>
                <span class="c1"># self.TABLE_FIELDS[60]: &quot;&#39;&quot; + str(self.lineEdit_criteri_distinzione.text()) + &quot;&#39;&quot;,</span>
            <span class="c1"># # 61 criteri distinzione</span>
                <span class="c1"># self.TABLE_FIELDS[61]: &quot;&#39;&quot; + str(self.comboBox_modo_formazione.currentText()) + &quot;&#39;&quot;,</span>
            <span class="c1"># # 62 modo formazione</span>
            <span class="c1"># #    self.TABLE_FIELDS[62]: &quot;&#39;&quot; + str(self.comboBox_componenti_organici.currentText()) + &quot;&#39;&quot;,</span>
            <span class="c1"># # 63 componenti organici</span>
            <span class="c1"># #    self.TABLE_FIELDS[63]: &quot;&#39;&quot; + str(self.comboBox_componenti_inorganici.currentText()) + &quot;&#39;&quot;,</span>
            <span class="c1"># # 64 componenti inorganici</span>
                <span class="c1"># self.TABLE_FIELDS[62]:lunghezza_max,  # 65</span>
                <span class="c1"># self.TABLE_FIELDS[63]:altezza_max,  # 66</span>
                <span class="c1"># self.TABLE_FIELDS[64]:altezza_min,  # 67</span>
                <span class="c1"># self.TABLE_FIELDS[65]:profondita_max,  # 68</span>
                <span class="c1"># self.TABLE_FIELDS[66]:profondita_min,  # 69</span>
                <span class="c1"># self.TABLE_FIELDS[67]:larghezza_media,  # 70</span>
                <span class="c1"># self.TABLE_FIELDS[68]:quota_max_abs,  # 71</span>
                <span class="c1"># self.TABLE_FIELDS[69]:quota_max_rel,  # 72</span>
                <span class="c1"># self.TABLE_FIELDS[70]:quota_min_abs,  # 73</span>
                <span class="c1"># self.TABLE_FIELDS[71]:quota_min_rel,  # 74</span>
                <span class="c1"># self.TABLE_FIELDS[72]: &quot;&#39;&quot; + str(self.textEdit_osservazioni.toPlainText()) + &quot;&#39;&quot;,  # 75 osservazioni</span>
                <span class="c1"># self.TABLE_FIELDS[73]: &quot;&#39;&quot; + str(self.comboBox_datazione.currentText()) + &quot;&#39;&quot;,  # 76 datazione</span>
                <span class="c1"># self.TABLE_FIELDS[74]: &quot;&#39;&quot; + str(self.comboBox_flottazione.currentText()) + &quot;&#39;&quot;,  # 77 flottazione</span>
                <span class="c1"># self.TABLE_FIELDS[75]: &quot;&#39;&quot; + str(self.comboBox_setacciatura.currentText()) + &quot;&#39;&quot;,  # 78 setacciatura</span>
                <span class="c1"># self.TABLE_FIELDS[76]: &quot;&#39;&quot; + str(self.comboBox_affidabilita.currentText()) + &quot;&#39;&quot;,  # 79 affidabilita</span>
                <span class="c1"># self.TABLE_FIELDS[77]: &quot;&#39;&quot; + str(self.comboBox_direttore_us.currentText()) + &quot;&#39;&quot;,  # 80 direttore us</span>
                <span class="c1"># self.TABLE_FIELDS[78]: &quot;&#39;&quot; + str(self.comboBox_responsabile_us.currentText()) + &quot;&#39;&quot;, # 81 responsabile us</span>
                <span class="c1"># self.TABLE_FIELDS[79]: &quot;&#39;&quot; + str(self.lineEdit_cod_ente_schedatore.text()) + &quot;&#39;&quot;, # 82 cod ente schedatore</span>
                <span class="c1"># self.TABLE_FIELDS[80]: &quot;&#39;&quot; + str(self.lineEdit_data_rilevazione.text()) + &quot;&#39;&quot;,  # 83 data rilevazione</span>
                <span class="c1"># self.TABLE_FIELDS[81]: &quot;&#39;&quot; + str(self.lineEdit_data_rielaborazione.text()) + &quot;&#39;&quot;, # 84 data rielaborazione</span>
                <span class="c1"># self.TABLE_FIELDS[82]: lunghezza_usm,  # 85</span>
                <span class="c1"># self.TABLE_FIELDS[83]: altezza_usm,  # 86</span>
                <span class="c1"># self.TABLE_FIELDS[84]: spessore_usm,  # 87</span>
                <span class="c1"># self.TABLE_FIELDS[85]: &quot;&#39;&quot; + str(self.comboBox_tecnica_muraria_usm.currentText()) + &quot;&#39;&quot;, # 88 tecnica muraria usm</span>
                <span class="c1"># self.TABLE_FIELDS[86]: &quot;&#39;&quot; + str(self.comboBox_modulo_usm.currentText()) + &quot;&#39;&quot;, # 89 modulo usm</span>
                <span class="c1"># self.TABLE_FIELDS[87]: &quot;&#39;&quot; + str(self.lineEdit_campioni_malta_usm.text()) + &quot;&#39;&quot;, # 90 campioni malta usm</span>
                <span class="c1"># self.TABLE_FIELDS[88]: &quot;&#39;&quot; + str(self.lineEdit_campioni_mattone_usm.text()) + &quot;&#39;&quot;, # 91 campioni mattone usm</span>
                <span class="c1"># self.TABLE_FIELDS[89]: &quot;&#39;&quot; + str(self.lineEdit_campioni_pietra_usm.text()) + &quot;&#39;&quot;, # 92 campioni pietra usm</span>
                <span class="c1"># self.TABLE_FIELDS[90]: &quot;&#39;&quot; + str(self.lineEdit_provenienza_materiali_usm.text()) + &quot;&#39;&quot;, # 93 provenienza_materiali_usm</span>
                <span class="c1"># self.TABLE_FIELDS[91]: &quot;&#39;&quot; + str(self.lineEdit_criteri_distinzione_usm.text()) + &quot;&#39;&quot;, # 94 criteri distinzione usm</span>
                <span class="c1"># self.TABLE_FIELDS[92]: &quot;&#39;&quot; + str(self.comboBox_uso_primario_usm.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[93]: &quot;&#39;&quot; + str(self.comboBox_tipologia_opera.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[94]: &quot;&#39;&quot; + str(self.comboBox_sezione_muraria.currentText()) + &quot;&#39;&quot; , # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[95]: &quot;&#39;&quot; + str(self.comboBox_superficie_analizzata.currentText()) + &quot;&#39;&quot; , # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[96]: &quot;&#39;&quot; + str(self.comboBox_orientamento.currentText()) + &quot;&#39;&quot; , # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[97]: &quot;&#39;&quot; + str(self.comboBox_materiali_lat.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[98]: &quot;&#39;&quot; + str(self.comboBox_lavorazione_lat.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[99]: &quot;&#39;&quot; + str(self.comboBox_consistenza_lat.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[100]: &quot;&#39;&quot; + str(self.comboBox_forma_lat.currentText()) + &quot;&#39;&quot; , # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[101]: &quot;&#39;&quot; + str(self.comboBox_colore_lat.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[102]: &quot;&#39;&quot; + str(self.comboBox_impasto_lat.currentText()) + &quot;&#39;&quot;, # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[103]: &quot;&#39;&quot; + str(self.comboBox_forma_p.currentText()) + &quot;&#39;&quot; , # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[104]: &quot;&#39;&quot; + str(self.comboBox_colore_p.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[105]: &quot;&#39;&quot; + str(self.comboBox_taglio_p.currentText()) + &quot;&#39;&quot; , # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[106]: &quot;&#39;&quot; + str(self.comboBox_posa_opera_p.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[107]: &quot;&#39;&quot; + str(self.comboBox_inerti_usm.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[108]: &quot;&#39;&quot; + str(self.comboBox_tipo_legante_usm.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[109]: &quot;&#39;&quot; + str(self.comboBox_rifinitura_usm.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[110]: &quot;&#39;&quot; + str(self.comboBox_materiale_p.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
                <span class="c1"># self.TABLE_FIELDS[111]: &quot;&#39;&quot; + str(self.comboBox_consistenza_p.currentText()) + &quot;&#39;&quot;,  # 95 uso primario usm</span>
            <span class="c1"># }</span>
            <span class="c1"># u = Utility()</span>
            <span class="c1"># search_dict = u.remove_empty_items_fr_dict(search_dict)</span>
            <span class="c1"># if not bool(search_dict):</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Non √® stata impostata nessuna ricerca!!!&quot;, QMessageBox.Ok)</span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Keine Abfrage definiert!!!&quot;, QMessageBox.Ok)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot; WARNING&quot;, &quot;No search has been set!!!&quot;, QMessageBox.Ok)      </span>
            <span class="c1"># else:</span>
                <span class="c1"># res = self.DB_MANAGER.query_bool(search_dict, self.MAPPER_TABLE_CLASS)</span>
                <span class="c1"># if not bool(res):</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Non √® stato trovato nessun record!&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Keinen Record gefunden!&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;WARNING&quot;, &quot;No record found!&quot;, QMessageBox.Ok)        </span>
                    <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
                    <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_unita_tipo&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.textEdit_descrizione&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.textEdit_interpretazione&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setTableEnable(</span>
                        <span class="c1"># [&quot;self.tableWidget_campioni&quot;, &quot;self.tableWidget_rapporti&quot;, &quot;self.tableWidget_inclusi&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_organici&quot;, &quot;self.tableWidget_inorganici&quot;, &quot;self.tableWidget_documentazione&quot;,&quot;self.tableWidget_rapporti2&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># self.DATA_LIST = []</span>
                    <span class="c1"># for i in res:</span>
                        <span class="c1"># self.DATA_LIST.append(i)</span>
                    <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), 0</span>
                    <span class="c1"># self.DATA_LIST_REC_TEMP = self.DATA_LIST_REC_CORR = self.DATA_LIST[0]</span>
                    <span class="c1"># self.fill_fields()</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.set_rec_counter(len(self.DATA_LIST), self.REC_CORR + 1)</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># if self.REC_TOT == 1:</span>
                            <span class="c1"># strings = (&quot;E&#39; stato trovato&quot;, self.REC_TOT, &quot;record&quot;)</span>
                            <span class="c1"># if self.toolButtonGis.isChecked():</span>
                                <span class="c1"># self.pyQGIS.charge_vector_layers(self.DATA_LIST)</span>
                            <span class="c1"># if self.toolButton_usm.isChecked():    </span>
                                <span class="c1"># self.pyQGIS.charge_usm_layers(self.DATA_LIST)</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># strings = (&quot;Sono stati trovati&quot;, self.REC_TOT, &quot;records&quot;)</span>
                            <span class="c1"># if self.toolButtonGis.isChecked():</span>
                                <span class="c1"># self.pyQGIS.charge_vector_layers(self.DATA_LIST)</span>
                            <span class="c1"># if self.toolButton_usm.isChecked():    </span>
                                <span class="c1"># self.pyQGIS.charge_usm_layers(self.DATA_LIST)</span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># if self.REC_TOT == 1:</span>
                            <span class="c1"># strings = (&quot;Es wurde gefunden&quot;, self.REC_TOT, &quot;record&quot;)</span>
                            <span class="c1"># if self.toolButtonGis.isChecked():</span>
                                <span class="c1"># self.pyQGIS.charge_vector_layers(self.DATA_LIST)</span>
                            <span class="c1"># if self.toolButton_usm.isChecked():    </span>
                                <span class="c1"># self.pyQGIS.charge_usm_layers(self.DATA_LIST)</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># strings = (&quot;Sie wurden gefunden&quot;, self.REC_TOT, &quot;records&quot;)</span>
                            <span class="c1"># if self.toolButtonGis.isChecked():</span>
                                <span class="c1"># self.pyQGIS.charge_vector_layers(self.DATA_LIST)</span>
                            <span class="c1"># if self.toolButton_usm.isChecked():    </span>
                                <span class="c1"># self.pyQGIS.charge_usm_layers(self.DATA_LIST)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># if self.REC_TOT == 1:</span>
                            <span class="c1"># strings = (&quot;It has been found&quot;, self.REC_TOT, &quot;record&quot;)</span>
                            <span class="c1"># if self.toolButtonGis.isChecked():</span>
                                <span class="c1"># self.pyQGIS.charge_vector_layers(self.DATA_LIST)</span>
                            <span class="c1"># if self.toolButton_usm.isChecked():    </span>
                                <span class="c1"># self.pyQGIS.charge_usm_layers(self.DATA_LIST)</span>
                        <span class="c1"># else:</span>
                            <span class="c1"># strings = (&quot;They have been found&quot;, self.REC_TOT, &quot;records&quot;)</span>
                            <span class="c1"># if self.toolButtonGis.isChecked():</span>
                                <span class="c1"># self.pyQGIS.charge_vector_layers(self.DATA_LIST)</span>
                            <span class="c1"># if self.toolButton_usm.isChecked():    </span>
                                <span class="c1"># self.pyQGIS.charge_usm_layers(self.DATA_LIST)</span>
                    
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_unita_tipo&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setTableEnable(</span>
                        <span class="c1"># [&quot;self.tableWidget_campioni&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_rapporti&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inclusi&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_organici&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inorganici&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_documentazione&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inclusi_materiali_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_colore_legante_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_inclusi_leganti_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_consistenza_texture_mat_usm&quot;,</span>
                         <span class="c1"># &quot;self.tableWidget_colore_materiale_usm&quot;,&quot;self.tableWidget_rapporti2&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.textEdit_descrizione&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.textEdit_interpretazione&quot;], &quot;True&quot;)</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;, &quot;%s %d %s&quot; % strings, QMessageBox.Ok)</span>
        <span class="c1"># self.enable_button_search(1)</span>
    <span class="c1"># def update_if(self, msg):</span>
        <span class="c1"># rec_corr = self.REC_CORR</span>
        <span class="c1"># if msg == QMessageBox.Ok:</span>
            <span class="c1"># test = self.update_record()</span>
            <span class="c1"># if test == 1:</span>
                <span class="c1"># id_list = []</span>
                <span class="c1"># for i in self.DATA_LIST:</span>
                    <span class="c1"># id_list.append(eval(&quot;i.&quot; + self.ID_TABLE))</span>
                <span class="c1"># self.DATA_LIST = []</span>
                <span class="c1"># if self.SORT_STATUS == &quot;n&quot;:</span>
                    <span class="c1"># temp_data_list = self.DB_MANAGER.query_sort(id_list, [self.ID_TABLE], &#39;asc&#39;,</span>
                                                                <span class="c1"># self.MAPPER_TABLE_CLASS,</span>
                                                                <span class="c1"># self.ID_TABLE)  </span>
                <span class="c1"># else:</span>
                    <span class="c1"># temp_data_list = self.DB_MANAGER.query_sort(id_list, self.SORT_ITEMS_CONVERTED, self.SORT_MODE,</span>
                                                                <span class="c1"># self.MAPPER_TABLE_CLASS, self.ID_TABLE)</span>
                <span class="c1"># for i in temp_data_list:</span>
                    <span class="c1"># self.DATA_LIST.append(i)</span>
                <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                <span class="c1"># if type(self.REC_CORR) == &quot;&lt;type &#39;str&#39;&gt;&quot;:</span>
                    <span class="c1"># corr = 0</span>
                <span class="c1"># else:</span>
                    <span class="c1"># corr = self.REC_CORR</span>
                <span class="c1"># return 1</span>
            <span class="c1"># elif test == 0:</span>
                <span class="c1"># return 0</span>
    <span class="c1"># def update_record(self):</span>
        <span class="c1"># try:</span>
            <span class="c1"># self.DB_MANAGER.update(self.MAPPER_TABLE_CLASS,</span>
                                   <span class="c1"># self.ID_TABLE,</span>
                                   <span class="c1"># [eval(&quot;int(self.DATA_LIST[self.REC_CORR].&quot; + self.ID_TABLE + &quot;)&quot;)],</span>
                                   <span class="c1"># self.TABLE_FIELDS,</span>
                                   <span class="c1"># self.rec_toupdate())</span>
            <span class="c1"># return 1</span>
        <span class="c1"># except Exception as e:</span>
            <span class="c1"># str(e)</span>
            <span class="c1"># save_file=&#39;{}{}{}&#39;.format(self.HOME, os.sep,&quot;pyarchinit_Report_folder&quot;) </span>
            <span class="c1"># file_=os.path.join(save_file,&#39;error_encodig_data_recover.txt&#39;)</span>
            <span class="c1"># with open(file_, &quot;a&quot;) as fh:</span>
                <span class="c1"># try:</span>
                    <span class="c1"># raise ValueError(str(e))</span>
                <span class="c1"># except ValueError as s:</span>
                    <span class="c1"># print(s, file=fh)</span>
            <span class="c1"># if self.L==&#39;it&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;,</span>
                                    <span class="c1"># &quot;Problema di encoding: sono stati inseriti accenti o caratteri non accettati dal database. Verr√† fatta una copia dell&#39;errore con i dati che puoi recuperare nella cartella pyarchinit_Report _Folder&quot;, QMessageBox.Ok)</span>
            
            
            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;Encoding problem: accents or characters not accepted by the database were entered. A copy of the error will be made with the data you can retrieve in the pyarchinit_Report _Folder&quot;, QMessageBox.Ok) </span>
            <span class="c1"># else:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;Kodierungsproblem: Es wurden Akzente oder Zeichen eingegeben, die von der Datenbank nicht akzeptiert werden. Es wird eine Kopie des Fehlers mit den Daten erstellt, die Sie im pyarchinit_Report _Ordner abrufen k√∂nnen&quot;, QMessageBox.Ok)                                 </span>
            
            
            
            <span class="c1"># return 0</span>
    <span class="c1"># def rec_toupdate(self):</span>
        <span class="c1"># rec_to_update = self.UTILITY.pos_none_in_list(self.DATA_LIST_REC_TEMP)</span>
        <span class="c1"># return rec_to_update</span>
        <span class="c1"># # custom functions</span>
    <span class="c1"># def charge_records(self):</span>
        <span class="c1"># self.DATA_LIST = []</span>
        <span class="c1"># if self.DB_SERVER == &#39;sqlite&#39;:</span>
            <span class="c1"># for i in self.DB_MANAGER.query(self.MAPPER_TABLE_CLASS):</span>
                <span class="c1"># self.DATA_LIST.append(i)</span>
        <span class="c1"># else:</span>
            <span class="c1"># id_list = []</span>
            <span class="c1"># for i in self.DB_MANAGER.query(self.MAPPER_TABLE_CLASS):</span>
                <span class="c1"># id_list.append(eval(&quot;i.&quot; + self.ID_TABLE))</span>
            <span class="c1"># temp_data_list = self.DB_MANAGER.query_sort(id_list, [self.ID_TABLE], &#39;asc&#39;, self.MAPPER_TABLE_CLASS,</span>
                                                        <span class="c1"># self.ID_TABLE)</span>
            <span class="c1"># for i in temp_data_list:</span>
                <span class="c1"># self.DATA_LIST.append(i)</span>
    <span class="c1"># def datestrfdate(self):</span>
        <span class="c1"># now = date.today()</span>
        <span class="c1"># today = now.strftime(&quot;%d-%m-%Y&quot;)</span>
        <span class="c1"># return today</span>
    <span class="c1"># def yearstrfdate(self):</span>
        <span class="c1"># now = date.today()</span>
        <span class="c1"># year = now.strftime(&quot;%Y&quot;)</span>
        <span class="c1"># return year</span>
    <span class="c1"># def table2dict(self, n):</span>
        <span class="c1"># self.tablename = n</span>
        <span class="c1"># row = eval(self.tablename + &quot;.rowCount()&quot;)</span>
        <span class="c1"># col = eval(self.tablename + &quot;.columnCount()&quot;)</span>
        <span class="c1"># lista = []</span>
        <span class="c1"># for r in range(row):</span>
            <span class="c1"># sub_list = []</span>
            <span class="c1"># for c in range(col):</span>
                <span class="c1"># value = eval(self.tablename + &quot;.item(r,c)&quot;)</span>
                <span class="c1"># if value != None:</span>
                    <span class="c1"># sub_list.append(str(value.text()))</span>
            <span class="c1"># if bool(sub_list):</span>
                <span class="c1"># lista.append(sub_list)</span>
        <span class="c1"># return lista</span>
    <span class="c1"># def tableInsertData(self, t, d):</span>
        <span class="c1"># &quot;&quot;&quot;Set the value into alls Grid&quot;&quot;&quot;</span>
        <span class="c1"># self.table_name = t</span>
        <span class="c1"># self.data_list = eval(d)</span>
        <span class="c1"># self.data_list.sort()</span>
        <span class="c1"># # column table count</span>
        <span class="c1"># table_col_count_cmd = &quot;{}.columnCount()&quot;.format(self.table_name)</span>
        <span class="c1"># table_col_count = eval(table_col_count_cmd)</span>
        <span class="c1"># # clear table</span>
        <span class="c1"># table_clear_cmd = &quot;{}.clearContents()&quot;.format(self.table_name)</span>
        <span class="c1"># eval(table_clear_cmd)</span>
        <span class="c1"># for i in range(table_col_count):</span>
            <span class="c1"># table_rem_row_cmd = &quot;{}.removeRow(int({}))&quot;.format(self.table_name, i)</span>
            <span class="c1"># eval(table_rem_row_cmd)</span>
        <span class="c1"># for row in range(len(self.data_list)):</span>
            <span class="c1"># cmd = &#39;{}.insertRow(int({}))&#39;.format(self.table_name, row)</span>
            <span class="c1"># eval(cmd)</span>
            <span class="c1"># for col in range(len(self.data_list[row])):</span>
                <span class="c1"># # item = self.comboBox_sito.setEditText(self.data_list[0][col]</span>
                <span class="c1"># # item = QTableWidgetItem(self.data_list[row][col])</span>
                <span class="c1"># # TODO SL: evauation of QTableWidget does not work porperly</span>
                <span class="c1"># exec_str = &#39;{}.setItem(int({}),int({}),QTableWidgetItem(self.data_list[row][col]))&#39;.format(self.table_name, row, col)</span>
                <span class="c1"># eval(exec_str)</span>
        <span class="c1"># max_row_num = len(self.data_list)</span>
        <span class="c1"># value = eval(self.table_name+&quot;.item(max_row_num,1)&quot;)</span>
        <span class="c1"># if value == &#39;&#39;:</span>
            <span class="c1"># cmd = (&quot;%s.removeRow(%d)&quot;) % (self.table_name, max_row_num)</span>
            <span class="c1"># eval(cmd)</span>
    <span class="c1"># def insert_new_row(self, table_name):</span>
        <span class="c1"># &quot;&quot;&quot;insert new row into a table based on table_name&quot;&quot;&quot;</span>
        <span class="c1"># cmd = table_name + &quot;.insertRow(0)&quot;</span>
        <span class="c1"># eval(cmd)</span>
    <span class="c1"># def remove_row(self, table_name):</span>
        <span class="c1"># &quot;&quot;&quot;insert new row into a table based on table_name&quot;&quot;&quot;</span>
        <span class="c1"># table_row_count_cmd = (&quot;%s.rowCount()&quot;) % (table_name)</span>
        <span class="c1"># table_row_count = eval(table_row_count_cmd)</span>
        <span class="c1"># rowSelected_cmd = (&quot;%s.selectedIndexes()&quot;) % (table_name)</span>
        <span class="c1"># rowSelected = eval(rowSelected_cmd)</span>
        <span class="c1"># rowIndex = (rowSelected[0].row())</span>
        <span class="c1"># cmd = (&quot;%s.removeRow(%d)&quot;) % (table_name, rowIndex)</span>
        <span class="c1"># eval(cmd)</span>
    <span class="c1"># def empty_fields(self):</span>
        <span class="c1"># rapporti_row_count = self.tableWidget_rapporti.rowCount()</span>
        <span class="c1"># rapporti_row_count2 = self.tableWidget_rapporti2.rowCount()</span>
        <span class="c1"># campioni_row_count = self.tableWidget_campioni.rowCount()</span>
        <span class="c1"># inclusi_row_count = self.tableWidget_inclusi.rowCount()</span>
        <span class="c1"># organici_row_count = self.tableWidget_organici.rowCount()</span>
        <span class="c1"># inorganici_row_count = self.tableWidget_inorganici.rowCount()</span>
        <span class="c1"># documentazione_row_count = self.tableWidget_documentazione.rowCount()</span>
        <span class="c1"># self.comboBox_sito.setEditText(&quot;&quot;)  # 1 - Sito</span>
        <span class="c1"># self.comboBox_area.setEditText(&quot;&quot;)  # 2 - Area</span>
        <span class="c1"># self.lineEdit_us.clear()  # 3 - US</span>
        <span class="c1"># self.comboBox_def_strat.setEditText(&quot;&quot;)  # 4 - Definizione stratigrafica</span>
        <span class="c1"># self.comboBox_def_intepret.setEditText(&quot;&quot;)  # 5 - Definizione intepretata</span>
        <span class="c1"># self.textEdit_descrizione.clear()  # 6 - descrizione</span>
        <span class="c1"># self.textEdit_interpretazione.clear()  # 7 - interpretazione</span>
        <span class="c1"># self.comboBox_per_iniz.setEditText(&quot;&quot;)  # 8 - periodo iniziale</span>
        <span class="c1"># self.comboBox_fas_iniz.setEditText(&quot;&quot;)  # 9 - fase iniziale</span>
        <span class="c1"># self.comboBox_per_fin.setEditText(&quot;&quot;)  # 10 - periodo finale iniziale</span>
        <span class="c1"># self.comboBox_fas_fin.setEditText(&quot;&quot;)  # 11 - fase finale</span>
        <span class="c1"># self.comboBox_scavato.setEditText(&quot;&quot;)  # 12 - scavato</span>
        <span class="c1"># self.lineEdit_attivita.clear()  # 13 - attivita</span>
        <span class="c1"># if self.BROWSE_STATUS == &quot;n&quot;:</span>
            <span class="c1"># self.lineEdit_anno.setText(self.yearstrfdate())  # 14 - anno scavo</span>
        <span class="c1"># else:</span>
            <span class="c1"># self.lineEdit_anno.clear()</span>
        <span class="c1"># self.comboBox_metodo.setEditText(&quot;&quot;)  # 15 - metodo</span>
        <span class="c1"># for i in range(inclusi_row_count):</span>
            <span class="c1"># self.tableWidget_inclusi.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_inclusi&quot;)  # 16 - inclusi</span>
        <span class="c1"># for i in range(campioni_row_count):</span>
            <span class="c1"># self.tableWidget_campioni.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_campioni&quot;)  # 17 - campioni</span>
        <span class="c1"># for i in range(organici_row_count):</span>
            <span class="c1"># self.tableWidget_organici.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_organici&quot;)  # organici</span>
        <span class="c1"># for i in range(inorganici_row_count):</span>
            <span class="c1"># self.tableWidget_inorganici.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_inorganici&quot;)  # inorganici</span>
        <span class="c1"># for i in range(rapporti_row_count):</span>
            <span class="c1"># self.tableWidget_rapporti.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_rapporti&quot;)                #18 - rapporti</span>
        <span class="c1"># for i in range(documentazione_row_count):</span>
            <span class="c1"># self.tableWidget_documentazione.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_documentazione&quot;)  # 19 - documentazione</span>
        <span class="c1"># for i in range(rapporti_row_count2):</span>
            <span class="c1"># self.tableWidget_rapporti2.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_rapporti2&quot;)</span>
        
        <span class="c1"># colore_legante_usm_row_count = self.tableWidget_colore_legante_usm.rowCount()</span>
        <span class="c1"># for i in range(colore_legante_usm_row_count):</span>
            <span class="c1"># self.tableWidget_colore_legante_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_colore_legante_usm&quot;)  # 19 - aggregati</span>
        <span class="c1"># inclusi_leganti_usm_row_count = self.tableWidget_inclusi_leganti_usm.rowCount()</span>
        <span class="c1"># for i in range(inclusi_leganti_usm_row_count):</span>
            <span class="c1"># self.tableWidget_inclusi_leganti_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_inclusi_leganti_usm&quot;)  # 19 - aggregati</span>
        <span class="c1"># cont_text_mat_row_count = self.tableWidget_consistenza_texture_mat_usm.rowCount()</span>
        <span class="c1"># for i in range(cont_text_mat_row_count):</span>
            <span class="c1"># self.tableWidget_consistenza_texture_mat_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_consistenza_texture_mat_usm&quot;)  # 19 - colore legante usm</span>
        <span class="c1"># aggreg_inclusi_materiale_row_count = self.tableWidget_inclusi_materiali_usm.rowCount()</span>
        <span class="c1"># for i in range(aggreg_inclusi_materiale_row_count):</span>
            <span class="c1"># self.tableWidget_inclusi_materiali_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_inclusi_materiali_usm&quot;)  # 19 - aggregati</span>
        <span class="c1"># colore_materiali_usm_row_count = self.tableWidget_colore_materiale_usm.rowCount()</span>
        <span class="c1"># for i in range(colore_materiali_usm_row_count):</span>
            <span class="c1"># self.tableWidget_colore_materiale_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_colore_materiale_usm&quot;)  # 19 - aggregati</span>
        <span class="c1"># if self.BROWSE_STATUS == &quot;n&quot;:</span>
            <span class="c1"># self.lineEdit_data_schedatura.setText(self.datestrfdate())  # 20 - data schedatura</span>
        <span class="c1"># else:</span>
            <span class="c1"># self.lineEdit_data_schedatura.setText(&quot;&quot;)  # 20 - data schedatura</span>
       
        <span class="c1"># self.comboBox_schedatore.setEditText(&quot;&quot;)  # 21 - schedatore</span>
        <span class="c1"># self.comboBox_formazione.setEditText(&quot;&quot;)  # 22 - formazione</span>
        <span class="c1"># self.comboBox_conservazione.setEditText(&quot;&quot;)  # 23 - conservazione</span>
        <span class="c1"># self.comboBox_colore.setEditText(&quot;&quot;)  # 24 - colore</span>
        <span class="c1"># self.comboBox_consistenza.setEditText(&quot;&quot;)  # 25 - consistenza</span>
        <span class="c1"># self.comboBox_struttura.setEditText(&quot;&quot;)  # 26 - struttura</span>
        <span class="c1"># self.lineEdit_codice_periodo.clear()  # 27 - codice periodo</span>
        <span class="c1"># self.lineEditOrderLayer.clear()  # 28 - order layer</span>
        <span class="c1"># self.comboBox_unita_tipo.setEditText(&quot;&quot;)  # 29 us_tipo            NUOVI CAMPI NUOVI CAMPI</span>
        <span class="c1"># self.comboBox_settore.setEditText(&quot;&quot;)  # 30 settore</span>
        <span class="c1"># self.lineEdit_quadrato.clear()  # 31 quadrato</span>
        <span class="c1"># self.lineEdit_ambiente.clear()  # 32 ambiente</span>
        <span class="c1"># self.lineEdit_saggio.clear()  # 33 saggio</span>
        <span class="c1"># self.textEdit_elementi_datanti.clear()  # 34 elementi datanti</span>
        <span class="c1"># self.comboBox_funz_statica_usm.setEditText(&quot;&quot;)  # 35 funzione statica</span>
        <span class="c1"># self.comboBox_lavorazione_usm.setEditText(&quot;&quot;)  # 36 lavorazione usm</span>
        <span class="c1"># self.lineEdit_spessore_giunti_usm.clear()  # 37 spessore giunti</span>
        <span class="c1"># self.lineEdit_letti_di_posa_giunti_usm.clear()  # 38 letti posa giunti usm</span>
        <span class="c1"># self.lineEdit_h_modulo_c_corsi_usm.clear()  # 39 altezza modulo corsi usm</span>
        <span class="c1"># self.comboBox_unita_edilizia_riassuntiva_usm.setEditText(&quot;&quot;)  # 40 unita edilizia riassuntiva</span>
        <span class="c1"># self.comboBox_reimpiego_usm.setEditText(&quot;&quot;)  # 41 unita edilizia riassuntiva</span>
        <span class="c1"># self.comboBox_posa_in_opera_usm.setEditText(&quot;&quot;)  # 42 posa in opera</span>
        <span class="c1"># self.lineEdit_qmin_usm.clear()  # 3 - US</span>
        <span class="c1"># self.lineEdit_qmax_usm.clear()  # 3 - US</span>
        <span class="c1"># self.comboBox_consistenza_legante_usm.setEditText(&quot;&quot;)  # 45 consitenza legante usm</span>
        <span class="c1"># self.lineEdit_n_catalogo_generale.clear()  # 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
        <span class="c1"># self.lineEdit_n_catalogo_interno.clear()  # 52 nr catalogo interno</span>
        <span class="c1"># self.lineEdit_n_catalogo_internazionale.clear()  # 53 nr catalogo internazionale</span>
        <span class="c1"># self.comboBox_soprintendenza.setEditText(&quot;&quot;)  # 54 nr soprintendenza</span>
        <span class="c1"># self.lineEdit_quota_relativa.clear()  # 55</span>
        <span class="c1"># self.lineEdit_quota_abs.clear()  # 56</span>
        <span class="c1"># self.lineEdit_ref_tm.clear()  # 57 ref tm</span>
        <span class="c1"># self.comboBox_ref_ra.setEditText(&quot;&quot;)   # 58 ref ra</span>
        <span class="c1"># self.lineEdit_ref_n.clear()  # 59 ref n</span>
        <span class="c1"># self.comboBox_posizione.setEditText(&quot;&quot;)  # 60 posizione</span>
        <span class="c1"># self.lineEdit_criteri_distinzione.clear()  # 61 criteri distinzione</span>
        <span class="c1"># self.comboBox_modo_formazione.setEditText(&quot;&quot;)  # 62 modo formazione</span>
        <span class="c1"># #self.comboBox_componenti_organici.setEditText(&quot;&quot;)  # 63 componenti organici</span>
        <span class="c1"># #self.comboBox_componenti_inorganici.setEditText(&quot;&quot;)  # 64 componenti inorganici</span>
        <span class="c1"># self.lineEdit_lunghezza_max.clear()  # 65</span>
        <span class="c1"># self.lineEdit_altezza_max.clear()  # 66</span>
        <span class="c1"># self.lineEdit_altezza_min.clear()  # 67</span>
        <span class="c1"># self.lineEdit_profondita_max.clear()  # 68</span>
        <span class="c1"># self.lineEdit_profondita_min.clear()  # 69</span>
        <span class="c1"># self.lineEdit_larghezza_media.clear()  # 70</span>
        <span class="c1"># self.lineEdit_quota_max_abs.clear()  # 71</span>
        <span class="c1"># self.lineEdit_quota_max_rel.clear()  # 72</span>
        <span class="c1"># self.lineEdit_quota_min_abs.clear()  # 73</span>
        <span class="c1"># self.lineEdit_quota_min_rel.clear()  # 74</span>
        <span class="c1"># self.textEdit_osservazioni.clear()  # 75 osservazioni</span>
        <span class="c1"># self.comboBox_datazione.setEditText(&quot;&quot;)  # 76 datazione</span>
        <span class="c1"># self.comboBox_flottazione.setEditText(&quot;&quot;)  # 77 flottazione</span>
        <span class="c1"># self.comboBox_setacciatura.setEditText(&quot;&quot;)   # 78 setacciatura</span>
        <span class="c1"># self.comboBox_affidabilita.setEditText(&quot;&quot;)   # 79 affidabilita</span>
        <span class="c1"># self.comboBox_direttore_us.setEditText(&quot;&quot;)  # 80 direttore us</span>
        <span class="c1"># self.comboBox_responsabile_us.setEditText(&quot;&quot;)  # 81 responsabile us</span>
        <span class="c1"># self.lineEdit_cod_ente_schedatore.clear()  # 82 cod ente schedatore</span>
        <span class="c1"># self.lineEdit_data_rilevazione.clear()  # 83 data rilevazione</span>
        <span class="c1"># self.lineEdit_data_rielaborazione.clear()  # 84 data rielaborazione</span>
        <span class="c1"># self.lineEdit_lunghezza_usm.clear()  # 85</span>
        <span class="c1"># self.lineEdit_altezza_usm.clear()  # 86</span>
        <span class="c1"># self.lineEdit_spessore_usm.clear()  # 87</span>
        <span class="c1"># self.comboBox_tecnica_muraria_usm.setEditText(&quot;&quot;)  # 88 tecnica muraria usm</span>
        <span class="c1"># self.comboBox_modulo_usm.setEditText(&quot;&quot;)  # 89 modulo usm</span>
        <span class="c1"># self.lineEdit_campioni_malta_usm.clear()  # 90 campioni malta usm</span>
        <span class="c1"># self.lineEdit_campioni_mattone_usm.clear()  # 91 campioni mattone usm</span>
        <span class="c1"># self.lineEdit_campioni_pietra_usm.clear()  # 92 campioni pietra usm</span>
        <span class="c1"># self.lineEdit_provenienza_materiali_usm.clear()  # 93 provenienza_materiali_usm</span>
        <span class="c1"># self.lineEdit_criteri_distinzione_usm.clear()  # 94 criteri distinzione usm</span>
        <span class="c1"># self.comboBox_uso_primario_usm.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_tipologia_opera.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_sezione_muraria.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_superficie_analizzata.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_orientamento.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_materiali_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_lavorazione_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_consistenza_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_forma_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_colore_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_impasto_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_forma_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_colore_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_taglio_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_posa_opera_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_inerti_usm.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_tipo_legante_usm.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_rifinitura_usm.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_materiale_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_consistenza_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.mQgsFileWidget.clear()</span>
    <span class="c1"># def empty_fields_nosite(self):</span>
        <span class="c1"># rapporti_row_count = self.tableWidget_rapporti.rowCount()</span>
        <span class="c1"># rapporti_row_count2 = self.tableWidget_rapporti2.rowCount()</span>
        <span class="c1"># campioni_row_count = self.tableWidget_campioni.rowCount()</span>
        <span class="c1"># inclusi_row_count = self.tableWidget_inclusi.rowCount()</span>
        <span class="c1"># organici_row_count = self.tableWidget_organici.rowCount()</span>
        <span class="c1"># inorganici_row_count = self.tableWidget_inorganici.rowCount()</span>
        <span class="c1"># documentazione_row_count = self.tableWidget_documentazione.rowCount()</span>
        
        <span class="c1"># self.comboBox_area.setEditText(&quot;&quot;)  # 2 - Area</span>
        <span class="c1"># self.lineEdit_us.clear()  # 3 - US</span>
        <span class="c1"># self.comboBox_def_strat.setEditText(&quot;&quot;)  # 4 - Definizione stratigrafica</span>
        <span class="c1"># self.comboBox_def_intepret.setEditText(&quot;&quot;)  # 5 - Definizione intepretata</span>
        <span class="c1"># self.textEdit_descrizione.clear()  # 6 - descrizione</span>
        <span class="c1"># self.textEdit_interpretazione.clear()  # 7 - interpretazione</span>
        <span class="c1"># self.comboBox_per_iniz.setEditText(&quot;&quot;)  # 8 - periodo iniziale</span>
        <span class="c1"># self.comboBox_fas_iniz.setEditText(&quot;&quot;)  # 9 - fase iniziale</span>
        <span class="c1"># self.comboBox_per_fin.setEditText(&quot;&quot;)  # 10 - periodo finale iniziale</span>
        <span class="c1"># self.comboBox_fas_fin.setEditText(&quot;&quot;)  # 11 - fase finale</span>
        <span class="c1"># self.comboBox_scavato.setEditText(&quot;&quot;)  # 12 - scavato</span>
        <span class="c1"># self.lineEdit_attivita.clear()  # 13 - attivita</span>
        <span class="c1"># if self.BROWSE_STATUS == &quot;n&quot;:</span>
            <span class="c1"># self.lineEdit_anno.setText(self.yearstrfdate())  # 14 - anno scavo</span>
        <span class="c1"># else:</span>
            <span class="c1"># self.lineEdit_anno.clear()</span>
        <span class="c1"># self.comboBox_metodo.setEditText(&quot;&quot;)  # 15 - metodo</span>
        <span class="c1"># for i in range(inclusi_row_count):</span>
            <span class="c1"># self.tableWidget_inclusi.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_inclusi&quot;)  # 16 - inclusi</span>
        <span class="c1"># for i in range(campioni_row_count):</span>
            <span class="c1"># self.tableWidget_campioni.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_campioni&quot;)  # 17 - campioni</span>
        <span class="c1"># for i in range(organici_row_count):</span>
            <span class="c1"># self.tableWidget_organici.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_organici&quot;)  # organici</span>
        <span class="c1"># for i in range(inorganici_row_count):</span>
            <span class="c1"># self.tableWidget_inorganici.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_inorganici&quot;)  # inorganici</span>
        <span class="c1"># for i in range(rapporti_row_count):</span>
            <span class="c1"># self.tableWidget_rapporti.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_rapporti&quot;)                #18 - rapporti</span>
        <span class="c1"># for i in range(documentazione_row_count):</span>
            <span class="c1"># self.tableWidget_documentazione.removeRow(0)</span>
        <span class="c1"># for i in range(rapporti_row_count2):</span>
            <span class="c1"># self.tableWidget_rapporti2.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_rapporti2&quot;)     </span>
        
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_documentazione&quot;)  # 19 - documentazione</span>
        <span class="c1"># colore_legante_usm_row_count = self.tableWidget_colore_legante_usm.rowCount()</span>
        <span class="c1"># for i in range(colore_legante_usm_row_count):</span>
            <span class="c1"># self.tableWidget_colore_legante_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_colore_legante_usm&quot;)  # 19 - aggregati</span>
        <span class="c1"># inclusi_leganti_usm_row_count = self.tableWidget_inclusi_leganti_usm.rowCount()</span>
        <span class="c1"># for i in range(inclusi_leganti_usm_row_count):</span>
            <span class="c1"># self.tableWidget_inclusi_leganti_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_inclusi_leganti_usm&quot;)  # 19 - aggregati</span>
        <span class="c1"># cont_text_mat_row_count = self.tableWidget_consistenza_texture_mat_usm.rowCount()</span>
        <span class="c1"># for i in range(cont_text_mat_row_count):</span>
            <span class="c1"># self.tableWidget_consistenza_texture_mat_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_consistenza_texture_mat_usm&quot;)  # 19 - colore legante usm</span>
        <span class="c1"># aggreg_inclusi_materiale_row_count = self.tableWidget_inclusi_materiali_usm.rowCount()</span>
        <span class="c1"># for i in range(aggreg_inclusi_materiale_row_count):</span>
            <span class="c1"># self.tableWidget_inclusi_materiali_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_inclusi_materiali_usm&quot;)  # 19 - aggregati</span>
        <span class="c1"># colore_materiali_usm_row_count = self.tableWidget_colore_materiale_usm.rowCount()</span>
        <span class="c1"># for i in range(colore_materiali_usm_row_count):</span>
            <span class="c1"># self.tableWidget_colore_materiale_usm.removeRow(0)</span>
        <span class="c1"># self.insert_new_row(&quot;self.tableWidget_colore_materiale_usm&quot;)  # 19 - aggregati</span>
        <span class="c1"># if self.BROWSE_STATUS == &quot;n&quot;:</span>
            <span class="c1"># self.lineEdit_data_schedatura.setText(self.datestrfdate())  # 20 - data schedatura</span>
        <span class="c1"># else:</span>
            <span class="c1"># self.lineEdit_data_schedatura.setText(&quot;&quot;)  # 20 - data schedatura</span>
        
        <span class="c1"># self.comboBox_schedatore.setEditText(&quot;&quot;)  # 21 - schedatore</span>
        <span class="c1"># self.comboBox_formazione.setEditText(&quot;&quot;)  # 22 - formazione</span>
        <span class="c1"># self.comboBox_conservazione.setEditText(&quot;&quot;)  # 23 - conservazione</span>
        <span class="c1"># self.comboBox_colore.setEditText(&quot;&quot;)  # 24 - colore</span>
        <span class="c1"># self.comboBox_consistenza.setEditText(&quot;&quot;)  # 25 - consistenza</span>
        <span class="c1"># self.comboBox_struttura.setEditText(&quot;&quot;)  # 26 - struttura</span>
        <span class="c1"># self.lineEdit_codice_periodo.clear()  # 27 - codice periodo</span>
        <span class="c1"># self.lineEditOrderLayer.clear()  # 28 - order layer</span>
        <span class="c1"># self.comboBox_unita_tipo.setEditText(&quot;&quot;)  # 29 us_tipo            NUOVI CAMPI NUOVI CAMPI</span>
        <span class="c1"># self.comboBox_settore.setEditText(&quot;&quot;)  # 30 settore</span>
        <span class="c1"># self.lineEdit_quadrato.clear()  # 31 quadrato</span>
        <span class="c1"># self.lineEdit_ambiente.clear()  # 32 ambiente</span>
        <span class="c1"># self.lineEdit_saggio.clear()  # 33 saggio</span>
        <span class="c1"># self.textEdit_elementi_datanti.clear()  # 34 elementi datanti</span>
        <span class="c1"># self.comboBox_funz_statica_usm.setEditText(&quot;&quot;)  # 35 funzione statica</span>
        <span class="c1"># self.comboBox_lavorazione_usm.setEditText(&quot;&quot;)  # 36 lavorazione usm</span>
        <span class="c1"># self.lineEdit_spessore_giunti_usm.clear()  # 37 spessore giunti</span>
        <span class="c1"># self.lineEdit_letti_di_posa_giunti_usm.clear()  # 38 letti posa giunti usm</span>
        <span class="c1"># self.lineEdit_h_modulo_c_corsi_usm.clear()  # 39 altezza modulo corsi usm</span>
        <span class="c1"># self.comboBox_unita_edilizia_riassuntiva_usm.setEditText(&quot;&quot;)  # 40 unita edilizia riassuntiva</span>
        <span class="c1"># self.comboBox_reimpiego_usm.setEditText(&quot;&quot;)  # 41 unita edilizia riassuntiva</span>
        <span class="c1"># self.comboBox_posa_in_opera_usm.setEditText(&quot;&quot;)  # 42 posa in opera</span>
        <span class="c1"># self.lineEdit_qmin_usm.clear()  # 3 - US</span>
        <span class="c1"># self.lineEdit_qmax_usm.clear()  # 3 - US</span>
        <span class="c1"># self.comboBox_consistenza_legante_usm.setEditText(&quot;&quot;)  # 45 consitenza legante usm</span>
        <span class="c1"># self.lineEdit_n_catalogo_generale.clear()  # 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
        <span class="c1"># self.lineEdit_n_catalogo_interno.clear()  # 52 nr catalogo interno</span>
        <span class="c1"># self.lineEdit_n_catalogo_internazionale.clear()  # 53 nr catalogo internazionale</span>
        <span class="c1"># self.comboBox_soprintendenza.setEditText(&quot;&quot;)  # 54 nr soprintendenza</span>
        <span class="c1"># self.lineEdit_quota_relativa.clear()  # 55</span>
        <span class="c1"># self.lineEdit_quota_abs.clear()  # 56</span>
        <span class="c1"># self.lineEdit_ref_tm.clear()  # 57 ref tm</span>
        <span class="c1"># self.comboBox_ref_ra.setEditText(&quot;&quot;)   # 58 ref ra</span>
        <span class="c1"># self.lineEdit_ref_n.clear()  # 59 ref n</span>
        <span class="c1"># self.comboBox_posizione.setEditText(&quot;&quot;)  # 60 posizione</span>
        <span class="c1"># self.lineEdit_criteri_distinzione.clear()  # 61 criteri distinzione</span>
        <span class="c1"># self.comboBox_modo_formazione.setEditText(&quot;&quot;)  # 62 modo formazione</span>
        <span class="c1"># #self.comboBox_componenti_organici.setEditText(&quot;&quot;)  # 63 componenti organici</span>
        <span class="c1"># #self.comboBox_componenti_inorganici.setEditText(&quot;&quot;)  # 64 componenti inorganici</span>
        <span class="c1"># self.lineEdit_lunghezza_max.clear()  # 65</span>
        <span class="c1"># self.lineEdit_altezza_max.clear()  # 66</span>
        <span class="c1"># self.lineEdit_altezza_min.clear()  # 67</span>
        <span class="c1"># self.lineEdit_profondita_max.clear()  # 68</span>
        <span class="c1"># self.lineEdit_profondita_min.clear()  # 69</span>
        <span class="c1"># self.lineEdit_larghezza_media.clear()  # 70</span>
        <span class="c1"># self.lineEdit_quota_max_abs.clear()  # 71</span>
        <span class="c1"># self.lineEdit_quota_max_rel.clear()  # 72</span>
        <span class="c1"># self.lineEdit_quota_min_abs.clear()  # 73</span>
        <span class="c1"># self.lineEdit_quota_min_rel.clear()  # 74</span>
        <span class="c1"># self.textEdit_osservazioni.clear()  # 75 osservazioni</span>
        <span class="c1"># self.comboBox_datazione.setEditText(&quot;&quot;)  # 76 datazione</span>
        <span class="c1"># self.comboBox_flottazione.setEditText(&quot;&quot;)   # 77 flottazione</span>
        <span class="c1"># self.comboBox_setacciatura.setEditText(&quot;&quot;)  # 78 setacciatura</span>
        <span class="c1"># self.comboBox_affidabilita.setEditText(&quot;&quot;)  # 79 affidabilita</span>
        <span class="c1"># self.comboBox_direttore_us.setEditText(&quot;&quot;)  # 80 direttore us</span>
        <span class="c1"># self.comboBox_responsabile_us.setEditText(&quot;&quot;)  # 81 responsabile us</span>
        <span class="c1"># self.lineEdit_cod_ente_schedatore.clear()  # 82 cod ente schedatore</span>
        <span class="c1"># self.lineEdit_data_rilevazione.clear()  # 83 data rilevazione</span>
        <span class="c1"># self.lineEdit_data_rielaborazione.clear()  # 84 data rielaborazione</span>
        <span class="c1"># self.lineEdit_lunghezza_usm.clear()  # 85</span>
        <span class="c1"># self.lineEdit_altezza_usm.clear()  # 86</span>
        <span class="c1"># self.lineEdit_spessore_usm.clear()  # 87</span>
        <span class="c1"># self.comboBox_tecnica_muraria_usm.setEditText(&quot;&quot;)  # 88 tecnica muraria usm</span>
        <span class="c1"># self.comboBox_modulo_usm.setEditText(&quot;&quot;)  # 89 modulo usm</span>
        <span class="c1"># self.lineEdit_campioni_malta_usm.clear()  # 90 campioni malta usm</span>
        <span class="c1"># self.lineEdit_campioni_mattone_usm.clear()  # 91 campioni mattone usm</span>
        <span class="c1"># self.lineEdit_campioni_pietra_usm.clear()  # 92 campioni pietra usm</span>
        <span class="c1"># self.lineEdit_provenienza_materiali_usm.clear()  # 93 provenienza_materiali_usm</span>
        <span class="c1"># self.lineEdit_criteri_distinzione_usm.clear()  # 94 criteri distinzione usm</span>
        <span class="c1"># self.comboBox_uso_primario_usm.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_tipologia_opera.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_sezione_muraria.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_superficie_analizzata.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_orientamento.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_materiali_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_lavorazione_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_consistenza_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_forma_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_colore_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_impasto_lat.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_forma_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_colore_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_taglio_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_posa_opera_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_inerti_usm.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_tipo_legante_usm.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_rifinitura_usm.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_materiale_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.comboBox_consistenza_p.setEditText(&quot;&quot;)  # 95 uso primario usm</span>
        <span class="c1"># self.mQgsFileWidget.clear()</span>
    <span class="c1"># def fill_fields(self, n=0):</span>
        <span class="c1"># self.rec_num = n</span>
        <span class="c1"># try:</span>
            <span class="c1"># str(self.comboBox_sito.setEditText(self.DATA_LIST[self.rec_num].sito))  # 1 - Sito</span>
            <span class="c1"># str(self.comboBox_area.setEditText(self.DATA_LIST[self.rec_num].area))  # 2 - Area</span>
            <span class="c1"># self.lineEdit_us.setText(str(self.DATA_LIST[self.rec_num].us))  # 3 - US</span>
            <span class="c1"># str(self.comboBox_def_strat.setEditText(self.DATA_LIST[self.rec_num].d_stratigrafica))  # 4 - Definizione stratigrafica</span>
            <span class="c1"># str(self.comboBox_def_intepret.setEditText(self.DATA_LIST[self.rec_num].d_interpretativa))  # 5 - Definizione intepretata</span>
            <span class="c1"># str(self.textEdit_descrizione.setText(self.DATA_LIST[self.rec_num].descrizione))  # 6 - descrizione</span>
            <span class="c1"># str(self.textEdit_interpretazione.setText(self.DATA_LIST[self.rec_num].interpretazione))  # 7 - interpretazione</span>
            <span class="c1"># str(self.comboBox_per_iniz.setEditText(self.DATA_LIST[self.rec_num].periodo_iniziale))  # 8 - periodo iniziale</span>
            <span class="c1"># str(self.comboBox_fas_iniz.setEditText(self.DATA_LIST[self.rec_num].fase_iniziale))  # 9 - fase iniziale</span>
            <span class="c1"># str(self.comboBox_per_fin.setEditText(self.DATA_LIST[self.rec_num].periodo_finale))  # 10 - periodo finale iniziale</span>
            <span class="c1"># str(self.comboBox_fas_fin.setEditText(self.DATA_LIST[self.rec_num].fase_finale))  # 11 - fase finale</span>
            <span class="c1"># str(self.comboBox_scavato.setEditText(self.DATA_LIST[self.rec_num].scavato))  # 12 - scavato</span>
            <span class="c1"># str(self.lineEdit_attivita.setText(self.DATA_LIST[self.rec_num].attivita))  # 13 - attivita</span>
            <span class="c1"># str(self.lineEdit_anno.setText(self.DATA_LIST[self.rec_num].anno_scavo))  # 14 - anno scavo</span>
            <span class="c1"># str(self.comboBox_metodo.setEditText(self.DATA_LIST[self.rec_num].metodo_di_scavo))  # 15 - metodo</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_inclusi&quot;, self.DATA_LIST[self.rec_num].inclusi)  # 16 - inclusi</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_campioni&quot;, self.DATA_LIST[self.rec_num].campioni)  # 17 - campioni</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_organici&quot;, self.DATA_LIST[self.rec_num].componenti_organici)  # organici</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_inorganici&quot;, self.DATA_LIST[self.rec_num].componenti_inorganici)  # inorganici</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_rapporti&quot;, self.DATA_LIST[self.rec_num].rapporti)  # 18 - rapporti</span>
            <span class="c1"># str(self.lineEdit_data_schedatura.setText(self.DATA_LIST[self.rec_num].data_schedatura))  # 19 - data schedatura</span>
            <span class="c1"># str(self.comboBox_schedatore.setEditText(self.DATA_LIST[self.rec_num].schedatore))  # 20 - schedatore</span>
            <span class="c1"># str(self.comboBox_formazione.setEditText(self.DATA_LIST[self.rec_num].formazione))  # 21 - formazione</span>
            <span class="c1"># str(self.comboBox_conservazione.setEditText(self.DATA_LIST[self.rec_num].stato_di_conservazione))  # 22 - conservazione</span>
            <span class="c1"># str(self.comboBox_colore.setEditText(self.DATA_LIST[self.rec_num].colore))  # 23 - colore</span>
            <span class="c1"># str(self.comboBox_consistenza.setEditText(self.DATA_LIST[self.rec_num].consistenza))  # 24 - consistenza</span>
            <span class="c1"># str(self.comboBox_struttura.setEditText(self.DATA_LIST[self.rec_num].struttura)) # 25 - struttura</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].cont_per:</span>
                <span class="c1"># self.lineEdit_codice_periodo.setText(&quot;&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_codice_periodo.setText(str(self.DATA_LIST[self.rec_num].cont_per))  # 26 - codice periodo</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].order_layer:</span>
                <span class="c1"># self.lineEditOrderLayer.setText(&quot;&quot;)</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEditOrderLayer.setText(str(self.DATA_LIST[self.rec_num].order_layer))  # 27 - order layer</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_documentazione&quot;,self.DATA_LIST[self.rec_num].documentazione)  # 28 - documentazione</span>
            <span class="c1"># str(self.comboBox_unita_tipo.setEditText(self.DATA_LIST[self.rec_num].unita_tipo))  # 29 unita tipo</span>
            <span class="c1"># str(self.comboBox_settore.setEditText(self.DATA_LIST[self.rec_num].settore))  # 30 - settore</span>
            <span class="c1"># str(self.lineEdit_quadrato.setText(self.DATA_LIST[self.rec_num].quad_par))  # 31 quadrato</span>
            <span class="c1"># str(self.lineEdit_ambiente.setText(self.DATA_LIST[self.rec_num].ambient))  # 32 ambiente</span>
            <span class="c1"># str(self.lineEdit_saggio.setText(self.DATA_LIST[self.rec_num].saggio))  # 33 saggio</span>
            <span class="c1"># str(self.textEdit_elementi_datanti.setText(self.DATA_LIST[self.rec_num].elem_datanti))  # 34 - elemtenti_datanti</span>
            <span class="c1"># str(self.comboBox_funz_statica_usm.setEditText(self.DATA_LIST[self.rec_num].funz_statica))  # 35 - funz statica</span>
            <span class="c1"># str(self.comboBox_lavorazione_usm.setEditText(self.DATA_LIST[self.rec_num].lavorazione))  # 36 lavorazione usm</span>
            <span class="c1"># str(self.lineEdit_spessore_giunti_usm.setText(self.DATA_LIST[self.rec_num].spess_giunti))  # 37 spessore giunti usm</span>
            <span class="c1"># str(self.lineEdit_letti_di_posa_giunti_usm.setText(self.DATA_LIST[self.rec_num].letti_posa)) #38 letti_posa</span>
            <span class="c1"># str(self.lineEdit_h_modulo_c_corsi_usm.setText(self.DATA_LIST[self.rec_num].alt_mod)) #39 altezza modulo corsi</span>
            <span class="c1"># str(self.comboBox_unita_edilizia_riassuntiva_usm.setEditText(self.DATA_LIST[self.rec_num].un_ed_riass)) #40 unita edilizia riassuntiva</span>
            <span class="c1"># str(self.comboBox_reimpiego_usm.setEditText(self.DATA_LIST[self.rec_num].reimp))  #41 reimpiego</span>
            <span class="c1"># str(self.comboBox_posa_in_opera_usm.setEditText(self.DATA_LIST[self.rec_num].posa_opera)) #42 posa opera</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].quota_min_usm:</span>
                <span class="c1"># str(self.lineEdit_qmin_usm.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_qmin_usm.setText(str(self.DATA_LIST[self.rec_num].quota_min_usm))  # 43 - qmin usm</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].quota_max_usm:</span>
               <span class="c1"># str(self.lineEdit_qmax_usm.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
               <span class="c1"># self.lineEdit_qmax_usm.setText(str(self.DATA_LIST[self.rec_num].quota_max_usm))  # 44 - qmax usm</span>
            <span class="c1"># str(self.comboBox_consistenza_legante_usm.setEditText(self.DATA_LIST[self.rec_num].cons_legante))  # 45 - cons legante</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_colore_legante_usm&quot;, self.DATA_LIST[self.rec_num].col_legante) ## 46 - col legante usm</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_inclusi_leganti_usm&quot;, self.DATA_LIST[self.rec_num].aggreg_legante) # 47 aggregati legante usm</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_consistenza_texture_mat_usm&quot;, self.DATA_LIST[self.rec_num].con_text_mat) # 48 - con text mat</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_colore_materiale_usm&quot;, self.DATA_LIST[self.rec_num].col_materiale) # 49 - col mat</span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_inclusi_materiali_usm&quot;,self.DATA_LIST[self.rec_num].inclusi_materiali_usm)  # 50  inclusi materiali usm</span>
            <span class="c1"># str(self.lineEdit_n_catalogo_generale.setText(self.DATA_LIST[self.rec_num].n_catalogo_generale))  # 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
            <span class="c1"># str(self.lineEdit_n_catalogo_interno.setText(self.DATA_LIST[self.rec_num].n_catalogo_interno))  # 52 nr catalogo interno</span>
            <span class="c1"># str(self.lineEdit_n_catalogo_internazionale.setText(self.DATA_LIST[self.rec_num].n_catalogo_internazionale))  # 53 nr catalogo internazionale</span>
            <span class="c1"># str(self.comboBox_soprintendenza.setEditText(self.DATA_LIST[self.rec_num].soprintendenza))  # 54 nr soprintendenza</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].quota_relativa:</span>
                <span class="c1"># str(self.lineEdit_quota_relativa.setText(&quot;&quot;))                   # 55</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_quota_relativa.setText(str(self.DATA_LIST[self.rec_num].quota_relativa))</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].quota_abs:</span>
                <span class="c1"># str(self.lineEdit_quota_abs.setText(&quot;&quot;))                   # 56</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_quota_abs.setText(str(self.DATA_LIST[self.rec_num].quota_abs))</span>
            <span class="c1"># str(self.lineEdit_ref_tm.setText(self.DATA_LIST[self.rec_num].ref_tm))  # 57 ref tm</span>
            <span class="c1"># str(self.comboBox_ref_ra.setDefaultText(self.DATA_LIST[self.rec_num].ref_ra))  # 58 ref ra</span>
            <span class="c1"># str(self.lineEdit_ref_n.setText(self.DATA_LIST[self.rec_num].ref_n))  # 59 ref n</span>
            <span class="c1"># str(self.comboBox_posizione.setEditText(self.DATA_LIST[self.rec_num].posizione))  # 60 posizione</span>
            <span class="c1"># str(self.lineEdit_criteri_distinzione.setText(self.DATA_LIST[self.rec_num].criteri_distinzione))  # 61 criteri distinzione</span>
            <span class="c1"># str(self.comboBox_modo_formazione.setEditText(self.DATA_LIST[self.rec_num].modo_formazione))  # 62 modo formazione</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].lunghezza_max:</span>
                <span class="c1"># str(self.lineEdit_lunghezza_max.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_lunghezza_max.setText(str(self.DATA_LIST[self.rec_num].lunghezza_max))  # 65 lunghezza max</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].altezza_max:</span>
                <span class="c1"># str(self.lineEdit_altezza_max.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_altezza_max.setText(str(self.DATA_LIST[self.rec_num].altezza_max))  # 66 altezza max</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].altezza_min:</span>
                <span class="c1"># str(self.lineEdit_altezza_min.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_altezza_min.setText(str(self.DATA_LIST[self.rec_num].altezza_min))  # 67 altezza min</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].profondita_max:</span>
                <span class="c1"># str(self.lineEdit_profondita_max.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_profondita_max.setText(str(</span>
                    <span class="c1"># self.DATA_LIST[self.rec_num].profondita_max))  # 68 profondita_max</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].profondita_min:</span>
                <span class="c1"># str(self.lineEdit_profondita_min.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_profondita_min.setText(str(</span>
                    <span class="c1"># self.DATA_LIST[self.rec_num].profondita_min))  # 69 profondita min</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].larghezza_media:</span>
                <span class="c1"># str(self.lineEdit_larghezza_media.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_larghezza_media.setText(str(</span>
                    <span class="c1"># self.DATA_LIST[self.rec_num].larghezza_media))  # 70 larghezza media</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].quota_max_abs:</span>
                <span class="c1"># str(self.lineEdit_quota_max_abs.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_quota_max_abs.setText(str(self.DATA_LIST[self.rec_num].quota_max_abs))  # 71 quota_max_abs</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].quota_max_rel:</span>
                <span class="c1"># str(self.lineEdit_quota_max_rel.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_quota_max_rel.setText(str(</span>
                    <span class="c1"># self.DATA_LIST[self.rec_num].quota_max_rel))  # 72 quota_max_rel</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].quota_min_abs:</span>
                <span class="c1"># str(self.lineEdit_quota_min_abs.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_quota_min_abs.setText(str(self.DATA_LIST[self.rec_num].quota_min_abs))  # 73 quota_min_abs</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].quota_min_rel:</span>
                <span class="c1"># str(self.lineEdit_quota_min_rel.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_quota_min_rel.setText(str(self.DATA_LIST[self.rec_num].quota_min_rel))  # 74 quota_min_rel</span>
            <span class="c1"># str(self.textEdit_osservazioni.setText(self.DATA_LIST[self.rec_num].osservazioni))  # 75 osservazioni</span>
            <span class="c1"># str(self.comboBox_datazione.setEditText(self.DATA_LIST[self.rec_num].datazione))  # 76 datazione</span>
            <span class="c1"># str(self.comboBox_flottazione.setEditText(self.DATA_LIST[self.rec_num].flottazione))  # 77 flottazione</span>
            <span class="c1"># str(self.comboBox_setacciatura.setEditText(self.DATA_LIST[self.rec_num].setacciatura))  # 78 setacciatura</span>
            <span class="c1"># str(self.comboBox_affidabilita.setEditText(self.DATA_LIST[self.rec_num].affidabilita))        # 79 affidabilita</span>
            <span class="c1"># str(self.comboBox_direttore_us.setEditText(self.DATA_LIST[self.rec_num].direttore_us))  # 80 direttore us</span>
            <span class="c1"># str(self.comboBox_responsabile_us.setEditText(self.DATA_LIST[self.rec_num].responsabile_us))  # 81 responsabile us</span>
            <span class="c1"># str(self.lineEdit_cod_ente_schedatore.setText(self.DATA_LIST[self.rec_num].cod_ente_schedatore))  # 82 cod ente schedatore</span>
            <span class="c1"># str(self.lineEdit_data_rilevazione.setText(self.DATA_LIST[self.rec_num].data_rilevazione))  # 83 data rilevazione</span>
            <span class="c1"># str(self.lineEdit_data_rielaborazione.setText(self.DATA_LIST[self.rec_num].data_rielaborazione))  # 84 data rielaborazione</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].lunghezza_usm:</span>
                <span class="c1"># str(self.lineEdit_lunghezza_usm.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_lunghezza_usm.setText(str(self.DATA_LIST[self.rec_num].lunghezza_usm))  # 85 lunghezza usm</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].altezza_usm:</span>
                <span class="c1"># str(self.lineEdit_altezza_usm.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_altezza_usm.setText(str(self.DATA_LIST[self.rec_num].altezza_usm))  # 86 altezza usm</span>
            <span class="c1"># if not self.DATA_LIST[self.rec_num].spessore_usm:</span>
                <span class="c1"># str(self.lineEdit_spessore_usm.setText(&quot;&quot;))</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.lineEdit_spessore_usm.setText(str(self.DATA_LIST[self.rec_num].spessore_usm))  # 87 spessore usm</span>
            <span class="c1"># str(self.comboBox_tecnica_muraria_usm.setEditText(self.DATA_LIST[self.rec_num].tecnica_muraria_usm))  # 88 tecnica muraria usm</span>
            <span class="c1"># str(self.comboBox_modulo_usm.setEditText(self.DATA_LIST[self.rec_num].modulo_usm))  # 89 modulo usm</span>
            <span class="c1"># str(self.lineEdit_campioni_malta_usm.setText(self.DATA_LIST[self.rec_num].campioni_malta_usm))  # 90 campioni malta usm</span>
            <span class="c1"># str(self.lineEdit_campioni_mattone_usm.setText(self.DATA_LIST[self.rec_num].campioni_mattone_usm))  # 91 campioni mattone usm</span>
            <span class="c1"># str(self.lineEdit_campioni_pietra_usm.setText(self.DATA_LIST[self.rec_num].campioni_pietra_usm))  # 92 campioni pietra usm</span>
            <span class="c1"># str(self.lineEdit_provenienza_materiali_usm.setText(self.DATA_LIST[self.rec_num].provenienza_materiali_usm))  # 93 provenienza_materiali_usm</span>
            <span class="c1"># str(self.lineEdit_criteri_distinzione_usm.setText(self.DATA_LIST[self.rec_num].criteri_distinzione_usm))  # 94 criteri distinzione usm</span>
            <span class="c1"># str(self.comboBox_uso_primario_usm.setEditText(self.DATA_LIST[self.rec_num].uso_primario_usm))  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_tipologia_opera.setEditText(self.DATA_LIST[self.rec_num].tipologia_opera)) </span>
            <span class="c1"># str(self.comboBox_sezione_muraria.setEditText(self.DATA_LIST[self.rec_num].sezione_muraria)) </span>
            <span class="c1"># str(self.comboBox_superficie_analizzata.setEditText(self.DATA_LIST[self.rec_num].superficie_analizzata)) </span>
            <span class="c1"># str(self.comboBox_orientamento.setEditText(self.DATA_LIST[self.rec_num].orientamento)) </span>
            <span class="c1"># str(self.comboBox_materiali_lat.setEditText(self.DATA_LIST[self.rec_num].materiali_lat)) </span>
            <span class="c1"># str(self.comboBox_lavorazione_lat.setEditText(self.DATA_LIST[self.rec_num].lavorazione_lat)) </span>
            <span class="c1"># str(self.comboBox_consistenza_lat.setEditText(self.DATA_LIST[self.rec_num].consistenza_lat)) </span>
            <span class="c1"># str(self.comboBox_forma_lat.setEditText(self.DATA_LIST[self.rec_num].forma_lat)) </span>
            <span class="c1"># str(self.comboBox_colore_lat.setEditText(self.DATA_LIST[self.rec_num].colore_lat)) </span>
            <span class="c1"># str(self.comboBox_impasto_lat.setEditText(self.DATA_LIST[self.rec_num].impasto_lat)) </span>
            <span class="c1"># str(self.comboBox_forma_p.setEditText(self.DATA_LIST[self.rec_num].forma_p)) </span>
            <span class="c1"># str(self.comboBox_colore_p.setEditText(self.DATA_LIST[self.rec_num].colore_p)) </span>
            <span class="c1"># str(self.comboBox_taglio_p.setEditText(self.DATA_LIST[self.rec_num].taglio_p)) </span>
            <span class="c1"># str(self.comboBox_posa_opera_p.setEditText(self.DATA_LIST[self.rec_num].posa_opera_p)) </span>
            <span class="c1"># str(self.comboBox_inerti_usm.setEditText(self.DATA_LIST[self.rec_num].inerti_usm)) </span>
            <span class="c1"># str(self.comboBox_tipo_legante_usm.setEditText(self.DATA_LIST[self.rec_num].tipo_legante_usm)) </span>
            <span class="c1"># str(self.comboBox_rifinitura_usm.setEditText(self.DATA_LIST[self.rec_num].rifinitura_usm)) </span>
            <span class="c1"># str(self.comboBox_materiale_p.setEditText(self.DATA_LIST[self.rec_num].materiale_p)) </span>
            <span class="c1"># str(self.comboBox_consistenza_p.setEditText(self.DATA_LIST[self.rec_num].consistenza_p)) </span>
            <span class="c1"># self.tableInsertData(&quot;self.tableWidget_rapporti2&quot;, self.DATA_LIST[self.rec_num].rapporti2)</span>
            <span class="c1"># str(self.mQgsFileWidget.setText(self.DATA_LIST[self.rec_num].doc_usv)) # 18 - rapporti</span>
            <span class="c1"># # gestione tool</span>
            <span class="c1"># if self.toolButtonPreview.isChecked():</span>
                <span class="c1"># self.loadMapPreview()</span>
            <span class="c1"># if self.toolButtonPreviewMedia.isChecked():</span>
                <span class="c1"># self.loadMediaPreview()</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass </span>
    <span class="c1"># def set_rec_counter(self, t, c):</span>
        <span class="c1"># self.rec_tot = t</span>
        <span class="c1"># self.rec_corr = c</span>
        <span class="c1"># self.label_rec_tot.setText(str(self.rec_tot))</span>
        <span class="c1"># self.label_rec_corrente.setText(str(self.rec_corr))</span>
    <span class="c1"># def set_LIST_REC_TEMP(self):</span>
        <span class="c1"># # QMessageBox.warning(self, &quot;Errore&quot;, str(self.comboBox_per_fin.currentText()),  QMessageBox.Ok)</span>
        <span class="c1"># # TableWidget</span>
        <span class="c1"># ##Rapporti</span>
        <span class="c1"># rapporti = self.table2dict(&quot;self.tableWidget_rapporti&quot;)</span>
        <span class="c1"># rapporti2 = self.table2dict(&quot;self.tableWidget_rapporti2&quot;)</span>
        <span class="c1"># ##Inclusi</span>
        <span class="c1"># inclusi = self.table2dict(&quot;self.tableWidget_inclusi&quot;)</span>
        <span class="c1"># ##Campioni</span>
        <span class="c1"># campioni = self.table2dict(&quot;self.tableWidget_campioni&quot;)</span>
        <span class="c1"># ##Organici</span>
        <span class="c1"># organici = self.table2dict(&quot;self.tableWidget_organici&quot;)</span>
        <span class="c1"># ##Inorganici</span>
        <span class="c1"># inorganici = self.table2dict(&quot;self.tableWidget_inorganici&quot;)</span>
        <span class="c1"># ##Documentazione</span>
        <span class="c1"># documentazione = self.table2dict(&quot;self.tableWidget_documentazione&quot;)</span>
        <span class="c1"># ##Inclusi materiali aggregati</span>
        <span class="c1"># inclusi_mat_usm = self.table2dict(&quot;self.tableWidget_inclusi_materiali_usm&quot;)</span>
        <span class="c1"># ##Inclusi leganti usm</span>
        <span class="c1"># inclusi_leganti_usm = self.table2dict(&quot;self.tableWidget_inclusi_leganti_usm&quot;)</span>
        <span class="c1"># colore_legante_usm = self.table2dict(&quot;self.tableWidget_colore_legante_usm&quot;)</span>
        <span class="c1"># con_text_materiale_usm = self.table2dict(&quot;self.tableWidget_consistenza_texture_mat_usm&quot;)</span>
        <span class="c1"># col_materiale_usm = self.table2dict(&quot;self.tableWidget_colore_materiale_usm&quot;)</span>
        <span class="c1"># #list_foto = self.table2dict(&quot;self.tableWidget_foto&quot;)</span>
        <span class="c1"># if self.lineEditOrderLayer.text() == &quot;&quot;:</span>
            <span class="c1"># order_layer = 0</span>
        <span class="c1"># else:</span>
            <span class="c1"># order_layer = self.lineEditOrderLayer.text()</span>
        <span class="c1"># if self.lineEdit_qmin_usm.text() == &quot;&quot;:</span>
            <span class="c1"># qmin_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># qmin_usm = self.lineEdit_qmin_usm.text()</span>
        <span class="c1"># if self.lineEdit_qmax_usm.text() == &quot;&quot;:</span>
            <span class="c1"># qmax_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># qmax_usm = self.lineEdit_qmax_usm.text()</span>
        <span class="c1"># ##quota relativa</span>
        <span class="c1"># if self.lineEdit_quota_relativa.text() == &quot;&quot;:</span>
            <span class="c1"># quota_relativa = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_relativa = self.lineEdit_quota_relativa.text()</span>
        <span class="c1"># ##quota abs</span>
        <span class="c1"># if self.lineEdit_quota_abs.text() == &quot;&quot;:</span>
            <span class="c1"># quota_abs = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_abs = self.lineEdit_quota_abs.text().replace(&quot;,&quot;, &quot;.&quot;)</span>
        <span class="c1"># ##lunghezza max</span>
        <span class="c1"># if self.lineEdit_lunghezza_max.text() == &quot;&quot;:</span>
            <span class="c1"># lunghezza_max = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># lunghezza_max = self.lineEdit_lunghezza_max.text()</span>
        <span class="c1"># ##altezza max</span>
        <span class="c1"># if self.lineEdit_altezza_max.text() == &quot;&quot;:</span>
            <span class="c1"># altezza_max = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># altezza_max = self.lineEdit_altezza_max.text()</span>
        <span class="c1"># ##altezza min</span>
        <span class="c1"># if self.lineEdit_altezza_min.text() == &quot;&quot;:</span>
            <span class="c1"># altezza_min = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># altezza_min = self.lineEdit_altezza_min.text()</span>
        <span class="c1"># ##profondita max</span>
        <span class="c1"># if self.lineEdit_profondita_max.text() == &quot;&quot;:</span>
            <span class="c1"># profondita_max = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># profondita_max = self.lineEdit_profondita_max.text()</span>
        <span class="c1"># ##profondita min</span>
        <span class="c1"># if self.lineEdit_profondita_min.text() == &quot;&quot;:</span>
            <span class="c1"># profondita_min = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># profondita_min = self.lineEdit_profondita_min.text()</span>
        <span class="c1"># ##larghezza media</span>
        <span class="c1"># if self.lineEdit_larghezza_media.text() == &quot;&quot;:</span>
            <span class="c1"># larghezza_media = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># larghezza_media = self.lineEdit_larghezza_media.text()</span>
        <span class="c1"># ##quota max abs</span>
        <span class="c1"># if self.lineEdit_quota_max_abs.text() == &quot;&quot;:</span>
            <span class="c1"># quota_max_abs = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_max_abs = self.lineEdit_quota_max_abs.text()</span>
        <span class="c1"># ##quota max relativa</span>
        <span class="c1"># if self.lineEdit_quota_max_rel.text() == &quot;&quot;:</span>
            <span class="c1"># quota_max_rel = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_max_rel = self.lineEdit_quota_max_rel.text()</span>
        <span class="c1"># ##quota min abs</span>
        <span class="c1"># if self.lineEdit_quota_min_abs.text() == &quot;&quot;:</span>
            <span class="c1"># quota_min_abs = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_min_abs = self.lineEdit_quota_min_abs.text()</span>
        <span class="c1"># ##quota min relativa</span>
        <span class="c1"># if self.lineEdit_quota_min_rel.text() == &quot;&quot;:</span>
            <span class="c1"># quota_min_rel = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># quota_min_rel = self.lineEdit_quota_min_rel.text()</span>
        <span class="c1"># ##lunghezza usm</span>
        <span class="c1"># if self.lineEdit_lunghezza_usm.text() == &quot;&quot;:</span>
            <span class="c1"># lunghezza_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># lunghezza_usm = self.lineEdit_lunghezza_usm.text()</span>
        <span class="c1"># ##altezza usm</span>
        <span class="c1"># if self.lineEdit_altezza_usm.text() == &quot;&quot;:</span>
            <span class="c1"># altezza_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># altezza_usm = self.lineEdit_altezza_usm.text()</span>
        <span class="c1"># ##spessore usm</span>
        <span class="c1"># if self.lineEdit_spessore_usm.text() == &quot;&quot;:</span>
            <span class="c1"># spessore_usm = None</span>
        <span class="c1"># else:</span>
            <span class="c1"># spessore_usm = self.lineEdit_spessore_usm.text()</span>
            <span class="c1"># # data</span>
        <span class="c1"># self.DATA_LIST_REC_TEMP = [</span>
            <span class="c1"># str(self.comboBox_sito.currentText()),  # 1 - Sito</span>
            <span class="c1"># str(self.comboBox_area.currentText()),  # 2 - Area</span>
            <span class="c1"># str(self.lineEdit_us.text()),  # 3 - US</span>
            <span class="c1"># str(self.comboBox_def_strat.currentText()),  # 4 - Definizione stratigrafica</span>
            <span class="c1"># str(self.comboBox_def_intepret.currentText()),  # 5 - Definizione intepretata</span>
            <span class="c1"># str(self.textEdit_descrizione.toPlainText()),  # 6 - descrizione</span>
            <span class="c1"># str(self.textEdit_interpretazione.toPlainText()),  # 7 - interpretazione</span>
            <span class="c1"># str(self.comboBox_per_iniz.currentText()),  # 8 - periodo iniziale</span>
            <span class="c1"># str(self.comboBox_fas_iniz.currentText()),  # 9 - fase iniziale</span>
            <span class="c1"># str(self.comboBox_per_fin.currentText()),  # 10 - periodo finale iniziale</span>
            <span class="c1"># str(self.comboBox_fas_fin.currentText()),  # 11 - fase finale</span>
            <span class="c1"># str(self.comboBox_scavato.currentText()),  # 12 - scavato</span>
            <span class="c1"># str(self.lineEdit_attivita.text()),  # 13 - attivita</span>
            <span class="c1"># str(self.lineEdit_anno.text()),  # 14 - anno scavo</span>
            <span class="c1"># str(self.comboBox_metodo.currentText()),  # 15 - metodo</span>
            <span class="c1"># str(inclusi),  # 16 - inclusi</span>
            <span class="c1"># str(campioni),  # 17 - campioni</span>
            <span class="c1"># str(rapporti),  # 18 - rapporti</span>
            <span class="c1"># #str(organici),</span>
            <span class="c1"># #str(inorganici),</span>
            <span class="c1"># str(self.lineEdit_data_schedatura.text()),  # 19 - data schedatura</span>
            <span class="c1"># str(self.comboBox_schedatore.currentText()),  # 20 - schedatore</span>
            <span class="c1"># str(self.comboBox_formazione.currentText()),  # 21 - formazione</span>
            <span class="c1"># str(self.comboBox_conservazione.currentText()),  # 22 - conservazione</span>
            <span class="c1"># str(self.comboBox_colore.currentText()),  # 23 - colore</span>
            <span class="c1"># str(self.comboBox_consistenza.currentText()),  # 24 - consistenza</span>
            <span class="c1"># str(self.comboBox_struttura.currentText()),  # 25 - struttura</span>
            <span class="c1"># str(self.lineEdit_codice_periodo.text()),  # 26 - codice periodo</span>
            <span class="c1"># str(order_layer),  # 27 - order layer era str(order_layer)</span>
            <span class="c1"># str(documentazione),</span>
            <span class="c1"># str(self.comboBox_unita_tipo.currentText()),  # 29 us_tipo            NUOVI CAMPI NUOVI CAMPI</span>
            <span class="c1"># str(self.comboBox_settore.currentText()),  # 30 settore</span>
            <span class="c1"># str(self.lineEdit_quadrato.text()),  # 31 quadrato</span>
            <span class="c1"># str(self.lineEdit_ambiente.text()),  # 32 ambiente</span>
            <span class="c1"># str(self.lineEdit_saggio.text()),  # 33 saggio</span>
            <span class="c1"># str(self.textEdit_elementi_datanti.toPlainText()),  # 34 elementi datanti</span>
            <span class="c1"># str(self.comboBox_funz_statica_usm.currentText()),  # 35 funzione statica</span>
            <span class="c1"># str(self.comboBox_lavorazione_usm.currentText()),  # 36 lavorazione usm</span>
            <span class="c1"># str(self.lineEdit_spessore_giunti_usm.text()),  # 37 spessore giunti</span>
            <span class="c1"># str(self.lineEdit_letti_di_posa_giunti_usm.text()),  # 38 letti posa giunti usm</span>
            <span class="c1"># str(self.lineEdit_h_modulo_c_corsi_usm.text()),  # 39 altezza modulo corsi usm</span>
            <span class="c1"># str(self.comboBox_unita_edilizia_riassuntiva_usm.currentText()),  # 40 unita edilizia riassuntiva</span>
            <span class="c1"># str(self.comboBox_reimpiego_usm.currentText()),  # 41 unita edilizia riassuntiva</span>
            <span class="c1"># str(self.comboBox_posa_in_opera_usm.currentText()),  # 42 posa in opera</span>
            <span class="c1"># str(qmin_usm),  # 43 quota minima</span>
            <span class="c1"># str(qmax_usm),  # 44 quota massima</span>
            <span class="c1"># str(self.comboBox_consistenza_legante_usm.currentText()),  # 45 consitenza legante usm</span>
            <span class="c1"># str(colore_legante_usm),  # 46 colore legante usm</span>
            <span class="c1"># str(inclusi_leganti_usm),  # 47 aggregati leganti usm</span>
            <span class="c1"># str(con_text_materiale_usm),  # 48 consistenza text mat</span>
            <span class="c1"># str(col_materiale_usm),  # 49 colore materiale usm</span>
            <span class="c1"># str(inclusi_mat_usm), # 50 inclusi_mat_usm</span>
            <span class="c1"># str(self.lineEdit_n_catalogo_generale.text()), # 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
            <span class="c1"># str(self.lineEdit_n_catalogo_interno.text()), # 52 nr catalogo interno</span>
            <span class="c1"># str(self.lineEdit_n_catalogo_internazionale.text()), # 53 nr catalogo internazionale</span>
            <span class="c1"># str(self.comboBox_soprintendenza.currentText()), # 54 nr soprintendenza</span>
            <span class="c1"># str(quota_relativa),  # 55 quota relativa</span>
            <span class="c1"># str(quota_abs),  # 56 quota abs</span>
            <span class="c1"># str(self.lineEdit_ref_tm.text()),  # 57 ref tm</span>
            <span class="c1"># str(self.comboBox_ref_ra.currentText()),  # 58 ref ra</span>
            <span class="c1"># str(self.lineEdit_ref_n.text()),  # 59 ref n</span>
            <span class="c1"># str(self.comboBox_posizione.currentText()),  # 60 posizione</span>
            <span class="c1"># str(self.lineEdit_criteri_distinzione.text()), # 61 criteri distinzione</span>
            <span class="c1"># str(self.comboBox_modo_formazione.currentText()), # 62 modo formazione</span>
            <span class="c1"># str(organici), # 63 componenti organici</span>
            <span class="c1"># str(inorganici), # 64 componenti inorganici</span>
            <span class="c1"># str(lunghezza_max),  # 65</span>
            <span class="c1"># str(altezza_max),  # 66</span>
            <span class="c1"># str(altezza_min),  # 67</span>
            <span class="c1"># str(profondita_max),  # 68</span>
            <span class="c1"># str(profondita_min),  # 69</span>
            <span class="c1"># str(larghezza_media),  # 70</span>
            <span class="c1"># str(quota_max_abs),  # 71</span>
            <span class="c1"># str(quota_max_rel),  # 72</span>
            <span class="c1"># str(quota_min_abs),  # 73</span>
            <span class="c1"># str(quota_min_rel),  # 74</span>
            <span class="c1"># str(self.textEdit_osservazioni.toPlainText()),  # 75 osservazioni</span>
            <span class="c1"># str(self.comboBox_datazione.currentText()),  # 76 datazione</span>
            <span class="c1"># str(self.comboBox_flottazione.currentText()),  # 77 flottazione</span>
            <span class="c1"># str(self.comboBox_setacciatura.currentText()),  # 78 setacciatura</span>
            <span class="c1"># str(self.comboBox_affidabilita.currentText()),  # 79 affidabilita</span>
            <span class="c1"># str(self.comboBox_direttore_us.currentText()),  # 80 direttore us</span>
            <span class="c1"># str(self.comboBox_responsabile_us.currentText()), # 81 responsabile us</span>
            <span class="c1"># str(self.lineEdit_cod_ente_schedatore.text()), # 82 cod ente schedatore</span>
            <span class="c1"># str(self.lineEdit_data_rilevazione.text()),  # 83 data rilevazione</span>
            <span class="c1"># str(self.lineEdit_data_rielaborazione.text()), # 84 data rielaborazione</span>
            <span class="c1"># str(lunghezza_usm),  # 85</span>
            <span class="c1"># str(altezza_usm),  # 86</span>
            <span class="c1"># str(spessore_usm),  # 87</span>
            <span class="c1"># str(self.comboBox_tecnica_muraria_usm.currentText()), # 88 tecnica muraria usm</span>
            <span class="c1"># str(self.comboBox_modulo_usm.currentText()),  # 89 modulo usm</span>
            <span class="c1"># str(self.lineEdit_campioni_malta_usm.text()), # 90 campioni malta usm</span>
            <span class="c1"># str(self.lineEdit_campioni_mattone_usm.text()), # 91 campioni mattone usm</span>
            <span class="c1"># str(self.lineEdit_campioni_pietra_usm.text()), # 92 campioni pietra usm</span>
            <span class="c1"># str(self.lineEdit_provenienza_materiali_usm.text()), # 93 provenienza_materiali_usm</span>
            <span class="c1"># str(self.lineEdit_criteri_distinzione_usm.text()), # 94 criteri distinzione usm</span>
            <span class="c1"># str(self.comboBox_uso_primario_usm.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_tipologia_opera.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_sezione_muraria.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_superficie_analizzata.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_orientamento.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_materiali_lat.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_lavorazione_lat.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_consistenza_lat.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_forma_lat.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_colore_lat.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_impasto_lat.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_forma_p.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_colore_p.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_taglio_p.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_posa_opera_p.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># #str(list_foto)</span>
            <span class="c1"># str(self.comboBox_inerti_usm.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_tipo_legante_usm.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_rifinitura_usm.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_materiale_p.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(self.comboBox_consistenza_p.currentText()),  # 95 uso primario usm</span>
            <span class="c1"># str(rapporti2),</span>
            <span class="c1"># str(self.mQgsFileWidget.text()),# 18 - rapporti</span>
        <span class="c1"># ]</span>
    <span class="c1"># def set_LIST_REC_CORR(self):</span>
        <span class="c1"># self.DATA_LIST_REC_CORR = []</span>
        <span class="c1"># for i in self.TABLE_FIELDS:</span>
            <span class="c1"># self.DATA_LIST_REC_CORR.append(eval(&quot;unicode(self.DATA_LIST[self.REC_CORR].&quot; + i + &quot;)&quot;))</span>
    <span class="c1"># def records_equal_check(self):</span>
        <span class="c1"># # self.set_sito()</span>
        <span class="c1"># self.set_LIST_REC_TEMP()</span>
        <span class="c1"># self.set_LIST_REC_CORR()</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># area TEST</span>
        <span class="c1"># tes = str(self.DATA_LIST_REC_CORR) + str(self.DATA_LIST_REC_TEMP)</span>
        <span class="c1"># self.testing(&quot;C:\\Users\\Luca\\pyarchinit_Test_folder\\tes_equal.txt&quot;, tes)</span>
        <span class="c1"># #QMessageBox.warning(self, &quot;Errore&quot;, str(self.DATA_LIST_REC_CORR) + str(self.DATA_LIST_REC_TEMP),  QMessageBox.Ok)</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># if self.DATA_LIST_REC_CORR == self.DATA_LIST_REC_TEMP:</span>
            <span class="c1"># return 0</span>
        <span class="c1"># else:</span>
            <span class="c1"># return 1</span>
    <span class="c1"># def setComboBoxEditable(self, f, n):</span>
        <span class="c1"># field_names = f</span>
        <span class="c1"># value = n</span>
        <span class="c1"># for fn in field_names:</span>
            <span class="c1"># cmd = &#39;{}{}{}{}&#39;.format(fn, &#39;.setEditable(&#39;, n, &#39;)&#39;)</span>
            <span class="c1"># eval(cmd)</span>
    <span class="c1"># def setComboBoxEnable(self, f, v):</span>
        <span class="c1"># field_names = f</span>
        <span class="c1"># value = v</span>
        <span class="c1"># for fn in field_names:</span>
            <span class="c1"># cmd = &#39;{}{}{}{}&#39;.format(fn, &#39;.setEnabled(&#39;, v, &#39;)&#39;)</span>
            <span class="c1"># eval(cmd)</span>
    <span class="c1"># def setTableEnable(self, t, v):</span>
        <span class="c1"># tab_names = t</span>
        <span class="c1"># value = v</span>
        <span class="c1"># for tn in tab_names:</span>
            <span class="c1"># cmd = &#39;{}{}{}{}&#39;.format(tn, &#39;.setEnabled(&#39;, v, &#39;)&#39;)</span>
            <span class="c1"># eval(cmd)</span>
    <span class="c1"># def testing(self, name_file, message):</span>
        <span class="c1"># f = open(str(name_file), &#39;w&#39;)</span>
        <span class="c1"># f.write(str(message))</span>
        <span class="c1"># f.close()</span>
    <span class="c1"># def on_pushButton_open_dir_pressed(self):</span>
        <span class="c1"># HOME = os.environ[&#39;PYARCHINIT_HOME&#39;]</span>
        <span class="c1"># path = &#39;{}{}{}&#39;.format(HOME, os.sep, &quot;pyarchinit_PDF_folder&quot;)</span>
        <span class="c1"># if platform.system() == &quot;Windows&quot;:</span>
            <span class="c1"># os.startfile(path)</span>
        <span class="c1"># elif platform.system() == &quot;Darwin&quot;:</span>
            <span class="c1"># subprocess.Popen([&quot;open&quot;, path])</span>
        <span class="c1"># else:</span>
            <span class="c1"># subprocess.Popen([&quot;xdg-open&quot;, path])</span>
    <span class="c1"># def on_pushButton_open_dir_matrix_pressed(self):</span>
        <span class="c1"># HOME = os.environ[&#39;PYARCHINIT_HOME&#39;]</span>
        <span class="c1"># path = &#39;{}{}{}&#39;.format(HOME, os.sep, &quot;pyarchinit_Matrix_folder&quot;)</span>
        <span class="c1"># if platform.system() == &quot;Windows&quot;:</span>
            <span class="c1"># os.startfile(path)</span>
        <span class="c1"># elif platform.system() == &quot;Darwin&quot;:</span>
            <span class="c1"># subprocess.Popen([&quot;open&quot;, path])</span>
        <span class="c1"># else:</span>
            <span class="c1"># subprocess.Popen([&quot;xdg-open&quot;, path]) </span>
    <span class="c1"># def on_pushButton_open_dir_tavole_pressed(self):</span>
        <span class="c1"># HOME = os.environ[&#39;PYARCHINIT_HOME&#39;]</span>
        <span class="c1"># path = &#39;{}{}{}&#39;.format(HOME, os.sep, &quot;pyarchinit_MAPS_folder&quot;)</span>
        <span class="c1"># if platform.system() == &quot;Windows&quot;:</span>
            <span class="c1"># os.startfile(path)</span>
        <span class="c1"># elif platform.system() == &quot;Darwin&quot;:</span>
            <span class="c1"># subprocess.Popen([&quot;open&quot;, path])</span>
        <span class="c1"># else:</span>
            <span class="c1"># subprocess.Popen([&quot;xdg-open&quot;, path])         </span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, AdArte srl.</p>
  </div>

  Realizzato con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    fornito da <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>